/*! For license information please see main.25905a39.js.LICENSE.txt */
(()=>{var e={4:(e,t,n)=>{"use strict";var r=n(853),i=n(43),o=n(950);function s(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(l(e)!==e)throw Error(s(188))}function h(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=h(e)))return t;e=e.sibling}return null}var d=Object.assign,f=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),b=Symbol.for("react.provider"),w=Symbol.for("react.consumer"),k=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),E=Symbol.for("react.memo"),T=Symbol.for("react.lazy");Symbol.for("react.scope");var R=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var A=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var _=Symbol.iterator;function P(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=_&&e[_]||e["@@iterator"])?e:null}var M=Symbol.for("react.client.reference");function I(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===M?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case m:return"Fragment";case v:return"Profiler";case y:return"StrictMode";case C:return"Suspense";case O:return"SuspenseList";case R:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case g:return"Portal";case k:return(e.displayName||"Context")+".Provider";case w:return(e._context.displayName||"Context")+".Consumer";case S:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case E:return null!==(t=e.displayName||null)?t:I(e.type)||"Memo";case T:t=e._payload,e=e._init;try{return I(e(t))}catch(n){}}return null}var x=Array.isArray,N=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L=o.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U={pending:!1,data:null,method:null,action:null},D=[],z=-1;function j(e){return{current:e}}function B(e){0>z||(e.current=D[z],D[z]=null,z--)}function G(e,t){z++,D[z]=e.current,e.current=t}var F=j(null),H=j(null),q=j(null),V=j(null);function W(e,t){switch(G(q,t),G(H,e),G(F,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?ih(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=oh(t=ih(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}B(F),G(F,e)}function Q(){B(F),B(H),B(q)}function $(e){null!==e.memoizedState&&G(V,e);var t=F.current,n=oh(t,e.type);t!==n&&(G(H,e),G(F,n))}function K(e){H.current===e&&(B(F),B(H)),V.current===e&&(B(V),$h._currentValue=U)}var J=Object.prototype.hasOwnProperty,X=r.unstable_scheduleCallback,Y=r.unstable_cancelCallback,Z=r.unstable_shouldYield,ee=r.unstable_requestPaint,te=r.unstable_now,ne=r.unstable_getCurrentPriorityLevel,re=r.unstable_ImmediatePriority,ie=r.unstable_UserBlockingPriority,oe=r.unstable_NormalPriority,se=r.unstable_LowPriority,ae=r.unstable_IdlePriority,le=r.log,ce=r.unstable_setDisableYieldValue,ue=null,he=null;function de(e){if("function"===typeof le&&ce(e),he&&"function"===typeof he.setStrictMode)try{he.setStrictMode(ue,e)}catch(t){}}var fe=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(pe(e)/ge|0)|0},pe=Math.log,ge=Math.LN2;var me=256,ye=4194304;function ve(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function be(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var i=0,o=e.suspendedLanes,s=e.pingedLanes;e=e.warmLanes;var a=134217727&r;return 0!==a?0!==(r=a&~o)?i=ve(r):0!==(s&=a)?i=ve(s):n||0!==(n=a&~e)&&(i=ve(n)):0!==(a=r&~o)?i=ve(a):0!==s?i=ve(s):n||0!==(n=r&~e)&&(i=ve(n)),0===i?0:0!==t&&t!==i&&0===(t&o)&&((o=i&-i)>=(n=t&-t)||32===o&&0!==(4194048&n))?t:i}function we(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function ke(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Se(){var e=me;return 0===(4194048&(me<<=1))&&(me=256),e}function Ce(){var e=ye;return 0===(62914560&(ye<<=1))&&(ye=4194304),e}function Oe(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ee(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Te(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-fe(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|4194090&n}function Re(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-fe(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}function Ae(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function _e(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Pe(){var e=L.p;return 0!==e?e:void 0===(e=window.event)?32:cd(e.type)}var Me=Math.random().toString(36).slice(2),Ie="__reactFiber$"+Me,xe="__reactProps$"+Me,Ne="__reactContainer$"+Me,Le="__reactEvents$"+Me,Ue="__reactListeners$"+Me,De="__reactHandles$"+Me,ze="__reactResources$"+Me,je="__reactMarker$"+Me;function Be(e){delete e[Ie],delete e[xe],delete e[Le],delete e[Ue],delete e[De]}function Ge(e){var t=e[Ie];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ne]||n[Ie]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=bh(e);null!==e;){if(n=e[Ie])return n;e=bh(e)}return t}n=(e=n).parentNode}return null}function Fe(e){if(e=e[Ie]||e[Ne]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function He(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(s(33))}function qe(e){var t=e[ze];return t||(t=e[ze]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ve(e){e[je]=!0}var We=new Set,Qe={};function $e(e,t){Ke(e,t),Ke(e+"Capture",t)}function Ke(e,t){for(Qe[e]=t,e=0;e<t.length;e++)We.add(t[e])}var Je,Xe,Ye=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ze={},et={};function tt(e,t,n){if(i=t,J.call(et,i)||!J.call(Ze,i)&&(Ye.test(i)?et[i]=!0:(Ze[i]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var i}function nt(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function rt(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function it(e){if(void 0===Je)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Je=t&&t[1]||"",Xe=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+Je+e+Xe}var ot=!1;function st(e,t){if(!e||ot)return"";ot=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(i){var r=i}Reflect.construct(e,[],n)}else{try{n.call()}catch(o){r=o}e.call(n.prototype)}}else{try{throw Error()}catch(s){r=s}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(a){if(a&&r&&"string"===typeof a.stack)return[a.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var o=r.DetermineComponentFrameRoot(),s=o[0],a=o[1];if(s&&a){var l=s.split("\n"),c=a.split("\n");for(i=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;if(r===l.length||i===c.length)for(r=l.length-1,i=c.length-1;1<=r&&0<=i&&l[r]!==c[i];)i--;for(;1<=r&&0<=i;r--,i--)if(l[r]!==c[i]){if(1!==r||1!==i)do{if(r--,0>--i||l[r]!==c[i]){var u="\n"+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=i);break}}}finally{ot=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?it(n):""}function at(e){switch(e.tag){case 26:case 27:case 5:return it(e.type);case 16:return it("Lazy");case 13:return it("Suspense");case 19:return it("SuspenseList");case 0:case 15:return st(e.type,!1);case 11:return st(e.type.render,!1);case 1:return st(e.type,!0);case 31:return it("Activity");default:return""}}function lt(e){try{var t="";do{t+=at(e),e=e.return}while(e);return t}catch(n){return"\nError generating stack: "+n.message+"\n"+n.stack}}function ct(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ut(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ht(e){e._valueTracker||(e._valueTracker=function(e){var t=ut(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function dt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ut(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function ft(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var pt=/[\n"\\]/g;function gt(e){return e.replace(pt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function mt(e,t,n,r,i,o,s,a){e.name="",null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s?e.type=s:e.removeAttribute("type"),null!=t?"number"===s?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ct(t)):e.value!==""+ct(t)&&(e.value=""+ct(t)):"submit"!==s&&"reset"!==s||e.removeAttribute("value"),null!=t?vt(e,s,ct(t)):null!=n?vt(e,s,ct(n)):null!=r&&e.removeAttribute("value"),null==i&&null!=o&&(e.defaultChecked=!!o),null!=i&&(e.checked=i&&"function"!==typeof i&&"symbol"!==typeof i),null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a?e.name=""+ct(a):e.removeAttribute("name")}function yt(e,t,n,r,i,o,s,a){if(null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o&&(e.type=o),null!=t||null!=n){if(!("submit"!==o&&"reset"!==o||void 0!==t&&null!==t))return;n=null!=n?""+ct(n):"",t=null!=t?""+ct(t):n,a||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:i)&&"symbol"!==typeof r&&!!r,e.checked=a?e.checked:!!r,e.defaultChecked=!!r,null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.name=s)}function vt(e,t,n){"number"===t&&ft(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function bt(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ct(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function wt(e,t,n){null==t||((t=""+ct(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ct(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function kt(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(s(92));if(x(r)){if(1<r.length)throw Error(s(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=ct(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r)}function St(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var Ct=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ot(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!==typeof n||0===n||Ct.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Et(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(s(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var i in t)r=t[i],t.hasOwnProperty(i)&&n[i]!==r&&Ot(e,i,r)}else for(var o in t)t.hasOwnProperty(o)&&Ot(e,o,t[o])}function Tt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),At=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function _t(e){return At.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Pt=null;function Mt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var It=null,xt=null;function Nt(e){var t=Fe(e);if(t&&(e=t.stateNode)){var n=e[xe]||null;e:switch(e=t.stateNode,t.type){case"input":if(mt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+gt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=r[xe]||null;if(!i)throw Error(s(90));mt(r,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&dt(r)}break e;case"textarea":wt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&bt(e,!!n.multiple,t,!1)}}}var Lt=!1;function Ut(e,t,n){if(Lt)return e(t,n);Lt=!0;try{return e(t)}finally{if(Lt=!1,(null!==It||null!==xt)&&(Gc(),It&&(t=It,e=xt,xt=It=null,Nt(t),e)))for(t=0;t<e.length;t++)Nt(e[t])}}function Dt(e,t){var n=e.stateNode;if(null===n)return null;var r=n[xe]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var zt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),jt=!1;if(zt)try{var Bt={};Object.defineProperty(Bt,"passive",{get:function(){jt=!0}}),window.addEventListener("test",Bt,Bt),window.removeEventListener("test",Bt,Bt)}catch(xd){jt=!1}var Gt=null,Ft=null,Ht=null;function qt(){if(Ht)return Ht;var e,t,n=Ft,r=n.length,i="value"in Gt?Gt.value:Gt.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[o-t];t++);return Ht=i.slice(e,1<t?1-t:void 0)}function Vt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Wt(){return!0}function Qt(){return!1}function $t(e){function t(t,n,r,i,o){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?Wt:Qt,this.isPropagationStopped=Qt,this}return d(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Wt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Wt)},persist:function(){},isPersistent:Wt}),t}var Kt,Jt,Xt,Yt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zt=$t(Yt),en=d({},Yt,{view:0,detail:0}),tn=$t(en),nn=d({},en,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Xt&&(Xt&&"mousemove"===e.type?(Kt=e.screenX-Xt.screenX,Jt=e.screenY-Xt.screenY):Jt=Kt=0,Xt=e),Kt)},movementY:function(e){return"movementY"in e?e.movementY:Jt}}),rn=$t(nn),on=$t(d({},nn,{dataTransfer:0})),sn=$t(d({},en,{relatedTarget:0})),an=$t(d({},Yt,{animationName:0,elapsedTime:0,pseudoElement:0})),ln=$t(d({},Yt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),cn=$t(d({},Yt,{data:0})),un={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=dn[e])&&!!t[e]}function pn(){return fn}var gn=$t(d({},en,{key:function(e){if(e.key){var t=un[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Vt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?hn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pn,charCode:function(e){return"keypress"===e.type?Vt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Vt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),mn=$t(d({},nn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),yn=$t(d({},en,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pn})),vn=$t(d({},Yt,{propertyName:0,elapsedTime:0,pseudoElement:0})),bn=$t(d({},nn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),wn=$t(d({},Yt,{newState:0,oldState:0})),kn=[9,13,27,32],Sn=zt&&"CompositionEvent"in window,Cn=null;zt&&"documentMode"in document&&(Cn=document.documentMode);var On=zt&&"TextEvent"in window&&!Cn,En=zt&&(!Sn||Cn&&8<Cn&&11>=Cn),Tn=String.fromCharCode(32),Rn=!1;function An(e,t){switch(e){case"keyup":return-1!==kn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _n(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Pn=!1;var Mn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function In(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Mn[e.type]:"textarea"===t}function xn(e,t,n,r){It?xt?xt.push(r):xt=[r]:It=r,0<(t=qu(t,"onChange")).length&&(n=new Zt("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Nn=null,Ln=null;function Un(e){Uu(e,0)}function Dn(e){if(dt(He(e)))return e}function zn(e,t){if("change"===e)return t}var jn=!1;if(zt){var Bn;if(zt){var Gn="oninput"in document;if(!Gn){var Fn=document.createElement("div");Fn.setAttribute("oninput","return;"),Gn="function"===typeof Fn.oninput}Bn=Gn}else Bn=!1;jn=Bn&&(!document.documentMode||9<document.documentMode)}function Hn(){Nn&&(Nn.detachEvent("onpropertychange",qn),Ln=Nn=null)}function qn(e){if("value"===e.propertyName&&Dn(Ln)){var t=[];xn(t,Ln,e,Mt(e)),Ut(Un,t)}}function Vn(e,t,n){"focusin"===e?(Hn(),Ln=n,(Nn=t).attachEvent("onpropertychange",qn)):"focusout"===e&&Hn()}function Wn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Dn(Ln)}function Qn(e,t){if("click"===e)return Dn(t)}function $n(e,t){if("input"===e||"change"===e)return Dn(t)}var Kn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Jn(e,t){if(Kn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!J.call(t,i)||!Kn(e[i],t[i]))return!1}return!0}function Xn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Yn(e,t){var n,r=Xn(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Xn(r)}}function Zn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?Zn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function er(e){for(var t=ft((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=ft((e=t.contentWindow).document)}return t}function tr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var nr=zt&&"documentMode"in document&&11>=document.documentMode,rr=null,ir=null,or=null,sr=!1;function ar(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;sr||null==rr||rr!==ft(r)||("selectionStart"in(r=rr)&&tr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},or&&Jn(or,r)||(or=r,0<(r=qu(ir,"onSelect")).length&&(t=new Zt("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=rr)))}function lr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var cr={animationend:lr("Animation","AnimationEnd"),animationiteration:lr("Animation","AnimationIteration"),animationstart:lr("Animation","AnimationStart"),transitionrun:lr("Transition","TransitionRun"),transitionstart:lr("Transition","TransitionStart"),transitioncancel:lr("Transition","TransitionCancel"),transitionend:lr("Transition","TransitionEnd")},ur={},hr={};function dr(e){if(ur[e])return ur[e];if(!cr[e])return e;var t,n=cr[e];for(t in n)if(n.hasOwnProperty(t)&&t in hr)return ur[e]=n[t];return e}zt&&(hr=document.createElement("div").style,"AnimationEvent"in window||(delete cr.animationend.animation,delete cr.animationiteration.animation,delete cr.animationstart.animation),"TransitionEvent"in window||delete cr.transitionend.transition);var fr=dr("animationend"),pr=dr("animationiteration"),gr=dr("animationstart"),mr=dr("transitionrun"),yr=dr("transitionstart"),vr=dr("transitioncancel"),br=dr("transitionend"),wr=new Map,kr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Sr(e,t){wr.set(e,t),$e(t,[e])}kr.push("scrollEnd");var Cr=new WeakMap;function Or(e,t){if("object"===typeof e&&null!==e){var n=Cr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:lt(t)},Cr.set(e,t),t)}return{value:e,source:t,stack:lt(t)}}var Er=[],Tr=0,Rr=0;function Ar(){for(var e=Tr,t=Rr=Tr=0;t<e;){var n=Er[t];Er[t++]=null;var r=Er[t];Er[t++]=null;var i=Er[t];Er[t++]=null;var o=Er[t];if(Er[t++]=null,null!==r&&null!==i){var s=r.pending;null===s?i.next=i:(i.next=s.next,s.next=i),r.pending=i}0!==o&&Ir(n,i,o)}}function _r(e,t,n,r){Er[Tr++]=e,Er[Tr++]=t,Er[Tr++]=n,Er[Tr++]=r,Rr|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Pr(e,t,n,r){return _r(e,t,n,r),xr(e)}function Mr(e,t){return _r(e,null,null,t),xr(e)}function Ir(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var i=!1,o=e.return;null!==o;)o.childLanes|=n,null!==(r=o.alternate)&&(r.childLanes|=n),22===o.tag&&(null===(e=o.stateNode)||1&e._visibility||(i=!0)),e=o,o=o.return;return 3===e.tag?(o=e.stateNode,i&&null!==t&&(i=31-fe(n),null===(r=(e=o.hiddenUpdates)[i])?e[i]=[t]:r.push(t),t.lane=536870912|n),o):null}function xr(e){if(50<Ic)throw Ic=0,xc=null,Error(s(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Nr={};function Lr(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ur(e,t,n,r){return new Lr(e,t,n,r)}function Dr(e){return!(!(e=e.prototype)||!e.isReactComponent)}function zr(e,t){var n=e.alternate;return null===n?((n=Ur(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function jr(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Br(e,t,n,r,i,o){var a=0;if(r=e,"function"===typeof e)Dr(e)&&(a=1);else if("string"===typeof e)a=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,F.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case R:return(e=Ur(31,n,t,i)).elementType=R,e.lanes=o,e;case m:return Gr(n.children,i,o,t);case y:a=8,i|=24;break;case v:return(e=Ur(12,n,t,2|i)).elementType=v,e.lanes=o,e;case C:return(e=Ur(13,n,t,i)).elementType=C,e.lanes=o,e;case O:return(e=Ur(19,n,t,i)).elementType=O,e.lanes=o,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case b:case k:a=10;break e;case w:a=9;break e;case S:a=11;break e;case E:a=14;break e;case T:a=16,r=null;break e}a=29,n=Error(s(130,null===e?"null":typeof e,"")),r=null}return(t=Ur(a,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Gr(e,t,n,r){return(e=Ur(7,e,r,t)).lanes=n,e}function Fr(e,t,n){return(e=Ur(6,e,null,t)).lanes=n,e}function Hr(e,t,n){return(t=Ur(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var qr=[],Vr=0,Wr=null,Qr=0,$r=[],Kr=0,Jr=null,Xr=1,Yr="";function Zr(e,t){qr[Vr++]=Qr,qr[Vr++]=Wr,Wr=e,Qr=t}function ei(e,t,n){$r[Kr++]=Xr,$r[Kr++]=Yr,$r[Kr++]=Jr,Jr=e;var r=Xr;e=Yr;var i=32-fe(r)-1;r&=~(1<<i),n+=1;var o=32-fe(t)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Xr=1<<32-fe(t)+i|n<<i|r,Yr=o+e}else Xr=1<<o|n<<i|r,Yr=e}function ti(e){null!==e.return&&(Zr(e,1),ei(e,1,0))}function ni(e){for(;e===Wr;)Wr=qr[--Vr],qr[Vr]=null,Qr=qr[--Vr],qr[Vr]=null;for(;e===Jr;)Jr=$r[--Kr],$r[Kr]=null,Yr=$r[--Kr],$r[Kr]=null,Xr=$r[--Kr],$r[Kr]=null}var ri=null,ii=null,oi=!1,si=null,ai=!1,li=Error(s(519));function ci(e){throw gi(Or(Error(s(418,"")),e)),li}function ui(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Ie]=e,t[xe]=r,n){case"dialog":Du("cancel",t),Du("close",t);break;case"iframe":case"object":case"embed":Du("load",t);break;case"video":case"audio":for(n=0;n<Nu.length;n++)Du(Nu[n],t);break;case"source":Du("error",t);break;case"img":case"image":case"link":Du("error",t),Du("load",t);break;case"details":Du("toggle",t);break;case"input":Du("invalid",t),yt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0),ht(t);break;case"select":Du("invalid",t);break;case"textarea":Du("invalid",t),kt(t,r.value,r.defaultValue,r.children),ht(t)}"string"!==typeof(n=r.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||Ju(t.textContent,n)?(null!=r.popover&&(Du("beforetoggle",t),Du("toggle",t)),null!=r.onScroll&&Du("scroll",t),null!=r.onScrollEnd&&Du("scrollend",t),null!=r.onClick&&(t.onclick=Xu),t=!0):t=!1,t||ci(e)}function hi(e){for(ri=e.return;ri;)switch(ri.tag){case 5:case 13:return void(ai=!1);case 27:case 3:return void(ai=!0);default:ri=ri.return}}function di(e){if(e!==ri)return!1;if(!oi)return hi(e),oi=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||sh(e.type,e.memoizedProps)),t=!t),t&&ii&&ci(e),hi(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===n){ii=yh(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++;e=e.nextSibling}ii=null}}else 27===n?(n=ii,fh(e.type)?(e=vh,vh=null,ii=e):ii=n):ii=ri?yh(e.stateNode.nextSibling):null;return!0}function fi(){ii=ri=null,oi=!1}function pi(){var e=si;return null!==e&&(null===bc?bc=e:bc.push.apply(bc,e),si=null),e}function gi(e){null===si?si=[e]:si.push(e)}var mi=j(null),yi=null,vi=null;function bi(e,t,n){G(mi,t._currentValue),t._currentValue=n}function wi(e){e._currentValue=mi.current,B(mi)}function ki(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Si(e,t,n,r){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var o=i.dependencies;if(null!==o){var a=i.child;o=o.firstContext;e:for(;null!==o;){var l=o;o=i;for(var c=0;c<t.length;c++)if(l.context===t[c]){o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),ki(o.return,n,e),r||(a=null);break e}o=l.next}}else if(18===i.tag){if(null===(a=i.return))throw Error(s(341));a.lanes|=n,null!==(o=a.alternate)&&(o.lanes|=n),ki(a,n,e),a=null}else a=i.child;if(null!==a)a.return=i;else for(a=i;null!==a;){if(a===e){a=null;break}if(null!==(i=a.sibling)){i.return=a.return,a=i;break}a=a.return}i=a}}function Ci(e,t,n,r){e=null;for(var i=t,o=!1;null!==i;){if(!o)if(0!==(524288&i.flags))o=!0;else if(0!==(262144&i.flags))break;if(10===i.tag){var a=i.alternate;if(null===a)throw Error(s(387));if(null!==(a=a.memoizedProps)){var l=i.type;Kn(i.pendingProps.value,a.value)||(null!==e?e.push(l):e=[l])}}else if(i===V.current){if(null===(a=i.alternate))throw Error(s(387));a.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push($h):e=[$h])}i=i.return}null!==e&&Si(t,e,n,r),t.flags|=262144}function Oi(e){for(e=e.firstContext;null!==e;){if(!Kn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ei(e){yi=e,vi=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Ti(e){return Ai(yi,e)}function Ri(e,t){return null===yi&&Ei(e),Ai(e,t)}function Ai(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===vi){if(null===e)throw Error(s(308));vi=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else vi=vi.next=t;return n}var _i="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Pi=r.unstable_scheduleCallback,Mi=r.unstable_NormalPriority,Ii={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function xi(){return{controller:new _i,data:new Map,refCount:0}}function Ni(e){e.refCount--,0===e.refCount&&Pi(Mi,function(){e.controller.abort()})}var Li=null,Ui=0,Di=0,zi=null;function ji(){if(0===--Ui&&null!==Li){null!==zi&&(zi.status="fulfilled");var e=Li;Li=null,Di=0,zi=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Bi=N.S;N.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Li){var n=Li=[];Ui=0,Di=_u(),zi={status:"pending",value:void 0,then:function(e){n.push(e)}}}Ui++,t.then(ji,ji)}(0,t),null!==Bi&&Bi(e,t)};var Gi=j(null);function Fi(){var e=Gi.current;return null!==e?e:rc.pooledCache}function Hi(e,t){G(Gi,null===t?Gi.current:t.pool)}function qi(){var e=Fi();return null===e?null:{parent:Ii._currentValue,pool:e}}var Vi=Error(s(460)),Wi=Error(s(474)),Qi=Error(s(542)),$i={then:function(){}};function Ki(e){return"fulfilled"===(e=e.status)||"rejected"===e}function Ji(){}function Xi(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Ji,Ji),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw eo(e=t.reason),e;default:if("string"===typeof t.status)t.then(Ji,Ji);else{if(null!==(e=rc)&&100<e.shellSuspendCounter)throw Error(s(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw eo(e=t.reason),e}throw Yi=t,Vi}}var Yi=null;function Zi(){if(null===Yi)throw Error(s(459));var e=Yi;return Yi=null,e}function eo(e){if(e===Vi||e===Qi)throw Error(s(483))}var to=!1;function no(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ro(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function io(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function oo(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&nc)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,t=xr(e),Ir(e,null,n),t}return _r(e,r,t,n),xr(e)}function so(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Re(e,n)}}function ao(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===o?i=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var lo=!1;function co(){if(lo){if(null!==zi)throw zi}}function uo(e,t,n,r){lo=!1;var i=e.updateQueue;to=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===s?o=c:s.next=c,s=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==o){var h=i.baseState;for(s=0,u=c=l=null,a=o;;){var f=-536870913&a.lane,p=f!==a.lane;if(p?(oc&f)===f:(r&f)===f){0!==f&&f===Di&&(lo=!0),null!==u&&(u=u.next={lane:0,tag:a.tag,payload:a.payload,callback:null,next:null});e:{var g=e,m=a;f=t;var y=n;switch(m.tag){case 1:if("function"===typeof(g=m.payload)){h=g.call(y,h,f);break e}h=g;break e;case 3:g.flags=-65537&g.flags|128;case 0:if(null===(f="function"===typeof(g=m.payload)?g.call(y,h,f):g)||void 0===f)break e;h=d({},h,f);break e;case 2:to=!0}}null!==(f=a.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=i.callbacks)?i.callbacks=[f]:p.push(f))}else p={lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,s|=f;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(p=a).next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null===o&&(i.shared.lanes=0),fc|=s,e.lanes=s,e.memoizedState=h}}function ho(e,t){if("function"!==typeof e)throw Error(s(191,e));e.call(t)}function fo(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)ho(n[e],t)}var po=j(null),go=j(0);function mo(e,t){G(go,e=hc),G(po,t),hc=e|t.baseLanes}function yo(){G(go,hc),G(po,po.current)}function vo(){hc=go.current,B(po),B(go)}var bo=0,wo=null,ko=null,So=null,Co=!1,Oo=!1,Eo=!1,To=0,Ro=0,Ao=null,_o=0;function Po(){throw Error(s(321))}function Mo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Kn(e[n],t[n]))return!1;return!0}function Io(e,t,n,r,i,o){return bo=o,wo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,N.H=null===e||null===e.memoizedState?Ws:Qs,Eo=!1,o=n(r,i),Eo=!1,Oo&&(o=No(t,n,r,i)),xo(e),o}function xo(e){N.H=Vs;var t=null!==ko&&null!==ko.next;if(bo=0,So=ko=wo=null,Co=!1,Ro=0,Ao=null,t)throw Error(s(300));null===e||Ra||null!==(e=e.dependencies)&&Oi(e)&&(Ra=!0)}function No(e,t,n,r){wo=e;var i=0;do{if(Oo&&(Ao=null),Ro=0,Oo=!1,25<=i)throw Error(s(301));if(i+=1,So=ko=null,null!=e.updateQueue){var o=e.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,null!=o.memoCache&&(o.memoCache.index=0)}N.H=$s,o=t(n,r)}while(Oo);return o}function Lo(){var e=N.H,t=e.useState()[0];return t="function"===typeof t.then?Go(t):t,e=e.useState()[0],(null!==ko?ko.memoizedState:null)!==e&&(wo.flags|=1024),t}function Uo(){var e=0!==To;return To=0,e}function Do(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function zo(e){if(Co){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Co=!1}bo=0,So=ko=wo=null,Oo=!1,Ro=To=0,Ao=null}function jo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===So?wo.memoizedState=So=e:So=So.next=e,So}function Bo(){if(null===ko){var e=wo.alternate;e=null!==e?e.memoizedState:null}else e=ko.next;var t=null===So?wo.memoizedState:So.next;if(null!==t)So=t,ko=e;else{if(null===e){if(null===wo.alternate)throw Error(s(467));throw Error(s(310))}e={memoizedState:(ko=e).memoizedState,baseState:ko.baseState,baseQueue:ko.baseQueue,queue:ko.queue,next:null},null===So?wo.memoizedState=So=e:So=So.next=e}return So}function Go(e){var t=Ro;return Ro+=1,null===Ao&&(Ao=[]),e=Xi(Ao,e,t),t=wo,null===(null===So?t.memoizedState:So.next)&&(t=t.alternate,N.H=null===t||null===t.memoizedState?Ws:Qs),e}function Fo(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return Go(e);if(e.$$typeof===k)return Ti(e)}throw Error(s(438,String(e)))}function Ho(e){var t=null,n=wo.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=wo.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},wo.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=A;return t.index++,n}function qo(e,t){return"function"===typeof t?t(e):t}function Vo(e){return Wo(Bo(),ko,e)}function Wo(e,t,n){var r=e.queue;if(null===r)throw Error(s(311));r.lastRenderedReducer=n;var i=e.baseQueue,o=r.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}t.baseQueue=i=o,r.pending=null}if(o=e.baseState,null===i)e.memoizedState=o;else{var l=a=null,c=null,u=t=i.next,h=!1;do{var d=-536870913&u.lane;if(d!==u.lane?(oc&d)===d:(bo&d)===d){var f=u.revertLane;if(0===f)null!==c&&(c=c.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),d===Di&&(h=!0);else{if((bo&f)===f){u=u.next,f===Di&&(h=!0);continue}d={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=d,a=o):c=c.next=d,wo.lanes|=f,fc|=f}d=u.action,Eo&&n(o,d),o=u.hasEagerState?u.eagerState:n(o,d)}else f={lane:d,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=f,a=o):c=c.next=f,wo.lanes|=d,fc|=d;u=u.next}while(null!==u&&u!==t);if(null===c?a=o:c.next=l,!Kn(o,e.memoizedState)&&(Ra=!0,h&&null!==(n=zi)))throw n;e.memoizedState=o,e.baseState=a,e.baseQueue=c,r.lastRenderedState=o}return null===i&&(r.lanes=0),[e.memoizedState,r.dispatch]}function Qo(e){var t=Bo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);Kn(o,t.memoizedState)||(Ra=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function $o(e,t,n){var r=wo,i=Bo(),o=oi;if(o){if(void 0===n)throw Error(s(407));n=n()}else n=t();var a=!Kn((ko||i).memoizedState,n);if(a&&(i.memoizedState=n,Ra=!0),i=i.queue,ys(2048,8,Xo.bind(null,r,i,e),[e]),i.getSnapshot!==t||a||null!==So&&1&So.memoizedState.tag){if(r.flags|=2048,ps(9,{destroy:void 0,resource:void 0},Jo.bind(null,r,i,n,t),null),null===rc)throw Error(s(349));o||0!==(124&bo)||Ko(r,t,n)}return n}function Ko(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=wo.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},wo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Jo(e,t,n,r){t.value=n,t.getSnapshot=r,Yo(t)&&Zo(e)}function Xo(e,t,n){return n(function(){Yo(t)&&Zo(e)})}function Yo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Kn(e,n)}catch(r){return!0}}function Zo(e){var t=Mr(e,2);null!==t&&Uc(t,e,2)}function es(e){var t=jo();if("function"===typeof e){var n=e;if(e=n(),Eo){de(!0);try{n()}finally{de(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qo,lastRenderedState:e},t}function ts(e,t,n,r){return e.baseState=n,Wo(e,ko,"function"===typeof r?r:qo)}function ns(e,t,n,r,i){if(Fs(e))throw Error(s(485));if(null!==(e=t.action)){var o={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){o.listeners.push(e)}};null!==N.T?n(!0):o.isTransition=!1,r(o),null===(n=t.pending)?(o.next=t.pending=o,rs(t,o)):(o.next=n.next,t.pending=n.next=o)}}function rs(e,t){var n=t.action,r=t.payload,i=e.state;if(t.isTransition){var o=N.T,s={};N.T=s;try{var a=n(i,r),l=N.S;null!==l&&l(s,a),is(e,t,a)}catch(c){ss(e,t,c)}finally{N.T=o}}else try{is(e,t,o=n(i,r))}catch(u){ss(e,t,u)}}function is(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){os(e,t,n)},function(n){return ss(e,t,n)}):os(e,t,n)}function os(e,t,n){t.status="fulfilled",t.value=n,as(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,rs(e,n)))}function ss(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,as(t),t=t.next}while(t!==r)}e.action=null}function as(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function ls(e,t){return t}function cs(e,t){if(oi){var n=rc.formState;if(null!==n){e:{var r=wo;if(oi){if(ii){t:{for(var i=ii,o=ai;8!==i.nodeType;){if(!o){i=null;break t}if(null===(i=yh(i.nextSibling))){i=null;break t}}i="F!"===(o=i.data)||"F"===o?i:null}if(i){ii=yh(i.nextSibling),r="F!"===i.data;break e}}ci(r)}r=!1}r&&(t=n[0])}}return(n=jo()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ls,lastRenderedState:t},n.queue=r,n=js.bind(null,wo,r),r.dispatch=n,r=es(!1),o=Gs.bind(null,wo,!1,r.queue),i={state:t,dispatch:null,action:e,pending:null},(r=jo()).queue=i,n=ns.bind(null,wo,i,o,n),i.dispatch=n,r.memoizedState=e,[t,n,!1]}function us(e){return hs(Bo(),ko,e)}function hs(e,t,n){if(t=Wo(e,t,ls)[0],e=Vo(qo)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var r=Go(t)}catch(s){if(s===Vi)throw Qi;throw s}else r=t;var i=(t=Bo()).queue,o=i.dispatch;return n!==t.memoizedState&&(wo.flags|=2048,ps(9,{destroy:void 0,resource:void 0},ds.bind(null,i,n),null)),[r,o,e]}function ds(e,t){e.action=t}function fs(e){var t=Bo(),n=ko;if(null!==n)return hs(t,n,e);Bo(),t=t.memoizedState;var r=(n=Bo()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function ps(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=wo.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},wo.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function gs(){return Bo().memoizedState}function ms(e,t,n,r){var i=jo();r=void 0===r?null:r,wo.flags|=e,i.memoizedState=ps(1|t,{destroy:void 0,resource:void 0},n,r)}function ys(e,t,n,r){var i=Bo();r=void 0===r?null:r;var o=i.memoizedState.inst;null!==ko&&null!==r&&Mo(r,ko.memoizedState.deps)?i.memoizedState=ps(t,o,n,r):(wo.flags|=e,i.memoizedState=ps(1|t,o,n,r))}function vs(e,t){ms(8390656,8,e,t)}function bs(e,t){ys(2048,8,e,t)}function ws(e,t){return ys(4,2,e,t)}function ks(e,t){return ys(4,4,e,t)}function Ss(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Cs(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,ys(4,4,Ss.bind(null,t,e),n)}function Os(){}function Es(e,t){var n=Bo();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&Mo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ts(e,t){var n=Bo();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&Mo(t,r[1]))return r[0];if(r=e(),Eo){de(!0);try{e()}finally{de(!1)}}return n.memoizedState=[r,t],r}function Rs(e,t,n){return void 0===n||0!==(1073741824&bo)?e.memoizedState=t:(e.memoizedState=n,e=Lc(),wo.lanes|=e,fc|=e,n)}function As(e,t,n,r){return Kn(n,t)?n:null!==po.current?(e=Rs(e,n,r),Kn(e,t)||(Ra=!0),e):0===(42&bo)?(Ra=!0,e.memoizedState=n):(e=Lc(),wo.lanes|=e,fc|=e,t)}function _s(e,t,n,r,i){var o=L.p;L.p=0!==o&&8>o?o:8;var s=N.T,a={};N.T=a,Gs(e,!1,t,n);try{var l=i(),c=N.S;if(null!==c&&c(a,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)Bs(e,t,function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),r}(l,r),Nc());else Bs(e,t,r,Nc())}catch(u){Bs(e,t,{then:function(){},status:"rejected",reason:u},Nc())}finally{L.p=o,N.T=s}}function Ps(){}function Ms(e,t,n,r){if(5!==e.tag)throw Error(s(476));var i=Is(e).queue;_s(e,i,t,U,null===n?Ps:function(){return xs(e),n(r)})}function Is(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:U,baseState:U,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qo,lastRenderedState:U},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qo,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function xs(e){Bs(e,Is(e).next.queue,{},Nc())}function Ns(){return Ti($h)}function Ls(){return Bo().memoizedState}function Us(){return Bo().memoizedState}function Ds(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Nc(),r=oo(t,e=io(n),n);return null!==r&&(Uc(r,t,n),so(r,t,n)),t={cache:xi()},void(e.payload=t)}t=t.return}}function zs(e,t,n){var r=Nc();n={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},Fs(e)?Hs(t,n):null!==(n=Pr(e,t,n,r))&&(Uc(n,e,r),qs(n,t,r))}function js(e,t,n){Bs(e,t,n,Nc())}function Bs(e,t,n,r){var i={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(Fs(e))Hs(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,Kn(a,s))return _r(e,t,i,0),null===rc&&Ar(),!1}catch(l){}if(null!==(n=Pr(e,t,i,r)))return Uc(n,e,r),qs(n,t,r),!0}return!1}function Gs(e,t,n,r){if(r={lane:2,revertLane:_u(),action:r,hasEagerState:!1,eagerState:null,next:null},Fs(e)){if(t)throw Error(s(479))}else null!==(t=Pr(e,n,r,2))&&Uc(t,e,2)}function Fs(e){var t=e.alternate;return e===wo||null!==t&&t===wo}function Hs(e,t){Oo=Co=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function qs(e,t,n){if(0!==(4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Re(e,n)}}var Vs={readContext:Ti,use:Fo,useCallback:Po,useContext:Po,useEffect:Po,useImperativeHandle:Po,useLayoutEffect:Po,useInsertionEffect:Po,useMemo:Po,useReducer:Po,useRef:Po,useState:Po,useDebugValue:Po,useDeferredValue:Po,useTransition:Po,useSyncExternalStore:Po,useId:Po,useHostTransitionStatus:Po,useFormState:Po,useActionState:Po,useOptimistic:Po,useMemoCache:Po,useCacheRefresh:Po},Ws={readContext:Ti,use:Fo,useCallback:function(e,t){return jo().memoizedState=[e,void 0===t?null:t],e},useContext:Ti,useEffect:vs,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,ms(4194308,4,Ss.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ms(4194308,4,e,t)},useInsertionEffect:function(e,t){ms(4,2,e,t)},useMemo:function(e,t){var n=jo();t=void 0===t?null:t;var r=e();if(Eo){de(!0);try{e()}finally{de(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=jo();if(void 0!==n){var i=n(t);if(Eo){de(!0);try{n(t)}finally{de(!1)}}}else i=t;return r.memoizedState=r.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},r.queue=e,e=e.dispatch=zs.bind(null,wo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},jo().memoizedState=e},useState:function(e){var t=(e=es(e)).queue,n=js.bind(null,wo,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Os,useDeferredValue:function(e,t){return Rs(jo(),e,t)},useTransition:function(){var e=es(!1);return e=_s.bind(null,wo,e.queue,!0,!1),jo().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=wo,i=jo();if(oi){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===rc)throw Error(s(349));0!==(124&oc)||Ko(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,vs(Xo.bind(null,r,o,e),[e]),r.flags|=2048,ps(9,{destroy:void 0,resource:void 0},Jo.bind(null,r,o,n,t),null),n},useId:function(){var e=jo(),t=rc.identifierPrefix;if(oi){var n=Yr;t="\xab"+t+"R"+(n=(Xr&~(1<<32-fe(Xr)-1)).toString(32)+n),0<(n=To++)&&(t+="H"+n.toString(32)),t+="\xbb"}else t="\xab"+t+"r"+(n=_o++).toString(32)+"\xbb";return e.memoizedState=t},useHostTransitionStatus:Ns,useFormState:cs,useActionState:cs,useOptimistic:function(e){var t=jo();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Gs.bind(null,wo,!0,n),n.dispatch=t,[e,t]},useMemoCache:Ho,useCacheRefresh:function(){return jo().memoizedState=Ds.bind(null,wo)}},Qs={readContext:Ti,use:Fo,useCallback:Es,useContext:Ti,useEffect:bs,useImperativeHandle:Cs,useInsertionEffect:ws,useLayoutEffect:ks,useMemo:Ts,useReducer:Vo,useRef:gs,useState:function(){return Vo(qo)},useDebugValue:Os,useDeferredValue:function(e,t){return As(Bo(),ko.memoizedState,e,t)},useTransition:function(){var e=Vo(qo)[0],t=Bo().memoizedState;return["boolean"===typeof e?e:Go(e),t]},useSyncExternalStore:$o,useId:Ls,useHostTransitionStatus:Ns,useFormState:us,useActionState:us,useOptimistic:function(e,t){return ts(Bo(),0,e,t)},useMemoCache:Ho,useCacheRefresh:Us},$s={readContext:Ti,use:Fo,useCallback:Es,useContext:Ti,useEffect:bs,useImperativeHandle:Cs,useInsertionEffect:ws,useLayoutEffect:ks,useMemo:Ts,useReducer:Qo,useRef:gs,useState:function(){return Qo(qo)},useDebugValue:Os,useDeferredValue:function(e,t){var n=Bo();return null===ko?Rs(n,e,t):As(n,ko.memoizedState,e,t)},useTransition:function(){var e=Qo(qo)[0],t=Bo().memoizedState;return["boolean"===typeof e?e:Go(e),t]},useSyncExternalStore:$o,useId:Ls,useHostTransitionStatus:Ns,useFormState:fs,useActionState:fs,useOptimistic:function(e,t){var n=Bo();return null!==ko?ts(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Ho,useCacheRefresh:Us},Ks=null,Js=0;function Xs(e){var t=Js;return Js+=1,null===Ks&&(Ks=[]),Xi(Ks,e,t)}function Ys(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function Zs(e,t){if(t.$$typeof===f)throw Error(s(525));throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ea(e){return(0,e._init)(e._payload)}function ta(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=zr(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Fr(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var o=n.type;return o===m?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===T&&ea(o)===t.type)?(Ys(t=i(t,n.props),n),t.return=e,t):(Ys(t=Br(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Hr(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,o){return null===t||7!==t.tag?((t=Gr(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Fr(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case p:return Ys(n=Br(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case g:return(t=Hr(t,e.mode,n)).return=e,t;case T:return d(e,t=(0,t._init)(t._payload),n)}if(x(t)||P(t))return(t=Gr(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return d(e,Xs(t),n);if(t.$$typeof===k)return d(e,Ri(e,t),n);Zs(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case p:return n.key===i?c(e,t,n,r):null;case g:return n.key===i?u(e,t,n,r):null;case T:return f(e,t,n=(i=n._init)(n._payload),r)}if(x(n)||P(n))return null!==i?null:h(e,t,n,r,null);if("function"===typeof n.then)return f(e,t,Xs(n),r);if(n.$$typeof===k)return f(e,t,Ri(e,n),r);Zs(e,n)}return null}function y(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case p:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case g:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case T:return y(e,t,n,r=(0,r._init)(r._payload),i)}if(x(r)||P(r))return h(t,e=e.get(n)||null,r,i,null);if("function"===typeof r.then)return y(e,t,n,Xs(r),i);if(r.$$typeof===k)return y(e,t,n,Ri(t,r),i);Zs(t,r)}return null}function v(l,c,u,h){if("object"===typeof u&&null!==u&&u.type===m&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case p:e:{for(var b=u.key;null!==c;){if(c.key===b){if((b=u.type)===m){if(7===c.tag){n(l,c.sibling),(h=i(c,u.props.children)).return=l,l=h;break e}}else if(c.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===T&&ea(b)===c.type){n(l,c.sibling),Ys(h=i(c,u.props),u),h.return=l,l=h;break e}n(l,c);break}t(l,c),c=c.sibling}u.type===m?((h=Gr(u.props.children,l.mode,h,u.key)).return=l,l=h):(Ys(h=Br(u.type,u.key,u.props,null,l.mode,h),u),h.return=l,l=h)}return a(l);case g:e:{for(b=u.key;null!==c;){if(c.key===b){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){n(l,c.sibling),(h=i(c,u.children||[])).return=l,l=h;break e}n(l,c);break}t(l,c),c=c.sibling}(h=Hr(u,l.mode,h)).return=l,l=h}return a(l);case T:return v(l,c,u=(b=u._init)(u._payload),h)}if(x(u))return function(i,s,a,l){for(var c=null,u=null,h=s,p=s=0,g=null;null!==h&&p<a.length;p++){h.index>p?(g=h,h=null):g=h.sibling;var m=f(i,h,a[p],l);if(null===m){null===h&&(h=g);break}e&&h&&null===m.alternate&&t(i,h),s=o(m,s,p),null===u?c=m:u.sibling=m,u=m,h=g}if(p===a.length)return n(i,h),oi&&Zr(i,p),c;if(null===h){for(;p<a.length;p++)null!==(h=d(i,a[p],l))&&(s=o(h,s,p),null===u?c=h:u.sibling=h,u=h);return oi&&Zr(i,p),c}for(h=r(h);p<a.length;p++)null!==(g=y(h,i,p,a[p],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?p:g.key),s=o(g,s,p),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach(function(e){return t(i,e)}),oi&&Zr(i,p),c}(l,c,u,h);if(P(u)){if("function"!==typeof(b=P(u)))throw Error(s(150));return function(i,a,l,c){if(null==l)throw Error(s(151));for(var u=null,h=null,p=a,g=a=0,m=null,v=l.next();null!==p&&!v.done;g++,v=l.next()){p.index>g?(m=p,p=null):m=p.sibling;var b=f(i,p,v.value,c);if(null===b){null===p&&(p=m);break}e&&p&&null===b.alternate&&t(i,p),a=o(b,a,g),null===h?u=b:h.sibling=b,h=b,p=m}if(v.done)return n(i,p),oi&&Zr(i,g),u;if(null===p){for(;!v.done;g++,v=l.next())null!==(v=d(i,v.value,c))&&(a=o(v,a,g),null===h?u=v:h.sibling=v,h=v);return oi&&Zr(i,g),u}for(p=r(p);!v.done;g++,v=l.next())null!==(v=y(p,i,g,v.value,c))&&(e&&null!==v.alternate&&p.delete(null===v.key?g:v.key),a=o(v,a,g),null===h?u=v:h.sibling=v,h=v);return e&&p.forEach(function(e){return t(i,e)}),oi&&Zr(i,g),u}(l,c,u=b.call(u),h)}if("function"===typeof u.then)return v(l,c,Xs(u),h);if(u.$$typeof===k)return v(l,c,Ri(l,u),h);Zs(l,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==c&&6===c.tag?(n(l,c.sibling),(h=i(c,u)).return=l,l=h):(n(l,c),(h=Fr(u,l.mode,h)).return=l,l=h),a(l)):n(l,c)}return function(e,t,n,r){try{Js=0;var i=v(e,t,n,r);return Ks=null,i}catch(s){if(s===Vi||s===Qi)throw s;var o=Ur(29,s,null,e.mode);return o.lanes=r,o.return=e,o}}}var na=ta(!0),ra=ta(!1),ia=j(null),oa=null;function sa(e){var t=e.alternate;G(ua,1&ua.current),G(ia,e),null===oa&&(null===t||null!==po.current||null!==t.memoizedState)&&(oa=e)}function aa(e){if(22===e.tag){if(G(ua,ua.current),G(ia,e),null===oa){var t=e.alternate;null!==t&&null!==t.memoizedState&&(oa=e)}}else la()}function la(){G(ua,ua.current),G(ia,ia.current)}function ca(e){B(ia),oa===e&&(oa=null),B(ua)}var ua=j(0);function ha(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||mh(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function da(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:d({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var fa={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Nc(),i=io(r);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=oo(e,i,r))&&(Uc(t,e,r),so(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Nc(),i=io(r);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=oo(e,i,r))&&(Uc(t,e,r),so(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Nc(),r=io(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=oo(e,r,n))&&(Uc(t,e,n),so(t,e,n))}};function pa(e,t,n,r,i,o,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!Jn(n,r)||!Jn(i,o))}function ga(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&fa.enqueueReplaceState(t,t.state,null)}function ma(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var i in n===t&&(n=d({},n)),e)void 0===n[i]&&(n[i]=e[i]);return n}var ya="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function va(e){ya(e)}function ba(e){console.error(e)}function wa(e){ya(e)}function ka(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Sa(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function Ca(e,t,n){return(n=io(n)).tag=3,n.payload={element:null},n.callback=function(){ka(e,t)},n}function Oa(e){return(e=io(e)).tag=3,e}function Ea(e,t,n,r){var i=n.type.getDerivedStateFromError;if("function"===typeof i){var o=r.value;e.payload=function(){return i(o)},e.callback=function(){Sa(t,n,r)}}var s=n.stateNode;null!==s&&"function"===typeof s.componentDidCatch&&(e.callback=function(){Sa(t,n,r),"function"!==typeof i&&(null===Oc?Oc=new Set([this]):Oc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var Ta=Error(s(461)),Ra=!1;function Aa(e,t,n,r){t.child=null===e?ra(t,null,n,r):na(t,e.child,n,r)}function _a(e,t,n,r,i){n=n.render;var o=t.ref;if("ref"in r){var s={};for(var a in r)"ref"!==a&&(s[a]=r[a])}else s=r;return Ei(t),r=Io(e,t,n,s,o,i),a=Uo(),null===e||Ra?(oi&&a&&ti(t),t.flags|=1,Aa(e,t,r,i),t.child):(Do(e,t,i),Ka(e,t,i))}function Pa(e,t,n,r,i){if(null===e){var o=n.type;return"function"!==typeof o||Dr(o)||void 0!==o.defaultProps||null!==n.compare?((e=Br(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Ma(e,t,o,r,i))}if(o=e.child,!Ja(e,i)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:Jn)(s,r)&&e.ref===t.ref)return Ka(e,t,i)}return t.flags|=1,(e=zr(o,r)).ref=t.ref,e.return=t,t.child=e}function Ma(e,t,n,r,i){if(null!==e){var o=e.memoizedProps;if(Jn(o,r)&&e.ref===t.ref){if(Ra=!1,t.pendingProps=r=o,!Ja(e,i))return t.lanes=e.lanes,Ka(e,t,i);0!==(131072&e.flags)&&(Ra=!0)}}return La(e,t,n,r,i)}function Ia(e,t,n){var r=t.pendingProps,i=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode){if(0!==(128&t.flags)){if(r=null!==o?o.baseLanes|n:n,null!==e){for(i=t.child=e.child,o=0;null!==i;)o=o|i.lanes|i.childLanes,i=i.sibling;t.childLanes=o&~r}else t.childLanes=0,t.child=null;return xa(e,t,r,n)}if(0===(536870912&n))return t.lanes=t.childLanes=536870912,xa(e,t,null!==o?o.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Hi(0,null!==o?o.cachePool:null),null!==o?mo(t,o):yo(),aa(t)}else null!==o?(Hi(0,o.cachePool),mo(t,o),la(),t.memoizedState=null):(null!==e&&Hi(0,null),yo(),la());return Aa(e,t,i,n),t.child}function xa(e,t,n,r){var i=Fi();return i=null===i?null:{parent:Ii._currentValue,pool:i},t.memoizedState={baseLanes:n,cachePool:i},null!==e&&Hi(0,null),yo(),aa(t),null!==e&&Ci(e,t,r,!0),null}function Na(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(s(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function La(e,t,n,r,i){return Ei(t),n=Io(e,t,n,r,void 0,i),r=Uo(),null===e||Ra?(oi&&r&&ti(t),t.flags|=1,Aa(e,t,n,i),t.child):(Do(e,t,i),Ka(e,t,i))}function Ua(e,t,n,r,i,o){return Ei(t),t.updateQueue=null,n=No(t,r,n,i),xo(e),r=Uo(),null===e||Ra?(oi&&r&&ti(t),t.flags|=1,Aa(e,t,n,o),t.child):(Do(e,t,o),Ka(e,t,o))}function Da(e,t,n,r,i){if(Ei(t),null===t.stateNode){var o=Nr,s=n.contextType;"object"===typeof s&&null!==s&&(o=Ti(s)),o=new n(r,o),t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,o.updater=fa,t.stateNode=o,o._reactInternals=t,(o=t.stateNode).props=r,o.state=t.memoizedState,o.refs={},no(t),s=n.contextType,o.context="object"===typeof s&&null!==s?Ti(s):Nr,o.state=t.memoizedState,"function"===typeof(s=n.getDerivedStateFromProps)&&(da(t,n,s,r),o.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(s=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),s!==o.state&&fa.enqueueReplaceState(o,o.state,null),uo(t,r,o,i),co(),o.state=t.memoizedState),"function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){o=t.stateNode;var a=t.memoizedProps,l=ma(n,a);o.props=l;var c=o.context,u=n.contextType;s=Nr,"object"===typeof u&&null!==u&&(s=Ti(u));var h=n.getDerivedStateFromProps;u="function"===typeof h||"function"===typeof o.getSnapshotBeforeUpdate,a=t.pendingProps!==a,u||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a||c!==s)&&ga(t,o,r,s),to=!1;var d=t.memoizedState;o.state=d,uo(t,r,o,i),co(),c=t.memoizedState,a||d!==c||to?("function"===typeof h&&(da(t,n,h,r),c=t.memoizedState),(l=to||pa(t,n,l,r,d,c,s))?(u||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=s,r=l):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,ro(e,t),u=ma(n,s=t.memoizedProps),o.props=u,h=t.pendingProps,d=o.context,c=n.contextType,l=Nr,"object"===typeof c&&null!==c&&(l=Ti(c)),(c="function"===typeof(a=n.getDerivedStateFromProps)||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==h||d!==l)&&ga(t,o,r,l),to=!1,d=t.memoizedState,o.state=d,uo(t,r,o,i),co();var f=t.memoizedState;s!==h||d!==f||to||null!==e&&null!==e.dependencies&&Oi(e.dependencies)?("function"===typeof a&&(da(t,n,a,r),f=t.memoizedState),(u=to||pa(t,n,u,r,d,f,l)||null!==e&&null!==e.dependencies&&Oi(e.dependencies))?(c||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,f,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),o.props=r,o.state=f,o.context=l,r=u):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return o=r,Na(e,t),r=0!==(128&t.flags),o||r?(o=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:o.render(),t.flags|=1,null!==e&&r?(t.child=na(t,e.child,null,i),t.child=na(t,null,n,i)):Aa(e,t,n,i),t.memoizedState=o.state,e=t.child):e=Ka(e,t,i),e}function za(e,t,n,r){return fi(),t.flags|=256,Aa(e,t,n,r),t.child}var ja={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ba(e){return{baseLanes:e,cachePool:qi()}}function Ga(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=mc),e}function Fa(e,t,n){var r,i=t.pendingProps,o=!1,a=0!==(128&t.flags);if((r=a)||(r=(null===e||null!==e.memoizedState)&&0!==(2&ua.current)),r&&(o=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(oi){if(o?sa(t):la(),oi){var l,c=ii;if(l=c){e:{for(l=c,c=ai;8!==l.nodeType;){if(!c){c=null;break e}if(null===(l=yh(l.nextSibling))){c=null;break e}}c=l}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==Jr?{id:Xr,overflow:Yr}:null,retryLane:536870912,hydrationErrors:null},(l=Ur(18,null,null,0)).stateNode=c,l.return=t,t.child=l,ri=t,ii=null,l=!0):l=!1}l||ci(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return mh(c)?t.lanes=32:t.lanes=536870912,null;ca(t)}return c=i.children,i=i.fallback,o?(la(),c=qa({mode:"hidden",children:c},o=t.mode),i=Gr(i,o,n,null),c.return=t,i.return=t,c.sibling=i,t.child=c,(o=t.child).memoizedState=Ba(n),o.childLanes=Ga(e,r,n),t.memoizedState=ja,i):(sa(t),Ha(t,c))}if(null!==(l=e.memoizedState)&&null!==(c=l.dehydrated)){if(a)256&t.flags?(sa(t),t.flags&=-257,t=Va(e,t,n)):null!==t.memoizedState?(la(),t.child=e.child,t.flags|=128,t=null):(la(),o=i.fallback,c=t.mode,i=qa({mode:"visible",children:i.children},c),(o=Gr(o,c,n,null)).flags|=2,i.return=t,o.return=t,i.sibling=o,t.child=i,na(t,e.child,null,n),(i=t.child).memoizedState=Ba(n),i.childLanes=Ga(e,r,n),t.memoizedState=ja,t=o);else if(sa(t),mh(c)){if(r=c.nextSibling&&c.nextSibling.dataset)var u=r.dgst;r=u,(i=Error(s(419))).stack="",i.digest=r,gi({value:i,source:null,stack:null}),t=Va(e,t,n)}else if(Ra||Ci(e,t,n,!1),r=0!==(n&e.childLanes),Ra||r){if(null!==(r=rc)&&(0!==(i=0!==((i=0!==(42&(i=n&-n))?1:Ae(i))&(r.suspendedLanes|n))?0:i)&&i!==l.retryLane))throw l.retryLane=i,Mr(e,i),Uc(r,e,i),Ta;"$?"===c.data||Qc(),t=Va(e,t,n)}else"$?"===c.data?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,ii=yh(c.nextSibling),ri=t,oi=!0,si=null,ai=!1,null!==e&&($r[Kr++]=Xr,$r[Kr++]=Yr,$r[Kr++]=Jr,Xr=e.id,Yr=e.overflow,Jr=t),(t=Ha(t,i.children)).flags|=4096);return t}return o?(la(),o=i.fallback,c=t.mode,u=(l=e.child).sibling,(i=zr(l,{mode:"hidden",children:i.children})).subtreeFlags=65011712&l.subtreeFlags,null!==u?o=zr(u,o):(o=Gr(o,c,n,null)).flags|=2,o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,null===(c=e.child.memoizedState)?c=Ba(n):(null!==(l=c.cachePool)?(u=Ii._currentValue,l=l.parent!==u?{parent:u,pool:u}:l):l=qi(),c={baseLanes:c.baseLanes|n,cachePool:l}),o.memoizedState=c,o.childLanes=Ga(e,r,n),t.memoizedState=ja,i):(sa(t),e=(n=e.child).sibling,(n=zr(n,{mode:"visible",children:i.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function Ha(e,t){return(t=qa({mode:"visible",children:t},e.mode)).return=e,e.child=t}function qa(e,t){return(e=Ur(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Va(e,t,n){return na(t,e.child,null,n),(e=Ha(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Wa(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),ki(e.return,t,n)}function Qa(e,t,n,r,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function $a(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(Aa(e,t,r.children,n),0!==(2&(r=ua.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Wa(e,n,t);else if(19===e.tag)Wa(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}switch(G(ua,r),i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===ha(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Qa(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ha(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Qa(t,!0,n,null,o);break;case"together":Qa(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ka(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),fc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Ci(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=zr(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=zr(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ja(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Oi(e))}function Xa(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Ra=!0;else{if(!Ja(e,n)&&0===(128&t.flags))return Ra=!1,function(e,t,n){switch(t.tag){case 3:W(t,t.stateNode.containerInfo),bi(0,Ii,e.memoizedState.cache),fi();break;case 27:case 5:$(t);break;case 4:W(t,t.stateNode.containerInfo);break;case 10:bi(0,t.type,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(sa(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Fa(e,t,n):(sa(t),null!==(e=Ka(e,t,n))?e.sibling:null);sa(t);break;case 19:var i=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(Ci(e,t,n,!1),r=0!==(n&t.childLanes)),i){if(r)return $a(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),G(ua,ua.current),r)break;return null;case 22:case 23:return t.lanes=0,Ia(e,t,n);case 24:bi(0,Ii,e.memoizedState.cache)}return Ka(e,t,n)}(e,t,n);Ra=0!==(131072&e.flags)}else Ra=!1,oi&&0!==(1048576&t.flags)&&ei(t,Qr,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var r=t.elementType,i=r._init;if(r=i(r._payload),t.type=r,"function"!==typeof r){if(void 0!==r&&null!==r){if((i=r.$$typeof)===S){t.tag=11,t=_a(null,t,r,e,n);break e}if(i===E){t.tag=14,t=Pa(null,t,r,e,n);break e}}throw t=I(r)||r,Error(s(306,t,""))}Dr(r)?(e=ma(r,e),t.tag=1,t=Da(null,t,r,e,n)):(t.tag=0,t=La(null,t,r,e,n))}return t;case 0:return La(e,t,t.type,t.pendingProps,n);case 1:return Da(e,t,r=t.type,i=ma(r,t.pendingProps),n);case 3:e:{if(W(t,t.stateNode.containerInfo),null===e)throw Error(s(387));r=t.pendingProps;var o=t.memoizedState;i=o.element,ro(e,t),uo(t,r,null,n);var a=t.memoizedState;if(r=a.cache,bi(0,Ii,r),r!==o.cache&&Si(t,[Ii],n,!0),co(),r=a.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:a.cache},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=za(e,t,r,n);break e}if(r!==i){gi(i=Or(Error(s(424)),t)),t=za(e,t,r,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(ii=yh(e.firstChild),ri=t,oi=!0,si=null,ai=!0,n=ra(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fi(),r===i){t=Ka(e,t,n);break e}Aa(e,t,r,n)}t=t.child}return t;case 26:return Na(e,t),null===e?(n=Ah(t.type,null,t.pendingProps,null))?t.memoizedState=n:oi||(n=t.type,e=t.pendingProps,(r=rh(q.current).createElement(n))[Ie]=t,r[xe]=e,eh(r,n,e),Ve(r),t.stateNode=r):t.memoizedState=Ah(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return $(t),null===e&&oi&&(r=t.stateNode=wh(t.type,t.pendingProps,q.current),ri=t,ai=!0,i=ii,fh(t.type)?(vh=i,ii=yh(r.firstChild)):ii=i),Aa(e,t,t.pendingProps.children,n),Na(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&oi&&((i=r=ii)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var i=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[je])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(o=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(o!==i.rel||e.getAttribute("href")!==(null==i.href||""===i.href?null:i.href)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin)||e.getAttribute("title")!==(null==i.title?null:i.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((o=e.getAttribute("src"))!==(null==i.src?null:i.src)||e.getAttribute("type")!==(null==i.type?null:i.type)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin))&&o&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var o=null==i.name?null:""+i.name;if("hidden"===i.type&&e.getAttribute("name")===o)return e}if(null===(e=yh(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,ai))?(t.stateNode=r,ri=t,ii=yh(r.firstChild),ai=!1,i=!0):i=!1),i||ci(t)),$(t),i=t.type,o=t.pendingProps,a=null!==e?e.memoizedProps:null,r=o.children,sh(i,o)?r=null:null!==a&&sh(i,a)&&(t.flags|=32),null!==t.memoizedState&&(i=Io(e,t,Lo,null,null,n),$h._currentValue=i),Na(e,t),Aa(e,t,r,n),t.child;case 6:return null===e&&oi&&((e=n=ii)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=yh(e.nextSibling)))return null}return e}(n,t.pendingProps,ai))?(t.stateNode=n,ri=t,ii=null,e=!0):e=!1),e||ci(t)),null;case 13:return Fa(e,t,n);case 4:return W(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=na(t,null,r,n):Aa(e,t,r,n),t.child;case 11:return _a(e,t,t.type,t.pendingProps,n);case 7:return Aa(e,t,t.pendingProps,n),t.child;case 8:case 12:return Aa(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,bi(0,t.type,r.value),Aa(e,t,r.children,n),t.child;case 9:return i=t.type._context,r=t.pendingProps.children,Ei(t),r=r(i=Ti(i)),t.flags|=1,Aa(e,t,r,n),t.child;case 14:return Pa(e,t,t.type,t.pendingProps,n);case 15:return Ma(e,t,t.type,t.pendingProps,n);case 19:return $a(e,t,n);case 31:return r=t.pendingProps,n=t.mode,r={mode:r.mode,children:r.children},null===e?((n=qa(r,n)).ref=t.ref,t.child=n,n.return=t,t=n):((n=zr(e.child,r)).ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return Ia(e,t,n);case 24:return Ei(t),r=Ti(Ii),null===e?(null===(i=Fi())&&(i=rc,o=xi(),i.pooledCache=o,o.refCount++,null!==o&&(i.pooledCacheLanes|=n),i=o),t.memoizedState={parent:r,cache:i},no(t),bi(0,Ii,i)):(0!==(e.lanes&n)&&(ro(e,t),uo(t,null,null,n),co()),i=e.memoizedState,o=t.memoizedState,i.parent!==r?(i={parent:r,cache:r},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),bi(0,Ii,r)):(r=o.cache,bi(0,Ii,r),r!==i.cache&&Si(t,[Ii],n,!0))),Aa(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(s(156,t.tag))}function Ya(e){e.flags|=4}function Za(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!Gh(t)){if(null!==(t=ia.current)&&((4194048&oc)===oc?null!==oa:(62914560&oc)!==oc&&0===(536870912&oc)||t!==oa))throw Yi=$i,Wi;e.flags|=8192}}function el(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Ce():536870912,e.lanes|=t,yc|=t)}function tl(e,t){if(!oi)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function nl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=65011712&i.subtreeFlags,r|=65011712&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function rl(e,t,n){var r=t.pendingProps;switch(ni(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return nl(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),wi(Ii),Q(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(di(t)?Ya(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,pi())),nl(t),null;case 26:return n=t.memoizedState,null===e?(Ya(t),null!==n?(nl(t),Za(t,n)):(nl(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Ya(t),nl(t),Za(t,n)):(nl(t),t.flags&=-16777217):(e.memoizedProps!==r&&Ya(t),nl(t),t.flags&=-16777217),null;case 27:K(t),n=q.current;var i=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Ya(t);else{if(!r){if(null===t.stateNode)throw Error(s(166));return nl(t),null}e=F.current,di(t)?ui(t):(e=wh(i,r,n),t.stateNode=e,Ya(t))}return nl(t),null;case 5:if(K(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Ya(t);else{if(!r){if(null===t.stateNode)throw Error(s(166));return nl(t),null}if(e=F.current,di(t))ui(t);else{switch(i=rh(q.current),e){case 1:e=i.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=i.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=i.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=i.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(e=i.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"===typeof r.is?i.createElement("select",{is:r.is}):i.createElement("select"),r.multiple?e.multiple=!0:r.size&&(e.size=r.size);break;default:e="string"===typeof r.is?i.createElement(n,{is:r.is}):i.createElement(n)}}e[Ie]=t,e[xe]=r;e:for(i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&27!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break e;for(;null===i.sibling;){if(null===i.return||i.return===t)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}t.stateNode=e;e:switch(eh(e,n,r),n){case"button":case"input":case"select":case"textarea":e=!!r.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Ya(t)}}return nl(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&Ya(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(e=q.current,di(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(i=ri))switch(i.tag){case 27:case 5:r=i.memoizedProps}e[Ie]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||Ju(e.nodeValue,n)))||ci(t)}else(e=rh(e).createTextNode(r))[Ie]=t,t.stateNode=e}return nl(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=di(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(s(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(s(317));i[Ie]=t}else fi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;nl(t),i=!1}else i=pi(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=i),i=!0;if(!i)return 256&t.flags?(ca(t),t):(ca(t),null)}if(ca(t),0!==(128&t.flags))return t.lanes=n,t;if(n=null!==r,e=null!==e&&null!==e.memoizedState,n){i=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(i=r.alternate.memoizedState.cachePool.pool);var o=null;null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(o=r.memoizedState.cachePool.pool),o!==i&&(r.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),el(t,t.updateQueue),nl(t),null;case 4:return Q(),null===e&&Bu(t.stateNode.containerInfo),nl(t),null;case 10:return wi(t.type),nl(t),null;case 19:if(B(ua),null===(i=t.memoizedState))return nl(t),null;if(r=0!==(128&t.flags),null===(o=i.rendering))if(r)tl(i,!1);else{if(0!==dc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(o=ha(e))){for(t.flags|=128,tl(i,!1),e=o.updateQueue,t.updateQueue=e,el(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)jr(n,e),n=n.sibling;return G(ua,1&ua.current|2),t.child}e=e.sibling}null!==i.tail&&te()>Sc&&(t.flags|=128,r=!0,tl(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ha(o))){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,el(t,e),tl(i,!0),null===i.tail&&"hidden"===i.tailMode&&!o.alternate&&!oi)return nl(t),null}else 2*te()-i.renderingStartTime>Sc&&536870912!==n&&(t.flags|=128,r=!0,tl(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(null!==(e=i.last)?e.sibling=o:t.child=o,i.last=o)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=te(),t.sibling=null,e=ua.current,G(ua,r?1&e|2:1&e),t):(nl(t),null);case 22:case 23:return ca(t),vo(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(nl(t),6&t.subtreeFlags&&(t.flags|=8192)):nl(t),null!==(n=t.updateQueue)&&el(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&B(Gi),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),wi(Ii),nl(t),null;case 25:case 30:return null}throw Error(s(156,t.tag))}function il(e,t){switch(ni(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return wi(Ii),Q(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return K(t),null;case 13:if(ca(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));fi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return B(ua),null;case 4:return Q(),null;case 10:return wi(t.type),null;case 22:case 23:return ca(t),vo(),null!==e&&B(Gi),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return wi(Ii),null;default:return null}}function ol(e,t){switch(ni(t),t.tag){case 3:wi(Ii),Q();break;case 26:case 27:case 5:K(t);break;case 4:Q();break;case 13:ca(t);break;case 19:B(ua);break;case 10:wi(t.type);break;case 22:case 23:ca(t),vo(),null!==e&&B(Gi);break;case 24:wi(Ii)}}function sl(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var i=r.next;n=i;do{if((n.tag&e)===e){r=void 0;var o=n.create,s=n.inst;r=o(),s.destroy=r}n=n.next}while(n!==i)}}catch(a){uu(t,t.return,a)}}function al(e,t,n){try{var r=t.updateQueue,i=null!==r?r.lastEffect:null;if(null!==i){var o=i.next;r=o;do{if((r.tag&e)===e){var s=r.inst,a=s.destroy;if(void 0!==a){s.destroy=void 0,i=t;var l=n,c=a;try{c()}catch(u){uu(i,l,u)}}}r=r.next}while(r!==o)}}catch(u){uu(t,t.return,u)}}function ll(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{fo(t,n)}catch(r){uu(e,e.return,r)}}}function cl(e,t,n){n.props=ma(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){uu(e,t,r)}}function ul(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"===typeof n?e.refCleanup=n(r):n.current=r}}catch(i){uu(e,t,i)}}function hl(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(i){uu(e,t,i)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(o){uu(e,t,o)}else n.current=null}function dl(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(i){uu(e,e.return,i)}}function fl(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,o=null,a=null,l=null,c=null,u=null,h=null;for(p in n){var d=n[p];if(n.hasOwnProperty(p)&&null!=d)switch(p){case"checked":case"value":break;case"defaultValue":c=d;default:r.hasOwnProperty(p)||Yu(e,t,p,null,r,d)}}for(var f in r){var p=r[f];if(d=n[f],r.hasOwnProperty(f)&&(null!=p||null!=d))switch(f){case"type":o=p;break;case"name":i=p;break;case"checked":u=p;break;case"defaultChecked":h=p;break;case"value":a=p;break;case"defaultValue":l=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(s(137,t));break;default:p!==d&&Yu(e,t,f,p,r,d)}}return void mt(e,a,l,c,u,h,o,i);case"select":for(o in p=a=l=f=null,n)if(c=n[o],n.hasOwnProperty(o)&&null!=c)switch(o){case"value":break;case"multiple":p=c;default:r.hasOwnProperty(o)||Yu(e,t,o,null,r,c)}for(i in r)if(o=r[i],c=n[i],r.hasOwnProperty(i)&&(null!=o||null!=c))switch(i){case"value":f=o;break;case"defaultValue":l=o;break;case"multiple":a=o;default:o!==c&&Yu(e,t,i,o,r,c)}return t=l,n=a,r=p,void(null!=f?bt(e,!!n,f,!1):!!r!==!!n&&(null!=t?bt(e,!!n,t,!0):bt(e,!!n,n?[]:"",!1)));case"textarea":for(l in p=f=null,n)if(i=n[l],n.hasOwnProperty(l)&&null!=i&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:Yu(e,t,l,null,r,i)}for(a in r)if(i=r[a],o=n[a],r.hasOwnProperty(a)&&(null!=i||null!=o))switch(a){case"value":f=i;break;case"defaultValue":p=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(s(91));break;default:i!==o&&Yu(e,t,a,i,r,o)}return void wt(e,f,p);case"option":for(var g in n)if(f=n[g],n.hasOwnProperty(g)&&null!=f&&!r.hasOwnProperty(g))if("selected"===g)e.selected=!1;else Yu(e,t,g,null,r,f);for(c in r)if(f=r[c],p=n[c],r.hasOwnProperty(c)&&f!==p&&(null!=f||null!=p))if("selected"===c)e.selected=f&&"function"!==typeof f&&"symbol"!==typeof f;else Yu(e,t,c,f,r,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var m in n)f=n[m],n.hasOwnProperty(m)&&null!=f&&!r.hasOwnProperty(m)&&Yu(e,t,m,null,r,f);for(u in r)if(f=r[u],p=n[u],r.hasOwnProperty(u)&&f!==p&&(null!=f||null!=p))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(s(137,t));break;default:Yu(e,t,u,f,r,p)}return;default:if(Tt(t)){for(var y in n)f=n[y],n.hasOwnProperty(y)&&void 0!==f&&!r.hasOwnProperty(y)&&Zu(e,t,y,void 0,r,f);for(h in r)f=r[h],p=n[h],!r.hasOwnProperty(h)||f===p||void 0===f&&void 0===p||Zu(e,t,h,f,r,p);return}}for(var v in n)f=n[v],n.hasOwnProperty(v)&&null!=f&&!r.hasOwnProperty(v)&&Yu(e,t,v,null,r,f);for(d in r)f=r[d],p=n[d],!r.hasOwnProperty(d)||f===p||null==f&&null==p||Yu(e,t,d,f,r,p)}(r,e.type,n,t),r[xe]=t}catch(i){uu(e,e.return,i)}}function pl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&fh(e.type)||4===e.tag}function gl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||pl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&fh(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ml(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Xu));else if(4!==r&&(27===r&&fh(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(ml(e,t,n),e=e.sibling;null!==e;)ml(e,t,n),e=e.sibling}function yl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&fh(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(yl(e,t,n),e=e.sibling;null!==e;)yl(e,t,n),e=e.sibling}function vl(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,i=t.attributes;i.length;)t.removeAttributeNode(i[0]);eh(t,r,n),t[Ie]=e,t[xe]=n}catch(o){uu(e,e.return,o)}}var bl=!1,wl=!1,kl=!1,Sl="function"===typeof WeakSet?WeakSet:Set,Cl=null;function Ol(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:Dl(e,n),4&r&&sl(5,n);break;case 1:if(Dl(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(s){uu(n,n.return,s)}else{var i=ma(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(i,t,e.__reactInternalSnapshotBeforeUpdate)}catch(a){uu(n,n.return,a)}}64&r&&ll(n),512&r&&ul(n,n.return);break;case 3:if(Dl(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{fo(e,t)}catch(s){uu(n,n.return,s)}}break;case 27:null===t&&4&r&&vl(n);case 26:case 5:Dl(e,n),null===t&&4&r&&dl(n),512&r&&ul(n,n.return);break;case 12:Dl(e,n);break;case 13:Dl(e,n),4&r&&Pl(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$?"!==e.data||"complete"===n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=pu.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||bl)){t=null!==t&&null!==t.memoizedState||wl,i=bl;var o=wl;bl=r,(wl=t)&&!o?jl(e,n,0!==(8772&n.subtreeFlags)):Dl(e,n),bl=i,wl=o}break;case 30:break;default:Dl(e,n)}}function El(e){var t=e.alternate;null!==t&&(e.alternate=null,El(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Be(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Tl=null,Rl=!1;function Al(e,t,n){for(n=n.child;null!==n;)_l(e,t,n),n=n.sibling}function _l(e,t,n){if(he&&"function"===typeof he.onCommitFiberUnmount)try{he.onCommitFiberUnmount(ue,n)}catch(o){}switch(n.tag){case 26:wl||hl(n,t),Al(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:wl||hl(n,t);var r=Tl,i=Rl;fh(n.type)&&(Tl=n.stateNode,Rl=!1),Al(e,t,n),kh(n.stateNode),Tl=r,Rl=i;break;case 5:wl||hl(n,t);case 6:if(r=Tl,i=Rl,Tl=null,Al(e,t,n),Rl=i,null!==(Tl=r))if(Rl)try{(9===Tl.nodeType?Tl.body:"HTML"===Tl.nodeName?Tl.ownerDocument.body:Tl).removeChild(n.stateNode)}catch(s){uu(n,t,s)}else try{Tl.removeChild(n.stateNode)}catch(s){uu(n,t,s)}break;case 18:null!==Tl&&(Rl?(ph(9===(e=Tl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Rd(e)):ph(Tl,n.stateNode));break;case 4:r=Tl,i=Rl,Tl=n.stateNode.containerInfo,Rl=!0,Al(e,t,n),Tl=r,Rl=i;break;case 0:case 11:case 14:case 15:wl||al(2,n,t),wl||al(4,n,t),Al(e,t,n);break;case 1:wl||(hl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&cl(n,t,r)),Al(e,t,n);break;case 21:Al(e,t,n);break;case 22:wl=(r=wl)||null!==n.memoizedState,Al(e,t,n),wl=r;break;default:Al(e,t,n)}}function Pl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Rd(e)}catch(n){uu(t,t.return,n)}}function Ml(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Sl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Sl),t;default:throw Error(s(435,e.tag))}}(e);t.forEach(function(t){var r=gu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}function Il(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r],o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 27:if(fh(l.type)){Tl=l.stateNode,Rl=!1;break e}break;case 5:Tl=l.stateNode,Rl=!1;break e;case 3:case 4:Tl=l.stateNode.containerInfo,Rl=!0;break e}l=l.return}if(null===Tl)throw Error(s(160));_l(o,a,i),Tl=null,Rl=!1,null!==(o=i.alternate)&&(o.return=null),i.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)Nl(t,e),t=t.sibling}var xl=null;function Nl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Il(t,e),Ll(e),4&r&&(al(3,e,e.return),sl(3,e),al(5,e,e.return));break;case 1:Il(t,e),Ll(e),512&r&&(wl||null===n||hl(n,n.return)),64&r&&bl&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var i=xl;if(Il(t,e),Ll(e),512&r&&(wl||null===n||hl(n,n.return)),4&r){var o=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,i=i.ownerDocument||i;t:switch(r){case"title":(!(o=i.getElementsByTagName("title")[0])||o[je]||o[Ie]||"http://www.w3.org/2000/svg"===o.namespaceURI||o.hasAttribute("itemprop"))&&(o=i.createElement(r),i.head.insertBefore(o,i.querySelector("head > title"))),eh(o,r,n),o[Ie]=e,Ve(o),r=o;break e;case"link":var a=jh("link","href",i).get(r+(n.href||""));if(a)for(var l=0;l<a.length;l++)if((o=a[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&o.getAttribute("rel")===(null==n.rel?null:n.rel)&&o.getAttribute("title")===(null==n.title?null:n.title)&&o.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){a.splice(l,1);break t}eh(o=i.createElement(r),r,n),i.head.appendChild(o);break;case"meta":if(a=jh("meta","content",i).get(r+(n.content||"")))for(l=0;l<a.length;l++)if((o=a[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&o.getAttribute("name")===(null==n.name?null:n.name)&&o.getAttribute("property")===(null==n.property?null:n.property)&&o.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&o.getAttribute("charset")===(null==n.charSet?null:n.charSet)){a.splice(l,1);break t}eh(o=i.createElement(r),r,n),i.head.appendChild(o);break;default:throw Error(s(468,r))}o[Ie]=e,Ve(o),r=o}e.stateNode=r}else Bh(i,e.type,e.stateNode);else e.stateNode=Nh(i,r,e.memoizedProps);else o!==r?(null===o?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):o.count--,null===r?Bh(i,e.type,e.stateNode):Nh(i,r,e.memoizedProps)):null===r&&null!==e.stateNode&&fl(e,e.memoizedProps,n.memoizedProps)}break;case 27:Il(t,e),Ll(e),512&r&&(wl||null===n||hl(n,n.return)),null!==n&&4&r&&fl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Il(t,e),Ll(e),512&r&&(wl||null===n||hl(n,n.return)),32&e.flags){i=e.stateNode;try{St(i,"")}catch(p){uu(e,e.return,p)}}4&r&&null!=e.stateNode&&fl(e,i=e.memoizedProps,null!==n?n.memoizedProps:i),1024&r&&(kl=!0);break;case 6:if(Il(t,e),Ll(e),4&r){if(null===e.stateNode)throw Error(s(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(p){uu(e,e.return,p)}}break;case 3:if(zh=null,i=xl,xl=Oh(t.containerInfo),Il(t,e),xl=i,Ll(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Rd(t.containerInfo)}catch(p){uu(e,e.return,p)}kl&&(kl=!1,Ul(e));break;case 4:r=xl,xl=Oh(e.stateNode.containerInfo),Il(t,e),Ll(e),xl=r;break;case 12:default:Il(t,e),Ll(e);break;case 13:Il(t,e),Ll(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(kc=te()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Ml(e,r)));break;case 22:i=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,u=bl,h=wl;if(bl=u||i,wl=h||c,Il(t,e),wl=h,bl=u,Ll(e),8192&r)e:for(t=e.stateNode,t._visibility=i?-2&t._visibility:1|t._visibility,i&&(null===n||c||bl||wl||zl(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(o=c.stateNode,i)"function"===typeof(a=o.style).setProperty?a.setProperty("display","none","important"):a.display="none";else{l=c.stateNode;var d=c.memoizedProps.style,f=void 0!==d&&null!==d&&d.hasOwnProperty("display")?d.display:null;l.style.display=null==f||"boolean"===typeof f?"":(""+f).trim()}}catch(p){uu(c,c.return,p)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=i?"":c.memoizedProps}catch(p){uu(c,c.return,p)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,Ml(e,n))));break;case 19:Il(t,e),Ll(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Ml(e,r)));case 30:case 21:}}function Ll(e){var t=e.flags;if(2&t){try{for(var n,r=e.return;null!==r;){if(pl(r)){n=r;break}r=r.return}if(null==n)throw Error(s(160));switch(n.tag){case 27:var i=n.stateNode;yl(e,gl(e),i);break;case 5:var o=n.stateNode;32&n.flags&&(St(o,""),n.flags&=-33),yl(e,gl(e),o);break;case 3:case 4:var a=n.stateNode.containerInfo;ml(e,gl(e),a);break;default:throw Error(s(161))}}catch(l){uu(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Ul(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Ul(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Dl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Ol(e,t.alternate,t),t=t.sibling}function zl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:al(4,t,t.return),zl(t);break;case 1:hl(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&cl(t,t.return,n),zl(t);break;case 27:kh(t.stateNode);case 26:case 5:hl(t,t.return),zl(t);break;case 22:null===t.memoizedState&&zl(t);break;default:zl(t)}e=e.sibling}}function jl(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,i=e,o=t,s=o.flags;switch(o.tag){case 0:case 11:case 15:jl(i,o,n),sl(4,o);break;case 1:if(jl(i,o,n),"function"===typeof(i=(r=o).stateNode).componentDidMount)try{i.componentDidMount()}catch(c){uu(r,r.return,c)}if(null!==(i=(r=o).updateQueue)){var a=r.stateNode;try{var l=i.shared.hiddenCallbacks;if(null!==l)for(i.shared.hiddenCallbacks=null,i=0;i<l.length;i++)ho(l[i],a)}catch(c){uu(r,r.return,c)}}n&&64&s&&ll(o),ul(o,o.return);break;case 27:vl(o);case 26:case 5:jl(i,o,n),n&&null===r&&4&s&&dl(o),ul(o,o.return);break;case 12:jl(i,o,n);break;case 13:jl(i,o,n),n&&4&s&&Pl(i,o);break;case 22:null===o.memoizedState&&jl(i,o,n),ul(o,o.return);break;case 30:break;default:jl(i,o,n)}t=t.sibling}}function Bl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Ni(n))}function Gl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ni(e))}function Fl(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Hl(e,t,n,r),t=t.sibling}function Hl(e,t,n,r){var i=t.flags;switch(t.tag){case 0:case 11:case 15:Fl(e,t,n,r),2048&i&&sl(9,t);break;case 1:case 13:default:Fl(e,t,n,r);break;case 3:Fl(e,t,n,r),2048&i&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ni(e)));break;case 12:if(2048&i){Fl(e,t,n,r),e=t.stateNode;try{var o=t.memoizedProps,s=o.id,a=o.onPostCommit;"function"===typeof a&&a(s,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){uu(t,t.return,l)}}else Fl(e,t,n,r);break;case 23:break;case 22:o=t.stateNode,s=t.alternate,null!==t.memoizedState?2&o._visibility?Fl(e,t,n,r):Vl(e,t):2&o._visibility?Fl(e,t,n,r):(o._visibility|=2,ql(e,t,n,r,0!==(10256&t.subtreeFlags))),2048&i&&Bl(s,t);break;case 24:Fl(e,t,n,r),2048&i&&Gl(t.alternate,t)}}function ql(e,t,n,r,i){for(i=i&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var o=e,s=t,a=n,l=r,c=s.flags;switch(s.tag){case 0:case 11:case 15:ql(o,s,a,l,i),sl(8,s);break;case 23:break;case 22:var u=s.stateNode;null!==s.memoizedState?2&u._visibility?ql(o,s,a,l,i):Vl(o,s):(u._visibility|=2,ql(o,s,a,l,i)),i&&2048&c&&Bl(s.alternate,s);break;case 24:ql(o,s,a,l,i),i&&2048&c&&Gl(s.alternate,s);break;default:ql(o,s,a,l,i)}t=t.sibling}}function Vl(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,i=r.flags;switch(r.tag){case 22:Vl(n,r),2048&i&&Bl(r.alternate,r);break;case 24:Vl(n,r),2048&i&&Gl(r.alternate,r);break;default:Vl(n,r)}t=t.sibling}}var Wl=8192;function Ql(e){if(e.subtreeFlags&Wl)for(e=e.child;null!==e;)$l(e),e=e.sibling}function $l(e){switch(e.tag){case 26:Ql(e),e.flags&Wl&&null!==e.memoizedState&&function(e,t,n){if(null===Fh)throw Error(s(475));var r=Fh;if("stylesheet"===t.type&&("string"!==typeof n.media||!1!==matchMedia(n.media).matches)&&0===(4&t.state.loading)){if(null===t.instance){var i=_h(n.href),o=e.querySelector(Ph(i));if(o)return null!==(e=o._p)&&"object"===typeof e&&"function"===typeof e.then&&(r.count++,r=qh.bind(r),e.then(r,r)),t.state.loading|=4,t.instance=o,void Ve(o);o=e.ownerDocument||e,n=Mh(n),(i=Sh.get(i))&&Uh(n,i),Ve(o=o.createElement("link"));var a=o;a._p=new Promise(function(e,t){a.onload=e,a.onerror=t}),eh(o,"link",n),t.instance=o}null===r.stylesheets&&(r.stylesheets=new Map),r.stylesheets.set(t,e),(e=t.state.preload)&&0===(3&t.state.loading)&&(r.count++,t=qh.bind(r),e.addEventListener("load",t),e.addEventListener("error",t))}}(xl,e.memoizedState,e.memoizedProps);break;case 5:default:Ql(e);break;case 3:case 4:var t=xl;xl=Oh(e.stateNode.containerInfo),Ql(e),xl=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Wl,Wl=16777216,Ql(e),Wl=t):Ql(e))}}function Kl(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Jl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Cl=r,Zl(r,e)}Kl(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Xl(e),e=e.sibling}function Xl(e){switch(e.tag){case 0:case 11:case 15:Jl(e),2048&e.flags&&al(9,e,e.return);break;case 3:case 12:default:Jl(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,Yl(e)):Jl(e)}}function Yl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Cl=r,Zl(r,e)}Kl(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:al(8,t,t.return),Yl(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,Yl(t));break;default:Yl(t)}e=e.sibling}}function Zl(e,t){for(;null!==Cl;){var n=Cl;switch(n.tag){case 0:case 11:case 15:al(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Ni(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,Cl=r;else e:for(n=e;null!==Cl;){var i=(r=Cl).sibling,o=r.return;if(El(r),r===n){Cl=null;break e}if(null!==i){i.return=o,Cl=i;break e}Cl=o}}}var ec={getCacheForType:function(e){var t=Ti(Ii),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},tc="function"===typeof WeakMap?WeakMap:Map,nc=0,rc=null,ic=null,oc=0,sc=0,ac=null,lc=!1,cc=!1,uc=!1,hc=0,dc=0,fc=0,pc=0,gc=0,mc=0,yc=0,vc=null,bc=null,wc=!1,kc=0,Sc=1/0,Cc=null,Oc=null,Ec=0,Tc=null,Rc=null,Ac=0,_c=0,Pc=null,Mc=null,Ic=0,xc=null;function Nc(){if(0!==(2&nc)&&0!==oc)return oc&-oc;if(null!==N.T){return 0!==Di?Di:_u()}return Pe()}function Lc(){0===mc&&(mc=0===(536870912&oc)||oi?Se():536870912);var e=ia.current;return null!==e&&(e.flags|=32),mc}function Uc(e,t,n){(e!==rc||2!==sc&&9!==sc)&&null===e.cancelPendingCommit||(Hc(e,0),Bc(e,oc,mc,!1)),Ee(e,n),0!==(2&nc)&&e===rc||(e===rc&&(0===(2&nc)&&(pc|=n),4===dc&&Bc(e,oc,mc,!1)),Su(e))}function Dc(e,t,n){if(0!==(6&nc))throw Error(s(327));for(var r=!n&&0===(124&t)&&0===(t&e.expiredLanes)||we(e,t),i=r?function(e,t){var n=nc;nc|=2;var r=Vc(),i=Wc();rc!==e||oc!==t?(Cc=null,Sc=te()+500,Hc(e,t)):cc=we(e,t);e:for(;;)try{if(0!==sc&&null!==ic){t=ic;var o=ac;t:switch(sc){case 1:sc=0,ac=null,Zc(e,t,o,1);break;case 2:case 9:if(Ki(o)){sc=0,ac=null,Yc(t);break}t=function(){2!==sc&&9!==sc||rc!==e||(sc=7),Su(e)},o.then(t,t);break e;case 3:sc=7;break e;case 4:sc=5;break e;case 7:Ki(o)?(sc=0,ac=null,Yc(t)):(sc=0,ac=null,Zc(e,t,o,7));break;case 5:var a=null;switch(ic.tag){case 26:a=ic.memoizedState;case 5:case 27:var l=ic;if(!a||Gh(a)){sc=0,ac=null;var c=l.sibling;if(null!==c)ic=c;else{var u=l.return;null!==u?(ic=u,eu(u)):ic=null}break t}}sc=0,ac=null,Zc(e,t,o,5);break;case 6:sc=0,ac=null,Zc(e,t,o,6);break;case 8:Fc(),dc=6;break e;default:throw Error(s(462))}}Jc();break}catch(h){qc(e,h)}return vi=yi=null,N.H=r,N.A=i,nc=n,null!==ic?0:(rc=null,oc=0,Ar(),dc)}(e,t):$c(e,t,!0),o=r;;){if(0===i){cc&&!r&&Bc(e,t,0,!1);break}if(n=e.current.alternate,!o||jc(n)){if(2===i){if(o=t,e.errorRecoveryDisabledLanes&o)var a=0;else a=0!==(a=-536870913&e.pendingLanes)?a:536870912&a?536870912:0;if(0!==a){t=a;e:{var l=e;i=vc;var c=l.current.memoizedState.isDehydrated;if(c&&(Hc(l,a).flags|=256),2!==(a=$c(l,a,!1))){if(uc&&!c){l.errorRecoveryDisabledLanes|=o,pc|=o,i=4;break e}o=bc,bc=i,null!==o&&(null===bc?bc=o:bc.push.apply(bc,o))}i=a}if(o=!1,2!==i)continue}}if(1===i){Hc(e,0),Bc(e,t,0,!0);break}e:{switch(r=e,o=i){case 0:case 1:throw Error(s(345));case 4:if((4194048&t)!==t)break;case 6:Bc(r,t,mc,!lc);break e;case 2:bc=null;break;case 3:case 5:break;default:throw Error(s(329))}if((62914560&t)===t&&10<(i=kc+300-te())){if(Bc(r,t,mc,!lc),0!==be(r,0,!0))break e;r.timeoutHandle=lh(zc.bind(null,r,n,bc,Cc,wc,t,mc,pc,yc,lc,o,2,-0,0),i)}else zc(r,n,bc,Cc,wc,t,mc,pc,yc,lc,o,0,-0,0)}break}i=$c(e,t,!1),o=!1}Su(e)}function zc(e,t,n,r,i,o,a,l,c,u,h,d,f,p){if(e.timeoutHandle=-1,(8192&(d=t.subtreeFlags)||16785408===(16785408&d))&&(Fh={stylesheets:null,count:0,unsuspend:Hh},$l(t),null!==(d=function(){if(null===Fh)throw Error(s(475));var e=Fh;return e.stylesheets&&0===e.count&&Wh(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&Wh(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}())))return e.cancelPendingCommit=d(nu.bind(null,e,t,o,n,r,i,a,l,c,h,1,f,p)),void Bc(e,o,a,!u);nu(e,t,o,n,r,i,a,l,c)}function jc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Kn(o(),i))return!1}catch(s){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Bc(e,t,n,r){t&=~gc,t&=~pc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var i=t;0<i;){var o=31-fe(i),s=1<<o;r[o]=-1,i&=~s}0!==n&&Te(e,n,t)}function Gc(){return 0!==(6&nc)||(Cu(0,!1),!1)}function Fc(){if(null!==ic){if(0===sc)var e=ic.return;else vi=yi=null,zo(e=ic),Ks=null,Js=0,e=ic;for(;null!==e;)ol(e.alternate,e),e=e.return;ic=null}}function Hc(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,ch(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Fc(),rc=e,ic=n=zr(e.current,null),oc=t,sc=0,ac=null,lc=!1,cc=we(e,t),uc=!1,yc=mc=gc=pc=fc=dc=0,bc=vc=null,wc=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var i=31-fe(r),o=1<<i;t|=e[i],r&=~o}return hc=t,Ar(),n}function qc(e,t){wo=null,N.H=Vs,t===Vi||t===Qi?(t=Zi(),sc=3):t===Wi?(t=Zi(),sc=4):sc=t===Ta?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,ac=t,null===ic&&(dc=1,ka(e,Or(t,e.current)))}function Vc(){var e=N.H;return N.H=Vs,null===e?Vs:e}function Wc(){var e=N.A;return N.A=ec,e}function Qc(){dc=4,lc||(4194048&oc)!==oc&&null!==ia.current||(cc=!0),0===(134217727&fc)&&0===(134217727&pc)||null===rc||Bc(rc,oc,mc,!1)}function $c(e,t,n){var r=nc;nc|=2;var i=Vc(),o=Wc();rc===e&&oc===t||(Cc=null,Hc(e,t)),t=!1;var s=dc;e:for(;;)try{if(0!==sc&&null!==ic){var a=ic,l=ac;switch(sc){case 8:Fc(),s=6;break e;case 3:case 2:case 9:case 6:null===ia.current&&(t=!0);var c=sc;if(sc=0,ac=null,Zc(e,a,l,c),n&&cc){s=0;break e}break;default:c=sc,sc=0,ac=null,Zc(e,a,l,c)}}Kc(),s=dc;break}catch(u){qc(e,u)}return t&&e.shellSuspendCounter++,vi=yi=null,nc=r,N.H=i,N.A=o,null===ic&&(rc=null,oc=0,Ar()),s}function Kc(){for(;null!==ic;)Xc(ic)}function Jc(){for(;null!==ic&&!Z();)Xc(ic)}function Xc(e){var t=Xa(e.alternate,e,hc);e.memoizedProps=e.pendingProps,null===t?eu(e):ic=t}function Yc(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Ua(n,t,t.pendingProps,t.type,void 0,oc);break;case 11:t=Ua(n,t,t.pendingProps,t.type.render,t.ref,oc);break;case 5:zo(t);default:ol(n,t),t=Xa(n,t=ic=jr(t,hc),hc)}e.memoizedProps=e.pendingProps,null===t?eu(e):ic=t}function Zc(e,t,n,r){vi=yi=null,zo(t),Ks=null,Js=0;var i=t.return;try{if(function(e,t,n,r,i){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&Ci(t,n,i,!0),null!==(n=ia.current)){switch(n.tag){case 13:return null===oa?Qc():null===n.alternate&&0===dc&&(dc=3),n.flags&=-257,n.flags|=65536,n.lanes=i,r===$i?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),hu(e,r,i)),!1;case 22:return n.flags|=65536,r===$i?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),hu(e,r,i)),!1}throw Error(s(435,n.tag))}return hu(e,r,i),Qc(),!1}if(oi)return null!==(t=ia.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,r!==li&&gi(Or(e=Error(s(422),{cause:r}),n))):(r!==li&&gi(Or(t=Error(s(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,r=Or(r,n),ao(e,i=Ca(e.stateNode,r,i)),4!==dc&&(dc=2)),!1;var o=Error(s(520),{cause:r});if(o=Or(o,n),null===vc?vc=[o]:vc.push(o),4!==dc&&(dc=2),null===t)return!0;r=Or(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=i&-i,n.lanes|=e,ao(n,e=Ca(n.stateNode,r,e)),!1;case 1:if(t=n.type,o=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==o&&"function"===typeof o.componentDidCatch&&(null===Oc||!Oc.has(o))))return n.flags|=65536,i&=-i,n.lanes|=i,Ea(i=Oa(i),e,n,r),ao(n,i),!1}n=n.return}while(null!==n);return!1}(e,i,t,n,oc))return dc=1,ka(e,Or(n,e.current)),void(ic=null)}catch(o){if(null!==i)throw ic=i,o;return dc=1,ka(e,Or(n,e.current)),void(ic=null)}32768&t.flags?(oi||1===r?e=!0:cc||0!==(536870912&oc)?e=!1:(lc=e=!0,(2===r||9===r||3===r||6===r)&&(null!==(r=ia.current)&&13===r.tag&&(r.flags|=16384))),tu(t,e)):eu(t)}function eu(e){var t=e;do{if(0!==(32768&t.flags))return void tu(t,lc);e=t.return;var n=rl(t.alternate,t,hc);if(null!==n)return void(ic=n);if(null!==(t=t.sibling))return void(ic=t);ic=t=e}while(null!==t);0===dc&&(dc=5)}function tu(e,t){do{var n=il(e.alternate,e);if(null!==n)return n.flags&=32767,void(ic=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(ic=e);ic=e=n}while(null!==e);dc=6,ic=null}function nu(e,t,n,r,i,o,a,l,c){e.cancelPendingCommit=null;do{au()}while(0!==Ec);if(0!==(6&nc))throw Error(s(327));if(null!==t){if(t===e.current)throw Error(s(177));if(o=t.lanes|t.childLanes,function(e,t,n,r,i,o){var s=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var a=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=s&~n;0<n;){var u=31-fe(n),h=1<<u;a[u]=0,l[u]=-1;var d=c[u];if(null!==d)for(c[u]=null,u=0;u<d.length;u++){var f=d[u];null!==f&&(f.lane&=-536870913)}n&=~h}0!==r&&Te(e,r,0),0!==o&&0===i&&0!==e.tag&&(e.suspendedLanes|=o&~(s&~t))}(e,n,o|=Rr,a,l,c),e===rc&&(ic=rc=null,oc=0),Rc=t,Tc=e,Ac=n,_c=o,Pc=i,Mc=r,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,X(oe,function(){return lu(),null})):(e.callbackNode=null,e.callbackPriority=0),r=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||r){r=N.T,N.T=null,i=L.p,L.p=2,a=nc,nc|=4;try{!function(e,t){if(e=e.containerInfo,th=nd,tr(e=er(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(m){n=null;break e}var a=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==i&&3!==d.nodeType||(l=a+i),d!==o||0!==r&&3!==d.nodeType||(c=a+r),3===d.nodeType&&(a+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++u===i&&(l=a),f===o&&++h===r&&(c=a),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(nh={focusedElem:e,selectionRange:n},nd=!1,Cl=t;null!==Cl;)if(e=(t=Cl).child,0!==(1024&t.subtreeFlags)&&null!==e)e.return=t,Cl=e;else for(;null!==Cl;){switch(o=(t=Cl).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==o){e=void 0,n=t,i=o.memoizedProps,o=o.memoizedState,r=n.stateNode;try{var g=ma(n.type,i,(n.elementType,n.type));e=r.getSnapshotBeforeUpdate(g,o),r.__reactInternalSnapshotBeforeUpdate=e}catch(y){uu(n,n.return,y)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))gh(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":gh(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(s(163))}if(null!==(e=t.sibling)){e.return=t.return,Cl=e;break}Cl=t.return}}(e,t)}finally{nc=a,L.p=i,N.T=r}}Ec=1,ru(),iu(),ou()}}function ru(){if(1===Ec){Ec=0;var e=Tc,t=Rc,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=N.T,N.T=null;var r=L.p;L.p=2;var i=nc;nc|=4;try{Nl(t,e);var o=nh,s=er(e.containerInfo),a=o.focusedElem,l=o.selectionRange;if(s!==a&&a&&a.ownerDocument&&Zn(a.ownerDocument.documentElement,a)){if(null!==l&&tr(a)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in a)a.selectionStart=c,a.selectionEnd=Math.min(u,a.value.length);else{var h=a.ownerDocument||document,d=h&&h.defaultView||window;if(d.getSelection){var f=d.getSelection(),p=a.textContent.length,g=Math.min(l.start,p),m=void 0===l.end?g:Math.min(l.end,p);!f.extend&&g>m&&(s=m,m=g,g=s);var y=Yn(a,g),v=Yn(a,m);if(y&&v&&(1!==f.rangeCount||f.anchorNode!==y.node||f.anchorOffset!==y.offset||f.focusNode!==v.node||f.focusOffset!==v.offset)){var b=h.createRange();b.setStart(y.node,y.offset),f.removeAllRanges(),g>m?(f.addRange(b),f.extend(v.node,v.offset)):(b.setEnd(v.node,v.offset),f.addRange(b))}}}}for(h=[],f=a;f=f.parentNode;)1===f.nodeType&&h.push({element:f,left:f.scrollLeft,top:f.scrollTop});for("function"===typeof a.focus&&a.focus(),a=0;a<h.length;a++){var w=h[a];w.element.scrollLeft=w.left,w.element.scrollTop=w.top}}nd=!!th,nh=th=null}finally{nc=i,L.p=r,N.T=n}}e.current=t,Ec=2}}function iu(){if(2===Ec){Ec=0;var e=Tc,t=Rc,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=N.T,N.T=null;var r=L.p;L.p=2;var i=nc;nc|=4;try{Ol(e,t.alternate,t)}finally{nc=i,L.p=r,N.T=n}}Ec=3}}function ou(){if(4===Ec||3===Ec){Ec=0,ee();var e=Tc,t=Rc,n=Ac,r=Mc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Ec=5:(Ec=0,Rc=Tc=null,su(e,e.pendingLanes));var i=e.pendingLanes;if(0===i&&(Oc=null),_e(n),t=t.stateNode,he&&"function"===typeof he.onCommitFiberRoot)try{he.onCommitFiberRoot(ue,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==r){t=N.T,i=L.p,L.p=2,N.T=null;try{for(var o=e.onRecoverableError,s=0;s<r.length;s++){var a=r[s];o(a.value,{componentStack:a.stack})}}finally{N.T=t,L.p=i}}0!==(3&Ac)&&au(),Su(e),i=e.pendingLanes,0!==(4194090&n)&&0!==(42&i)?e===xc?Ic++:(Ic=0,xc=e):Ic=0,Cu(0,!1)}}function su(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Ni(t)))}function au(e){return ru(),iu(),ou(),lu()}function lu(){if(5!==Ec)return!1;var e=Tc,t=_c;_c=0;var n=_e(Ac),r=N.T,i=L.p;try{L.p=32>n?32:n,N.T=null,n=Pc,Pc=null;var o=Tc,a=Ac;if(Ec=0,Rc=Tc=null,Ac=0,0!==(6&nc))throw Error(s(331));var l=nc;if(nc|=4,Xl(o.current),Hl(o,o.current,a,n),nc=l,Cu(0,!1),he&&"function"===typeof he.onPostCommitFiberRoot)try{he.onPostCommitFiberRoot(ue,o)}catch(c){}return!0}finally{L.p=i,N.T=r,su(e,t)}}function cu(e,t,n){t=Or(n,t),null!==(e=oo(e,t=Ca(e.stateNode,t,2),2))&&(Ee(e,2),Su(e))}function uu(e,t,n){if(3===e.tag)cu(e,e,n);else for(;null!==t;){if(3===t.tag){cu(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Oc||!Oc.has(r))){e=Or(n,e),null!==(r=oo(t,n=Oa(2),2))&&(Ea(n,r,t,e),Ee(r,2),Su(r));break}}t=t.return}}function hu(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new tc;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(uc=!0,i.add(n),e=du.bind(null,e,t,n),t.then(e,e))}function du(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,rc===e&&(oc&n)===n&&(4===dc||3===dc&&(62914560&oc)===oc&&300>te()-kc?0===(2&nc)&&Hc(e,0):gc|=n,yc===oc&&(yc=0)),Su(e)}function fu(e,t){0===t&&(t=Ce()),null!==(e=Mr(e,t))&&(Ee(e,t),Su(e))}function pu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),fu(e,n)}function gu(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(s(314))}null!==r&&r.delete(t),fu(e,n)}var mu=null,yu=null,vu=!1,bu=!1,wu=!1,ku=0;function Su(e){e!==yu&&null===e.next&&(null===yu?mu=yu=e:yu=yu.next=e),bu=!0,vu||(vu=!0,hh(function(){0!==(6&nc)?X(re,Ou):Eu()}))}function Cu(e,t){if(!wu&&bu){wu=!0;do{for(var n=!1,r=mu;null!==r;){if(!t)if(0!==e){var i=r.pendingLanes;if(0===i)var o=0;else{var s=r.suspendedLanes,a=r.pingedLanes;o=(1<<31-fe(42|e)+1)-1,o=201326741&(o&=i&~(s&~a))?201326741&o|1:o?2|o:0}0!==o&&(n=!0,Au(r,o))}else o=oc,0===(3&(o=be(r,r===rc?o:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||we(r,o)||(n=!0,Au(r,o));r=r.next}}while(n);wu=!1}}function Ou(){Eu()}function Eu(){bu=vu=!1;var e=0;0!==ku&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==ah&&(ah=e,!0);return ah=null,!1}()&&(e=ku),ku=0);for(var t=te(),n=null,r=mu;null!==r;){var i=r.next,o=Tu(r,t);0===o?(r.next=null,null===n?mu=i:n.next=i,null===i&&(yu=n)):(n=r,(0!==e||0!==(3&o))&&(bu=!0)),r=i}Cu(e,!1)}function Tu(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=-62914561&e.pendingLanes;0<o;){var s=31-fe(o),a=1<<s,l=i[s];-1===l?0!==(a&n)&&0===(a&r)||(i[s]=ke(a,t)):l<=t&&(e.expiredLanes|=a),o&=~a}if(n=oc,n=be(e,e===(t=rc)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===sc||9===sc)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&Y(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||we(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&Y(r),_e(n)){case 2:case 8:n=ie;break;case 32:default:n=oe;break;case 268435456:n=ae}return r=Ru.bind(null,e),n=X(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&Y(r),e.callbackPriority=2,e.callbackNode=null,2}function Ru(e,t){if(0!==Ec&&5!==Ec)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(au()&&e.callbackNode!==n)return null;var r=oc;return 0===(r=be(e,e===rc?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Dc(e,r,t),Tu(e,te()),null!=e.callbackNode&&e.callbackNode===n?Ru.bind(null,e):null)}function Au(e,t){if(au())return null;Dc(e,t,!0)}function _u(){return 0===ku&&(ku=Se()),ku}function Pu(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:_t(""+e)}function Mu(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Iu=0;Iu<kr.length;Iu++){var xu=kr[Iu];Sr(xu.toLowerCase(),"on"+(xu[0].toUpperCase()+xu.slice(1)))}Sr(fr,"onAnimationEnd"),Sr(pr,"onAnimationIteration"),Sr(gr,"onAnimationStart"),Sr("dblclick","onDoubleClick"),Sr("focusin","onFocus"),Sr("focusout","onBlur"),Sr(mr,"onTransitionRun"),Sr(yr,"onTransitionStart"),Sr(vr,"onTransitionCancel"),Sr(br,"onTransitionEnd"),Ke("onMouseEnter",["mouseout","mouseover"]),Ke("onMouseLeave",["mouseout","mouseover"]),Ke("onPointerEnter",["pointerout","pointerover"]),Ke("onPointerLeave",["pointerout","pointerover"]),$e("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),$e("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),$e("onBeforeInput",["compositionend","keypress","textInput","paste"]),$e("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),$e("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),$e("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Nu));function Uu(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;o=a,i.currentTarget=c;try{o(i)}catch(u){ya(u)}i.currentTarget=null,o=l}else for(s=0;s<r.length;s++){if(l=(a=r[s]).instance,c=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;o=a,i.currentTarget=c;try{o(i)}catch(u){ya(u)}i.currentTarget=null,o=l}}}}function Du(e,t){var n=t[Le];void 0===n&&(n=t[Le]=new Set);var r=e+"__bubble";n.has(r)||(Gu(t,e,2,!1),n.add(r))}function zu(e,t,n){var r=0;t&&(r|=4),Gu(n,e,r,t)}var ju="_reactListening"+Math.random().toString(36).slice(2);function Bu(e){if(!e[ju]){e[ju]=!0,We.forEach(function(t){"selectionchange"!==t&&(Lu.has(t)||zu(t,!1,e),zu(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[ju]||(t[ju]=!0,zu("selectionchange",!1,t))}}function Gu(e,t,n,r){switch(cd(t)){case 2:var i=rd;break;case 8:i=id;break;default:i=od}n=i.bind(null,t,n,e),i=void 0,!jt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Fu(e,t,n,r,i){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var a=r.stateNode.containerInfo;if(a===i)break;if(4===s)for(s=r.return;null!==s;){var c=s.tag;if((3===c||4===c)&&s.stateNode.containerInfo===i)return;s=s.return}for(;null!==a;){if(null===(s=Ge(a)))return;if(5===(c=s.tag)||6===c||26===c||27===c){r=o=s;continue e}a=a.parentNode}}r=r.return}Ut(function(){var r=o,i=Mt(n),s=[];e:{var a=wr.get(e);if(void 0!==a){var c=Zt,u=e;switch(e){case"keypress":if(0===Vt(n))break e;case"keydown":case"keyup":c=gn;break;case"focusin":u="focus",c=sn;break;case"focusout":u="blur",c=sn;break;case"beforeblur":case"afterblur":c=sn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=rn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=on;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=yn;break;case fr:case pr:case gr:c=an;break;case br:c=vn;break;case"scroll":case"scrollend":c=tn;break;case"wheel":c=bn;break;case"copy":case"cut":case"paste":c=ln;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=mn;break;case"toggle":case"beforetoggle":c=wn}var h=0!==(4&t),d=!h&&("scroll"===e||"scrollend"===e),f=h?null!==a?a+"Capture":null:a;h=[];for(var p,g=r;null!==g;){var m=g;if(p=m.stateNode,5!==(m=m.tag)&&26!==m&&27!==m||null===p||null===f||null!=(m=Dt(g,f))&&h.push(Hu(g,m,p)),d)break;g=g.return}0<h.length&&(a=new c(a,u,null,n,i),s.push({event:a,listeners:h}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===Pt||!(u=n.relatedTarget||n.fromElement)||!Ge(u)&&!u[Ne])&&(c||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?Ge(u):null)&&(d=l(u),h=u.tag,u!==d||5!==h&&27!==h&&6!==h)&&(u=null)):(c=null,u=r),c!==u)){if(h=rn,m="onMouseLeave",f="onMouseEnter",g="mouse","pointerout"!==e&&"pointerover"!==e||(h=mn,m="onPointerLeave",f="onPointerEnter",g="pointer"),d=null==c?a:He(c),p=null==u?a:He(u),(a=new h(m,g+"leave",c,n,i)).target=d,a.relatedTarget=p,m=null,Ge(i)===r&&((h=new h(f,g+"enter",u,n,i)).target=p,h.relatedTarget=d,m=h),d=m,c&&u)e:{for(f=u,g=0,p=h=c;p;p=Vu(p))g++;for(p=0,m=f;m;m=Vu(m))p++;for(;0<g-p;)h=Vu(h),g--;for(;0<p-g;)f=Vu(f),p--;for(;g--;){if(h===f||null!==f&&h===f.alternate)break e;h=Vu(h),f=Vu(f)}h=null}else h=null;null!==c&&Wu(s,a,c,h,!1),null!==u&&null!==d&&Wu(s,d,u,h,!0)}if("select"===(c=(a=r?He(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===c&&"file"===a.type)var y=zn;else if(In(a))if(jn)y=$n;else{y=Wn;var v=Vn}else!(c=a.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==a.type&&"radio"!==a.type?r&&Tt(r.elementType)&&(y=zn):y=Qn;switch(y&&(y=y(e,r))?xn(s,y,n,i):(v&&v(e,a,r),"focusout"===e&&r&&"number"===a.type&&null!=r.memoizedProps.value&&vt(a,"number",a.value)),v=r?He(r):window,e){case"focusin":(In(v)||"true"===v.contentEditable)&&(rr=v,ir=r,or=null);break;case"focusout":or=ir=rr=null;break;case"mousedown":sr=!0;break;case"contextmenu":case"mouseup":case"dragend":sr=!1,ar(s,n,i);break;case"selectionchange":if(nr)break;case"keydown":case"keyup":ar(s,n,i)}var b;if(Sn)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Pn?An(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(En&&"ko"!==n.locale&&(Pn||"onCompositionStart"!==w?"onCompositionEnd"===w&&Pn&&(b=qt()):(Ft="value"in(Gt=i)?Gt.value:Gt.textContent,Pn=!0)),0<(v=qu(r,w)).length&&(w=new cn(w,e,null,n,i),s.push({event:w,listeners:v}),b?w.data=b:null!==(b=_n(n))&&(w.data=b))),(b=On?function(e,t){switch(e){case"compositionend":return _n(t);case"keypress":return 32!==t.which?null:(Rn=!0,Tn);case"textInput":return(e=t.data)===Tn&&Rn?null:e;default:return null}}(e,n):function(e,t){if(Pn)return"compositionend"===e||!Sn&&An(e,t)?(e=qt(),Ht=Ft=Gt=null,Pn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return En&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(w=qu(r,"onBeforeInput")).length&&(v=new cn("onBeforeInput","beforeinput",null,n,i),s.push({event:v,listeners:w}),v.data=b)),function(e,t,n,r,i){if("submit"===t&&n&&n.stateNode===i){var o=Pu((i[xe]||null).action),s=r.submitter;s&&null!==(t=(t=s[xe]||null)?Pu(t.formAction):s.getAttribute("formAction"))&&(o=t,s=null);var a=new Zt("action","action",null,r,i);e.push({event:a,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==ku){var e=s?Mu(i,s):new FormData(i);Ms(n,{pending:!0,data:e,method:i.method,action:o},null,e)}}else"function"===typeof o&&(a.preventDefault(),e=s?Mu(i,s):new FormData(i),Ms(n,{pending:!0,data:e,method:i.method,action:o},o,e))},currentTarget:i}]})}}(s,e,r,n,i)}Uu(s,t)})}function Hu(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qu(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;if(5!==(i=i.tag)&&26!==i&&27!==i||null===o||(null!=(i=Dt(e,n))&&r.unshift(Hu(e,i,o)),null!=(i=Dt(e,t))&&r.push(Hu(e,i,o))),3===e.tag)return r;e=e.return}return[]}function Vu(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Wu(e,t,n,r,i){for(var o=t._reactName,s=[];null!==n&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(a=a.tag,null!==l&&l===r)break;5!==a&&26!==a&&27!==a||null===c||(l=c,i?null!=(c=Dt(n,o))&&s.unshift(Hu(n,c,l)):i||null!=(c=Dt(n,o))&&s.push(Hu(n,c,l))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Qu=/\r\n?/g,$u=/\u0000|\uFFFD/g;function Ku(e){return("string"===typeof e?e:""+e).replace(Qu,"\n").replace($u,"")}function Ju(e,t){return t=Ku(t),Ku(e)===t}function Xu(){}function Yu(e,t,n,r,i,o){switch(n){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||St(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&St(e,""+r);break;case"className":nt(e,"class",r);break;case"tabIndex":nt(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":nt(e,n,r);break;case"style":Et(e,r,o);break;case"data":if("object"!==t){nt(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=_t(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof o&&("formAction"===n?("input"!==t&&Yu(e,t,"name",i.name,i,null),Yu(e,t,"formEncType",i.formEncType,i,null),Yu(e,t,"formMethod",i.formMethod,i,null),Yu(e,t,"formTarget",i.formTarget,i,null)):(Yu(e,t,"encType",i.encType,i,null),Yu(e,t,"method",i.method,i,null),Yu(e,t,"target",i.target,i,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=_t(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=Xu);break;case"onScroll":null!=r&&Du("scroll",e);break;case"onScrollEnd":null!=r&&Du("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(s(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(s(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}n=_t(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":Du("beforetoggle",e),Du("toggle",e),tt(e,"popover",r);break;case"xlinkActuate":rt(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":rt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":rt(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":rt(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":rt(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":rt(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":rt(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":rt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":rt(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":tt(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&tt(e,n=Rt.get(n)||n,r)}}function Zu(e,t,n,r,i,o){switch(n){case"style":Et(e,r,o);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(s(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(s(60));e.innerHTML=n}}break;case"children":"string"===typeof r?St(e,r):("number"===typeof r||"bigint"===typeof r)&&St(e,""+r);break;case"onScroll":null!=r&&Du("scroll",e);break;case"onScrollEnd":null!=r&&Du("scrollend",e);break;case"onClick":null!=r&&(e.onclick=Xu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Qe.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(i=n.endsWith("Capture"),t=n.slice(2,i?n.length-7:void 0),"function"===typeof(o=null!=(o=e[xe]||null)?o[n]:null)&&e.removeEventListener(t,o,i),"function"!==typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):tt(e,n,r):("function"!==typeof o&&null!==o&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,i)))}}function eh(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Du("error",e),Du("load",e);var r,i=!1,o=!1;for(r in n)if(n.hasOwnProperty(r)){var a=n[r];if(null!=a)switch(r){case"src":i=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Yu(e,t,r,a,n,null)}}return o&&Yu(e,t,"srcSet",n.srcSet,n,null),void(i&&Yu(e,t,"src",n.src,n,null));case"input":Du("invalid",e);var l=r=a=o=null,c=null,u=null;for(i in n)if(n.hasOwnProperty(i)){var h=n[i];if(null!=h)switch(i){case"name":o=h;break;case"type":a=h;break;case"checked":c=h;break;case"defaultChecked":u=h;break;case"value":r=h;break;case"defaultValue":l=h;break;case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(s(137,t));break;default:Yu(e,t,i,h,n,null)}}return yt(e,r,l,c,u,a,o,!1),void ht(e);case"select":for(o in Du("invalid",e),i=a=r=null,n)if(n.hasOwnProperty(o)&&null!=(l=n[o]))switch(o){case"value":r=l;break;case"defaultValue":a=l;break;case"multiple":i=l;default:Yu(e,t,o,l,n,null)}return t=r,n=a,e.multiple=!!i,void(null!=t?bt(e,!!i,t,!1):null!=n&&bt(e,!!i,n,!0));case"textarea":for(a in Du("invalid",e),r=o=i=null,n)if(n.hasOwnProperty(a)&&null!=(l=n[a]))switch(a){case"value":i=l;break;case"defaultValue":o=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(s(91));break;default:Yu(e,t,a,l,n,null)}return kt(e,i,o,r),void ht(e);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(i=n[c]))if("selected"===c)e.selected=i&&"function"!==typeof i&&"symbol"!==typeof i;else Yu(e,t,c,i,n,null);return;case"dialog":Du("beforetoggle",e),Du("toggle",e),Du("cancel",e),Du("close",e);break;case"iframe":case"object":Du("load",e);break;case"video":case"audio":for(i=0;i<Nu.length;i++)Du(Nu[i],e);break;case"image":Du("error",e),Du("load",e);break;case"details":Du("toggle",e);break;case"embed":case"source":case"link":Du("error",e),Du("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(i=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Yu(e,t,u,i,n,null)}return;default:if(Tt(t)){for(h in n)n.hasOwnProperty(h)&&(void 0!==(i=n[h])&&Zu(e,t,h,i,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(i=n[l])&&Yu(e,t,l,i,n,null))}var th=null,nh=null;function rh(e){return 9===e.nodeType?e:e.ownerDocument}function ih(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function oh(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function sh(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ah=null;var lh="function"===typeof setTimeout?setTimeout:void 0,ch="function"===typeof clearTimeout?clearTimeout:void 0,uh="function"===typeof Promise?Promise:void 0,hh="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof uh?function(e){return uh.resolve(null).then(e).catch(dh)}:lh;function dh(e){setTimeout(function(){throw e})}function fh(e){return"head"===e}function ph(e,t){var n=t,r=0,i=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&8===o.nodeType)if("/$"===(n=o.data)){if(0<r&&8>r){n=r;var s=e.ownerDocument;if(1&n&&kh(s.documentElement),2&n&&kh(s.body),4&n)for(kh(n=s.head),s=n.firstChild;s;){var a=s.nextSibling,l=s.nodeName;s[je]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===s.rel.toLowerCase()||n.removeChild(s),s=a}}if(0===i)return e.removeChild(o),void Rd(t);i--}else"$"===n||"$?"===n||"$!"===n?i++:r=n.charCodeAt(0)-48;else r=0;n=o}while(n);Rd(t)}function gh(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":gh(n),Be(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function mh(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function yh(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var vh=null;function bh(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function wh(e,t,n){switch(t=rh(n),e){case"html":if(!(e=t.documentElement))throw Error(s(452));return e;case"head":if(!(e=t.head))throw Error(s(453));return e;case"body":if(!(e=t.body))throw Error(s(454));return e;default:throw Error(s(451))}}function kh(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Be(e)}var Sh=new Map,Ch=new Set;function Oh(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Eh=L.d;L.d={f:function(){var e=Eh.f(),t=Gc();return e||t},r:function(e){var t=Fe(e);null!==t&&5===t.tag&&"form"===t.type?xs(t):Eh.r(e)},D:function(e){Eh.D(e),Rh("dns-prefetch",e,null)},C:function(e,t){Eh.C(e,t),Rh("preconnect",e,t)},L:function(e,t,n){Eh.L(e,t,n);var r=Th;if(r&&e&&t){var i='link[rel="preload"][as="'+gt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(i+='[imagesrcset="'+gt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(i+='[imagesizes="'+gt(n.imageSizes)+'"]')):i+='[href="'+gt(e)+'"]';var o=i;switch(t){case"style":o=_h(e);break;case"script":o=Ih(e)}Sh.has(o)||(e=d({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Sh.set(o,e),null!==r.querySelector(i)||"style"===t&&r.querySelector(Ph(o))||"script"===t&&r.querySelector(xh(o))||(eh(t=r.createElement("link"),"link",e),Ve(t),r.head.appendChild(t)))}},m:function(e,t){Eh.m(e,t);var n=Th;if(n&&e){var r=t&&"string"===typeof t.as?t.as:"script",i='link[rel="modulepreload"][as="'+gt(r)+'"][href="'+gt(e)+'"]',o=i;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":o=Ih(e)}if(!Sh.has(o)&&(e=d({rel:"modulepreload",href:e},t),Sh.set(o,e),null===n.querySelector(i))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(xh(o)))return}eh(r=n.createElement("link"),"link",e),Ve(r),n.head.appendChild(r)}}},X:function(e,t){Eh.X(e,t);var n=Th;if(n&&e){var r=qe(n).hoistableScripts,i=Ih(e),o=r.get(i);o||((o=n.querySelector(xh(i)))||(e=d({src:e,async:!0},t),(t=Sh.get(i))&&Dh(e,t),Ve(o=n.createElement("script")),eh(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},r.set(i,o))}},S:function(e,t,n){Eh.S(e,t,n);var r=Th;if(r&&e){var i=qe(r).hoistableStyles,o=_h(e);t=t||"default";var s=i.get(o);if(!s){var a={loading:0,preload:null};if(s=r.querySelector(Ph(o)))a.loading=5;else{e=d({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Sh.get(o))&&Uh(e,n);var l=s=r.createElement("link");Ve(l),eh(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){a.loading|=1}),l.addEventListener("error",function(){a.loading|=2}),a.loading|=4,Lh(s,t,r)}s={type:"stylesheet",instance:s,count:1,state:a},i.set(o,s)}}},M:function(e,t){Eh.M(e,t);var n=Th;if(n&&e){var r=qe(n).hoistableScripts,i=Ih(e),o=r.get(i);o||((o=n.querySelector(xh(i)))||(e=d({src:e,async:!0,type:"module"},t),(t=Sh.get(i))&&Dh(e,t),Ve(o=n.createElement("script")),eh(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},r.set(i,o))}}};var Th="undefined"===typeof document?null:document;function Rh(e,t,n){var r=Th;if(r&&"string"===typeof t&&t){var i=gt(t);i='link[rel="'+e+'"][href="'+i+'"]',"string"===typeof n&&(i+='[crossorigin="'+n+'"]'),Ch.has(i)||(Ch.add(i),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(i)&&(eh(t=r.createElement("link"),"link",e),Ve(t),r.head.appendChild(t)))}}function Ah(e,t,n,r){var i,o,a,l,c=(c=q.current)?Oh(c):null;if(!c)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=_h(n.href),(r=(n=qe(c).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=_h(n.href);var u=qe(c).hoistableStyles,h=u.get(e);if(h||(c=c.ownerDocument||c,h={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,h),(u=c.querySelector(Ph(e)))&&!u._p&&(h.instance=u,h.state.loading=5),Sh.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Sh.set(e,n),u||(i=c,o=e,a=n,l=h.state,i.querySelector('link[rel="preload"][as="style"]['+o+"]")?l.loading=1:(o=i.createElement("link"),l.preload=o,o.addEventListener("load",function(){return l.loading|=1}),o.addEventListener("error",function(){return l.loading|=2}),eh(o,"link",a),Ve(o),i.head.appendChild(o))))),t&&null===r)throw Error(s(528,""));return h}if(t&&null!==r)throw Error(s(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Ih(n),(r=(n=qe(c).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function _h(e){return'href="'+gt(e)+'"'}function Ph(e){return'link[rel="stylesheet"]['+e+"]"}function Mh(e){return d({},e,{"data-precedence":e.precedence,precedence:null})}function Ih(e){return'[src="'+gt(e)+'"]'}function xh(e){return"script[async]"+e}function Nh(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+gt(n.href)+'"]');if(r)return t.instance=r,Ve(r),r;var i=d({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return Ve(r=(e.ownerDocument||e).createElement("style")),eh(r,"style",i),Lh(r,n.precedence,e),t.instance=r;case"stylesheet":i=_h(n.href);var o=e.querySelector(Ph(i));if(o)return t.state.loading|=4,t.instance=o,Ve(o),o;r=Mh(n),(i=Sh.get(i))&&Uh(r,i),Ve(o=(e.ownerDocument||e).createElement("link"));var a=o;return a._p=new Promise(function(e,t){a.onload=e,a.onerror=t}),eh(o,"link",r),t.state.loading|=4,Lh(o,n.precedence,e),t.instance=o;case"script":return o=Ih(n.src),(i=e.querySelector(xh(o)))?(t.instance=i,Ve(i),i):(r=n,(i=Sh.get(o))&&Dh(r=d({},n),i),Ve(i=(e=e.ownerDocument||e).createElement("script")),eh(i,"link",r),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(s(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,Lh(r,n.precedence,e));return t.instance}function Lh(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=r.length?r[r.length-1]:null,o=i,s=0;s<r.length;s++){var a=r[s];if(a.dataset.precedence===t)o=a;else if(o!==i)break}o?o.parentNode.insertBefore(e,o.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Uh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function Dh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var zh=null;function jh(e,t,n){if(null===zh){var r=new Map,i=zh=new Map;i.set(n,r)}else(r=(i=zh).get(n))||(r=new Map,i.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),i=0;i<n.length;i++){var o=n[i];if(!(o[je]||o[Ie]||"link"===e&&"stylesheet"===o.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==o.namespaceURI){var s=o.getAttribute(t)||"";s=e+s;var a=r.get(s);a?a.push(o):r.set(s,[o])}}return r}function Bh(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function Gh(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var Fh=null;function Hh(){}function qh(){if(this.count--,0===this.count)if(this.stylesheets)Wh(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Vh=null;function Wh(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Vh=new Map,t.forEach(Qh,e),Vh=null,qh.call(e))}function Qh(e,t){if(!(4&t.state.loading)){var n=Vh.get(e);if(n)var r=n.get(null);else{n=new Map,Vh.set(e,n);for(var i=e.querySelectorAll("link[data-precedence],style[data-precedence]"),o=0;o<i.length;o++){var s=i[o];"LINK"!==s.nodeName&&"not all"===s.getAttribute("media")||(n.set(s.dataset.precedence,s),r=s)}r&&n.set(null,r)}s=(i=t.instance).getAttribute("data-precedence"),(o=n.get(s)||r)===r&&n.set(null,i),n.set(s,i),this.count++,r=qh.bind(this),i.addEventListener("load",r),i.addEventListener("error",r),o?o.parentNode.insertBefore(i,o.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(i,e.firstChild),t.state.loading|=4}}var $h={$$typeof:k,Provider:null,Consumer:null,_currentValue:U,_currentValue2:U,_threadCount:0};function Kh(e,t,n,r,i,o,s,a){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Oe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Oe(0),this.hiddenUpdates=Oe(null),this.identifierPrefix=r,this.onUncaughtError=i,this.onCaughtError=o,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=a,this.incompleteTransitions=new Map}function Jh(e,t,n,r,i,o,s,a,l,c,u,h){return e=new Kh(e,t,n,s,a,l,c,h),t=1,!0===o&&(t|=24),o=Ur(3,null,null,t),e.current=o,o.stateNode=e,(t=xi()).refCount++,e.pooledCache=t,t.refCount++,o.memoizedState={element:r,isDehydrated:n,cache:t},no(o),e}function Xh(e){return e?e=Nr:Nr}function Yh(e,t,n,r,i,o){i=Xh(i),null===r.context?r.context=i:r.pendingContext=i,(r=io(t)).payload={element:n},null!==(o=void 0===o?null:o)&&(r.callback=o),null!==(n=oo(e,r,t))&&(Uc(n,0,t),so(n,e,t))}function Zh(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function ed(e,t){Zh(e,t),(e=e.alternate)&&Zh(e,t)}function td(e){if(13===e.tag){var t=Mr(e,67108864);null!==t&&Uc(t,0,67108864),ed(e,67108864)}}var nd=!0;function rd(e,t,n,r){var i=N.T;N.T=null;var o=L.p;try{L.p=2,od(e,t,n,r)}finally{L.p=o,N.T=i}}function id(e,t,n,r){var i=N.T;N.T=null;var o=L.p;try{L.p=8,od(e,t,n,r)}finally{L.p=o,N.T=i}}function od(e,t,n,r){if(nd){var i=sd(r);if(null===i)Fu(e,t,r,ad,n),vd(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return hd=bd(hd,e,t,n,r,i),!0;case"dragenter":return dd=bd(dd,e,t,n,r,i),!0;case"mouseover":return fd=bd(fd,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return pd.set(o,bd(pd.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,gd.set(o,bd(gd.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(vd(e,r),4&t&&-1<yd.indexOf(e)){for(;null!==i;){var o=Fe(i);if(null!==o)switch(o.tag){case 3:if((o=o.stateNode).current.memoizedState.isDehydrated){var s=ve(o.pendingLanes);if(0!==s){var a=o;for(a.pendingLanes|=2,a.entangledLanes|=2;s;){var l=1<<31-fe(s);a.entanglements[1]|=l,s&=~l}Su(o),0===(6&nc)&&(Sc=te()+500,Cu(0,!1))}}break;case 13:null!==(a=Mr(o,2))&&Uc(a,0,2),Gc(),ed(o,2)}if(null===(o=sd(r))&&Fu(e,t,r,ad,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else Fu(e,t,r,null,n)}}function sd(e){return ld(e=Mt(e))}var ad=null;function ld(e){if(ad=null,null!==(e=Ge(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=c(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return ad=e,null}function cd(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ne()){case re:return 2;case ie:return 8;case oe:case se:return 32;case ae:return 268435456;default:return 32}default:return 32}}var ud=!1,hd=null,dd=null,fd=null,pd=new Map,gd=new Map,md=[],yd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vd(e,t){switch(e){case"focusin":case"focusout":hd=null;break;case"dragenter":case"dragleave":dd=null;break;case"mouseover":case"mouseout":fd=null;break;case"pointerover":case"pointerout":pd.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":gd.delete(t.pointerId)}}function bd(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=Fe(t))&&td(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function wd(e){var t=Ge(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=c(n)))return e.blockedOn=t,void function(e,t){var n=L.p;try{return L.p=e,t()}finally{L.p=n}}(e.priority,function(){if(13===n.tag){var e=Nc();e=Ae(e);var t=Mr(n,e);null!==t&&Uc(t,0,e),ed(n,e)}})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function kd(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=sd(e.nativeEvent);if(null!==n)return null!==(t=Fe(n))&&td(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Pt=r,n.target.dispatchEvent(r),Pt=null,t.shift()}return!0}function Sd(e,t,n){kd(e)&&n.delete(t)}function Cd(){ud=!1,null!==hd&&kd(hd)&&(hd=null),null!==dd&&kd(dd)&&(dd=null),null!==fd&&kd(fd)&&(fd=null),pd.forEach(Sd),gd.forEach(Sd)}function Od(e,t){e.blockedOn===t&&(e.blockedOn=null,ud||(ud=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Cd)))}var Ed=null;function Td(e){Ed!==e&&(Ed=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Ed===e&&(Ed=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],i=e[t+2];if("function"!==typeof r){if(null===ld(r||n))continue;break}var o=Fe(n);null!==o&&(e.splice(t,3),t-=3,Ms(o,{pending:!0,data:i,method:n.method,action:r},r,i))}}))}function Rd(e){function t(t){return Od(t,e)}null!==hd&&Od(hd,e),null!==dd&&Od(dd,e),null!==fd&&Od(fd,e),pd.forEach(t),gd.forEach(t);for(var n=0;n<md.length;n++){var r=md[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<md.length&&null===(n=md[0]).blockedOn;)wd(n),null===n.blockedOn&&md.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var i=n[r],o=n[r+1],s=i[xe]||null;if("function"===typeof o)s||Td(n);else if(s){var a=null;if(o&&o.hasAttribute("formAction")){if(i=o,s=o[xe]||null)a=s.formAction;else if(null!==ld(i))continue}else a=s.action;"function"===typeof a?n[r+1]=a:(n.splice(r,3),r-=3),Td(n)}}}function Ad(e){this._internalRoot=e}function _d(e){this._internalRoot=e}_d.prototype.render=Ad.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Yh(t.current,Nc(),e,t,null,null)},_d.prototype.unmount=Ad.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;Yh(e.current,2,null,e,null,null),Gc(),t[Ne]=null}},_d.prototype.unstable_scheduleHydration=function(e){if(e){var t=Pe();e={blockedOn:null,target:e,priority:t};for(var n=0;n<md.length&&0!==t&&t<md[n].priority;n++);md.splice(n,0,e),0===n&&wd(e)}};var Pd=i.version;if("19.1.1"!==Pd)throw Error(s(527,Pd,"19.1.1"));L.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return u(i),e;if(o===r)return u(i),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,c=i.child;c;){if(c===n){a=!0,n=i,r=o;break}if(c===r){a=!0,r=i,n=o;break}c=c.sibling}if(!a){for(c=o.child;c;){if(c===n){a=!0,n=o,r=i;break}if(c===r){a=!0,r=o,n=i;break}c=c.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?h(e):null)?null:e.stateNode};var Md={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:N,reconcilerVersion:"19.1.1"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Id=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Id.isDisabled&&Id.supportsFiber)try{ue=Id.inject(Md),he=Id}catch(Nd){}}t.createRoot=function(e,t){if(!a(e))throw Error(s(299));var n=!1,r="",i=va,o=ba,l=wa;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(i=t.onUncaughtError),void 0!==t.onCaughtError&&(o=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Jh(e,1,!1,null,0,n,r,i,o,l,0,null),e[Ne]=t.current,Bu(e),new Ad(t)},t.hydrateRoot=function(e,t,n){if(!a(e))throw Error(s(299));var r=!1,i="",o=va,l=ba,c=wa,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onUncaughtError&&(o=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(u=n.formState)),(t=Jh(e,1,!0,t,0,r,i,o,l,c,0,u)).context=Xh(null),n=t.current,(i=io(r=Ae(r=Nc()))).callback=null,oo(n,i,r),n=r,t.current.lanes=n,Ee(t,n),Su(t),e[Ne]=t.current,Bu(e),new _d(t)},t.version="19.1.1"},43:(e,t,n)=>{"use strict";e.exports=n(288)},259:function(e,t,n){var r;r=()=>{var e,t={},r={exports:t},i=Object.defineProperty,o=Object.defineProperties,s=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertyNames,c=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable,d=(e,t,n)=>t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,f=(e,t)=>{for(var n in t||(t={}))u.call(t,n)&&d(e,n,t[n]);if(c)for(var n of c(t))h.call(t,n)&&d(e,n,t[n]);return e},p=(e,t)=>o(e,a(t)),g=(e,t)=>{for(var n in t)i(e,n,{get:t[n],enumerable:!0})},m={};g(m,{ErrorInfo:()=>E,Realtime:()=>or,Rest:()=>An,default:()=>ri,makeProtocolMessageFromDeserialized:()=>gn,msgpack:()=>ei}),r.exports=(e=m,((e,t,n,r)=>{if(t&&"object"===typeof t||"function"===typeof t)for(let o of l(t))u.call(e,o)||o===n||i(e,o,{get:()=>t[o],enumerable:!(r=s(t,o))||r.enumerable});return e})(i({},"__esModule",{value:!0}),e));var y=class{},v="undefined"!==typeof n.g?n.g:"undefined"!==typeof window?window:self;function b(e,t){return"".concat(e).padStart(t?3:2,"0")}function w(e){return y.Config.logTimestamps?function(t){const n=new Date;e(b(n.getHours())+":"+b(n.getMinutes())+":"+b(n.getSeconds())+"."+b(n.getMilliseconds(),1)+" "+t)}:function(t){e(t)}}var k=class e{constructor(){this.deprecated=(e,t)=>{this.deprecationWarning("".concat(e," is deprecated and will be removed in a future version. ").concat(t))},this.shouldLog=e=>e<=this.logLevel,this.setLog=(e,t)=>{void 0!==e&&(this.logLevel=e),void 0!==t&&(this.logHandler=this.logErrorHandler=t)},this.logLevel=e.defaultLogLevel,this.logHandler=e.defaultLogHandler,this.logErrorHandler=e.defaultLogErrorHandler}static initLogHandlers(){const[t,n]=(()=>{var e;let t,n;return"function"===typeof(null==(e=null==v?void 0:v.console)?void 0:e.log)?(t=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log.apply(console,t)},n=console.warn?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.warn.apply(console,t)}:t):t=n=function(){},[t,n].map(w)})();this.defaultLogHandler=t,this.defaultLogErrorHandler=n,this.defaultLogger=new e}static logActionNoStrip(e,t,n,r){e.logAction(t,n,r)}logAction(e,t,n){this.shouldLog(e)&&(1===e?this.logErrorHandler:this.logHandler)("Ably: "+t+": "+n,e)}renamedClientOption(e,t){this.deprecationWarning("The `".concat(e,"` client option has been renamed to `").concat(t,"`. Please update your code to use `").concat(t,"` instead. `").concat(e,"` will be removed in a future version."))}renamedMethod(e,t,n){this.deprecationWarning("`".concat(e,"`\u2019s `").concat(t,"` method has been renamed to `").concat(n,"`. Please update your code to use `").concat(n,"` instead. `").concat(t,"` will be removed in a future version."))}deprecationWarning(e){this.shouldLog(1)&&this.logErrorHandler("Ably: Deprecation warning - ".concat(e),1)}};k.defaultLogLevel=1,k.LOG_NONE=0,k.LOG_ERROR=1,k.LOG_MAJOR=2,k.LOG_MINOR=3,k.LOG_MICRO=4,k.logAction=(e,t,n,r)=>{k.logActionNoStrip(e,t,n,r)};var S=k,C={};function O(e){let t="["+e.constructor.name;return e.message&&(t+=": "+e.message),e.statusCode&&(t+="; statusCode="+e.statusCode),e.code&&(t+="; code="+e.code),e.cause&&(t+="; cause="+X(e.cause)),!e.href||e.message&&e.message.indexOf("help.ably.io")>-1||(t+="; see "+e.href+" "),t+="]",t}g(C,{Format:()=>W,allSame:()=>V,allToLowerCase:()=>se,allToUpperCase:()=>ae,arrChooseN:()=>ne,arrDeleteValue:()=>B,arrEquals:()=>ge,arrIntersect:()=>z,arrIntersectOb:()=>j,arrPopRandomElement:()=>Q,arrWithoutValue:()=>G,cheapRandStr:()=>ee,containsValue:()=>U,copy:()=>A,createMissingPluginError:()=>me,dataSizeBytes:()=>Z,decodeBody:()=>ie,encodeBody:()=>oe,ensureArray:()=>_,forInOwnNonNullProperties:()=>q,getBackoffCoefficient:()=>le,getGlobalObject:()=>he,getJitterCoefficient:()=>ce,getRetryTime:()=>ue,inherits:()=>L,inspectBody:()=>Y,inspectError:()=>X,intersect:()=>D,isEmpty:()=>M,isErrorInfoOrPartialErrorInfo:()=>J,isNil:()=>I,isObject:()=>P,keysArray:()=>F,matchDerivedChannel:()=>fe,mixin:()=>R,parseQueryString:()=>K,prototypicalClone:()=>N,randomString:()=>te,shallowClone:()=>x,shallowEquals:()=>de,throwMissingPluginError:()=>ye,toBase64:()=>pe,toQueryString:()=>$,valuesArray:()=>H,whenPromiseSettles:()=>re,withTimeoutAsync:()=>ve});var E=class e extends Error{constructor(t,n,r,i){super(t),"undefined"!==typeof Object.setPrototypeOf&&Object.setPrototypeOf(this,e.prototype),this.code=n,this.statusCode=r,this.cause=i}toString(){return O(this)}static fromValues(t){const{message:n,code:r,statusCode:i}=t;if("string"!==typeof n||"number"!==typeof r||"number"!==typeof i)throw new Error("ErrorInfo.fromValues(): invalid values: "+y.Config.inspect(t));const o=Object.assign(new e(n,r,i),t);return o.code&&!o.href&&(o.href="https://help.ably.io/error/"+o.code),o}},T=class e extends Error{constructor(t,n,r,i){super(t),"undefined"!==typeof Object.setPrototypeOf&&Object.setPrototypeOf(this,e.prototype),this.code=n,this.statusCode=r,this.cause=i}toString(){return O(this)}static fromValues(t){const{message:n,code:r,statusCode:i}=t;if("string"!==typeof n||!I(r)&&"number"!==typeof r||!I(i)&&"number"!==typeof i)throw new Error("PartialErrorInfo.fromValues(): invalid values: "+y.Config.inspect(t));const o=Object.assign(new e(n,r,i),t);return o.code&&!o.href&&(o.href="https://help.ably.io/error/"+o.code),o}};function R(e){for(let t=0;t<(arguments.length<=1?0:arguments.length-1);t++){const n=t+1<1||arguments.length<=t+1?void 0:arguments[t+1];if(!n)break;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}function A(e){return R({},e)}function _(e){return I(e)?[]:Array.isArray(e)?e:[e]}function P(e){return"[object Object]"==Object.prototype.toString.call(e)}function M(e){for(const t in e)return!1;return!0}function I(e){return null==e}function x(e){const t=new Object;for(const n in e)t[n]=e[n];return t}function N(e,t){class n{}n.prototype=e;const r=new n;return t&&R(r,t),r}var L=function(e,t){y.Config.inherits?y.Config.inherits(e,t):(e.super_=t,e.prototype=N(t.prototype,{constructor:e}))};function U(e,t){for(const n in e)if(e[n]==t)return!0;return!1}function D(e,t){return Array.isArray(t)?z(e,t):j(e,t)}function z(e,t){const n=[];for(let r=0;r<e.length;r++){const i=e[r];-1!=t.indexOf(i)&&n.push(i)}return n}function j(e,t){const n=[];for(let r=0;r<e.length;r++){const i=e[r];i in t&&n.push(i)}return n}function B(e,t){const n=e.indexOf(t),r=-1!=n;return r&&e.splice(n,1),r}function G(e,t){const n=e.slice();return B(n,t),n}function F(e,t){const n=[];for(const r in e)t&&!Object.prototype.hasOwnProperty.call(e,r)||n.push(r);return n}function H(e,t){const n=[];for(const r in e)t&&!Object.prototype.hasOwnProperty.call(e,r)||n.push(e[r]);return n}function q(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&e[n]&&t(n)}function V(e,t){if(0===e.length)return!0;const n=e[0][t];return e.every(function(e){return e[t]===n})}var W=(e=>(e.msgpack="msgpack",e.json="json",e))(W||{});function Q(e){return e.splice((t=e,Math.floor(Math.random()*t.length)),1)[0];var t}function $(e){const t=[];if(e)for(const n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.length?"?"+t.join("&"):""}function K(e){let t;const n=/([^?&=]+)=?([^&]*)/g,r={};for(;t=n.exec(e);)r[decodeURIComponent(t[1])]=decodeURIComponent(t[2]);return r}function J(e){return"object"==typeof e&&null!==e&&(e instanceof E||e instanceof T)}function X(e){var t,n;return e instanceof Error||"ErrorInfo"===(null==(t=null==e?void 0:e.constructor)?void 0:t.name)||"PartialErrorInfo"===(null==(n=null==e?void 0:e.constructor)?void 0:n.name)?e.toString():y.Config.inspect(e)}function Y(e){return y.BufferUtils.isBuffer(e)?e.toString():"string"===typeof e?e:y.Config.inspect(e)}function Z(e){if(y.BufferUtils.isBuffer(e))return y.BufferUtils.byteLength(e);if("string"===typeof e)return y.Config.stringByteSize(e);if("number"===typeof e)return 8;if("boolean"===typeof e)return 1;throw new Error("Expected input of Utils.dataSizeBytes to be a string, a number, a boolean or a buffer, but was: ".concat(typeof e))}function ee(){return String(Math.random()).substr(2)}var te=async e=>{const t=await y.Config.getRandomArrayBuffer(e);return y.BufferUtils.base64Encode(t)};function ne(e,t){const n=Math.min(t,e.length),r=e.slice(),i=[];for(let o=0;o<n;o++)i.push(Q(r));return i}function re(e,t){e.then(e=>{null==t||t(null,e)}).catch(e=>{null==t||t(e)})}function ie(e,t,n){return"msgpack"==n?(t||ye("MsgPack"),t.decode(e)):JSON.parse(String(e))}function oe(e,t,n){return"msgpack"==n?(t||ye("MsgPack"),t.encode(e,!0)):JSON.stringify(e)}function se(e){return e.map(function(e){return e&&e.toLowerCase()})}function ae(e){return e.map(function(e){return e&&e.toUpperCase()})}function le(e){return Math.min((e+2)/3,2)}function ce(){return 1-.2*Math.random()}function ue(e,t){return e*le(t)*ce()}function he(){return"undefined"!==typeof n.g?n.g:"undefined"!==typeof window?window:self}function de(e,t){return Object.keys(e).every(n=>e[n]===t[n])&&Object.keys(t).every(n=>t[n]===e[n])}function fe(e){const t=e.match(/^(\[([^?]*)(?:(.*))\])?(.+)$/);if(!t||!t.length||t.length<5)throw new E("regex match failed",400,40010);if(t[2])throw new E("cannot use a derived option with a ".concat(t[2]," channel"),400,40010);return{qualifierParam:t[3]||"",channelName:t[4]}}function pe(e){const t=y.BufferUtils,n=t.utf8Encode(e);return t.base64Encode(n)}function ge(e,t){return e.length===t.length&&e.every(function(e,n){return e===t[n]})}function me(e){return new E("".concat(e," plugin not provided"),40019,400)}function ye(e){throw me(e)}async function ve(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;const n=new E(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Timeout expired",5e4,500);return Promise.race([e,new Promise((e,r)=>setTimeout(()=>r(n),t))])}var be="2.13.0",we={ENDPOINT:"main",ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["main.a.fallback.ably-realtime.com","main.b.fallback.ably-realtime.com","main.c.fallback.ably-realtime.com","main.d.fallback.ably-realtime.com","main.e.fallback.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:1e4,httpMaxRetryDuration:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,webSocketConnectTimeout:1e4,webSocketSlowTimeout:4e3},httpMaxRetryCount:3,maxMessageSize:65536,version:be,protocolVersion:4,agent:"ably-js/"+be,getPort:function(e,t){return t||e.tls?e.tlsPort:e.port},getHttpScheme:function(e){return e.tls?"https://":"http://"},getPrimaryDomainFromEndpoint:Se,getEndpointFallbackHosts:Ce,getFallbackHosts:Ee,getHosts:function(e){return[e.primaryDomain].concat(Ee(e))},checkHost:Te,objectifyOptions:function(e,t,n,r,i){if(void 0===e){const e="".concat(n,t?" must be initialized with either a client options object, an Ably API key, or an Ably Token":" must be initialized with a client options object");throw S.logAction(r,S.LOG_ERROR,"".concat(n,"()"),e),new Error(e)}let o;if("string"===typeof e)if(-1==e.indexOf(":")){if(!t){const e="".concat(n," cannot be initialized with just an Ably Token; you must provide a client options object with a `plugins` property. (Set this Ably Token as the object\u2019s `token` property.)");throw S.logAction(r,S.LOG_ERROR,"".concat(n,"()"),e),new Error(e)}o={token:e}}else{if(!t){const e="".concat(n," cannot be initialized with just an Ably API key; you must provide a client options object with a `plugins` property. (Set this Ably API key as the object\u2019s `key` property.)");throw S.logAction(r,S.LOG_ERROR,"".concat(n,"()"),e),new Error(e)}o={key:e}}else o=e;return i&&(o=p(f({},o),{plugins:f(f({},i),o.plugins)})),o},normaliseOptions:function(e,t,n){const r=null!=n?n:S.defaultLogger;e.environment&&r.deprecated("The `environment` client option","Use the `endpoint` client option instead."),e.restHost&&r.deprecated("The `restHost` client option","Use the `endpoint` client option instead."),e.realtimeHost&&r.deprecated("The `realtimeHost` client option","Use the `endpoint` client option instead."),function(e){if(e.endpoint&&(e.environment||e.restHost||e.realtimeHost))throw new E("The `endpoint` option cannot be used in conjunction with the `environment`, `restHost`, or `realtimeHost` options.",40106,400);if(e.environment&&(e.restHost||e.realtimeHost))throw new E("The `environment` option cannot be used in conjunction with the `restHost`, or `realtimeHost` options.",40106,400)}(e),"function"===typeof e.recover&&!0===e.closeOnUnload&&(S.logAction(r,S.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),e.recover=void 0),"closeOnUnload"in e||(e.closeOnUnload=!e.recover),"queueMessages"in e||(e.queueMessages=!0);const i=e.endpoint||we.ENDPOINT;e.fallbackHosts||e.restHost||e.realtimeHost||e.port||e.tlsPort||(e.fallbackHosts=Ce(e.environment||i));const o=e.environment&&"".concat(e.environment,".realtime.ably.net"),s=e.restHost||e.realtimeHost||o||Se(i);(e.fallbackHosts||[]).concat(s).forEach(Te),e.port=e.port||we.PORT,e.tlsPort=e.tlsPort||we.TLS_PORT,"tls"in e||(e.tls=!0);const a=function(e){const t={};for(const n in we.TIMEOUTS)t[n]=e[n]||we.TIMEOUTS[n];return t}(e);e.useBinaryProtocol=!!t&&("useBinaryProtocol"in e?y.Config.supportsBinary&&e.useBinaryProtocol:y.Config.preferBinary);const l={};e.clientId&&(l["X-Ably-ClientId"]=y.BufferUtils.base64Encode(y.BufferUtils.utf8Encode(e.clientId))),"idempotentRestPublishing"in e||(e.idempotentRestPublishing=!0);let c=null,u=e.connectivityCheckUrl;if(e.connectivityCheckUrl){let[t,n]=e.connectivityCheckUrl.split("?");c=n?K(n):{},-1===t.indexOf("://")&&(t="https://"+t),u=t}let h=e.wsConnectivityCheckUrl;return h&&-1===h.indexOf("://")&&(h="wss://"+h),p(f({},e),{primaryDomain:s,maxMessageSize:e.maxMessageSize||we.maxMessageSize,timeouts:a,connectivityCheckParams:c,connectivityCheckUrl:u,wsConnectivityCheckUrl:h,headers:l})},defaultGetHeaders:function(e){let{format:t=Pe.format,protocolVersion:n=Pe.protocolVersion}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{accept:_e[t],"X-Ably-Version":n.toString(),"Ably-Agent":Re(e)}},defaultPostHeaders:function(e){let t,{format:n=Pe.format,protocolVersion:r=Pe.protocolVersion}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{accept:t=_e[n],"content-type":t,"X-Ably-Version":r.toString(),"Ably-Agent":Re(e)}}};function ke(e){return e.includes(".")||e.includes("::")||"localhost"===e}function Se(e){if(ke(e))return e;if(e.startsWith("nonprod:")){const t=e.replace("nonprod:","");return"".concat(t,".realtime.ably-nonprod.net")}return"".concat(e,".realtime.ably.net")}function Ce(e){return ke(e)?[]:e.startsWith("nonprod:")?Oe(e.replace("nonprod:",""),"ably-realtime-nonprod.com"):Oe(e,"ably-realtime.com")}function Oe(e,t){return["a","b","c","d","e"].map(n=>"".concat(e,".").concat(n,".fallback.").concat(t))}function Ee(e){const t=e.fallbackHosts,n="undefined"!==typeof e.httpMaxRetryCount?e.httpMaxRetryCount:we.httpMaxRetryCount;return t?ne(t,n):[]}function Te(e){if("string"!==typeof e)throw new E("host must be a string; was a "+typeof e,4e4,400);if(!e.length)throw new E("host must not be zero-length",4e4,400)}function Re(e){let t=we.agent;if(e.agents)for(var n in e.agents)t+=" "+n+"/"+e.agents[n];return t}function Ae(e,t,n){const r=n||{};if(r.cipher){e||ye("Crypto");const n=e.getCipher(r.cipher,t);r.cipher=n.cipherParams,r.channelCipher=n.cipher}else"cipher"in r&&(r.cipher=void 0,r.channelCipher=null);return r}var _e={json:"application/json",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack",text:"text/plain"},Pe={format:"json",protocolVersion:we.protocolVersion},Me=we,Ie=class e{constructor(e,t){this.logger=e,this.members=t||[]}call(e,t){for(const r of this.members)if(r)try{r(e,t)}catch(n){S.logAction(this.logger,S.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+n+"; stack = "+n.stack)}}push(){this.members.push(...arguments)}createPromise(){return new Promise((e,t)=>{this.push((n,r)=>{n?t(n):e(r)})})}resolveAll(e){this.call(null,e)}rejectAll(e){this.call(e)}static create(t,n){const r=new e(t,n);return Object.assign((e,t)=>r.call(e,t),{push:e=>r.push(e),createPromise:()=>r.createPromise(),resolveAll:e=>r.resolveAll(e),rejectAll:e=>r.rejectAll(e)})}},xe=(e=>(e.Get="get",e.Delete="delete",e.Post="post",e.Put="put",e.Patch="patch",e))(xe||{}),Ne=xe,Le=(e=>(e[e.Success=200]="Success",e[e.NoContent=204]="NoContent",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.RequestTimeout=408]="RequestTimeout",e[e.InternalServerError=500]="InternalServerError",e))(Le||{}),Ue=Le,De=Math.pow(2,17);function ze(e){return J(e)?(e.code||(403===e.statusCode?e.code=40300:(e.code=40170,e.statusCode=401)),e):new E(X(e),e.code||40170,e.statusCode||401)}function je(e){if(!e)return"";"string"==typeof e&&(e=JSON.parse(e));const t=Object.create(null),n=F(e,!0);if(!n)return"";n.sort();for(let r=0;r<n.length;r++)t[n[r]]=e[n[r]].sort();return JSON.stringify(t)}function Be(e,t){if(e.authCallback)S.logAction(t,S.LOG_MINOR,"Auth()","using token auth with authCallback");else if(e.authUrl)S.logAction(t,S.LOG_MINOR,"Auth()","using token auth with authUrl");else if(e.key)S.logAction(t,S.LOG_MINOR,"Auth()","using token auth with client-side signing");else{if(!e.tokenDetails){const e="authOptions must include valid authentication parameters";throw S.logAction(t,S.LOG_ERROR,"Auth()",e),new Error(e)}S.logAction(t,S.LOG_MINOR,"Auth()","using token auth with supplied token only")}}function Ge(e){return e.useTokenAuth||!function(e){return"useTokenAuth"in e&&!e.useTokenAuth}(e)&&(e.authCallback||e.authUrl||e.token||e.tokenDetails)}var Fe=0,He=class{constructor(e,t){if(this.authOptions={},this.client=e,this.tokenParams=t.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,Ge(t))(function(e){return!e.key&&!e.authCallback&&!e.authUrl})(t)&&S.logAction(this.logger,S.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(t.defaultTokenParams,t),Be(this.authOptions,this.logger);else{if(!t.key){const e="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw S.logAction(this.logger,S.LOG_ERROR,"Auth()",e),new E(e,40160,401)}S.logAction(this.logger,S.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(t)}}get logger(){return this.client.logger}async authorize(e,t){if(t&&t.key&&this.authOptions.key!==t.key)throw new E("Unable to update auth options with incompatible key",40102,401);try{let n=await this._forceNewToken(null!=e?e:null,null!=t?t:null);return this.client.connection?new Promise((e,t)=>{this.client.connection.connectionManager.onAuthUpdated(n,(n,r)=>n?t(n):e(r))}):n}catch(n){throw this.client.connection&&n.statusCode===Ue.Forbidden&&this.client.connection.connectionManager.actOnErrorFromAuthorize(n),n}}async _forceNewToken(e,t){this.tokenDetails=null,this._saveTokenOptions(e,t),Be(this.authOptions,this.logger);try{return this._ensureValidAuthCredentials(!0)}finally{delete this.tokenParams.timestamp,delete this.authOptions.queryTime}}async requestToken(e,t){const n=t||this.authOptions,r=e||A(this.tokenParams);let i,o=this.client;if(n.authCallback)S.logAction(this.logger,S.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),i=n.authCallback;else if(n.authUrl)S.logAction(this.logger,S.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),i=(e,t)=>{const r=R({accept:"application/json, text/plain"},n.authHeaders),i=n.authMethod&&"post"===n.authMethod.toLowerCase();let o;const s=n.authUrl.indexOf("?");s>-1&&(o=K(n.authUrl.slice(s)),n.authUrl=n.authUrl.slice(0,s),i||(n.authParams=R(o,n.authParams)));const a=R({},n.authParams||{},e),l=e=>{var n,r;let i=null!=(n=e.body)?n:null,o=null;if(e.error)S.logAction(this.logger,S.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+X(e.error));else{const t=null!=(r=e.headers["content-type"])?r:null;o=Array.isArray(t)?t.join(", "):t,S.logAction(this.logger,S.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+o+"; body: "+Y(i))}if(e.error)return void t(e.error,null);if(e.unpacked)return void t(null,i);if(y.BufferUtils.isBuffer(i)&&(i=i.toString()),!o)return void t(new E("authUrl response is missing a content-type header",40170,401),null);const s=o.indexOf("application/json")>-1,a=o.indexOf("text/plain")>-1||o.indexOf("application/jwt")>-1;if(s||a){if(s){if(i.length>De)return void t(new E("authUrl response exceeded max permitted length",40170,401),null);try{i=JSON.parse(i)}catch(l){return void t(new E("Unexpected error processing authURL response; err = "+l.message,40170,401),null)}}t(null,i,o)}else t(new E("authUrl responded with unacceptable content-type "+o+", should be either text/plain, application/jwt or application/json",40170,401),null)};if(S.logAction(this.logger,S.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+n.authUrl+"; Params: "+JSON.stringify(a)+"; method: "+(i?"POST":"GET")),i){const e=r||{};e["content-type"]="application/x-www-form-urlencoded";const t=$(a).slice(1);re(this.client.http.doUri(Ne.Post,n.authUrl,e,t,o),(e,t)=>l(e||t))}else re(this.client.http.doUri(Ne.Get,n.authUrl,r||{},null,a),(e,t)=>l(e||t))};else{if(!n.key){const e="Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)";throw S.logAction(this.logger,S.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),new E(e,40171,403)}S.logAction(this.logger,S.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),i=(e,t)=>{re(this.createTokenRequest(e,n),(e,n)=>t(e,null!=n?n:null))}}"capability"in r&&(r.capability=je(r.capability));const s=(e,t)=>{const r="/keys/"+e.keyName+"/requestToken",i=Me.defaultPostHeaders(this.client.options);n.requestHeaders&&R(i,n.requestHeaders),S.logAction(this.logger,S.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+r+"; Token params: "+JSON.stringify(e)),re(this.client.http.do(Ne.Post,function(e){return o.baseUri(e)+r},i,JSON.stringify(e),null),(e,n)=>e?t(e):t(n.error,n.body,n.unpacked))};return new Promise((e,t)=>{let o=!1,a=this.client.options.timeouts.realtimeRequestTimeout,l=setTimeout(()=>{o=!0;const e="Token request callback timed out after "+a/1e3+" seconds";S.logAction(this.logger,S.LOG_ERROR,"Auth.requestToken()",e),t(new E(e,40170,401))},a);i(r,(r,i,a)=>{if(o)return;if(clearTimeout(l),r)return S.logAction(this.logger,S.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+X(r)),void t(ze(r));if("string"===typeof i)return void(0===i.length?t(new E("Token string is empty",40170,401)):i.length>De?t(new E("Token string exceeded max permitted length (was "+i.length+" bytes)",40170,401)):"undefined"===i||"null"===i?t(new E("Token string was literal null/undefined",40170,401)):"{"!==i[0]||a&&a.indexOf("application/jwt")>-1?e({token:i}):t(new E("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401)));if("object"!==typeof i||null===i){const e="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof i;return S.logAction(this.logger,S.LOG_ERROR,"Auth.requestToken()",e),void t(new E(e,40170,401))}const c=JSON.stringify(i).length;if(c>De&&!n.suppressMaxLengthCheck)t(new E("Token request/details object exceeded max permitted stringified size (was "+c+" bytes)",40170,401));else if("issued"in i)e(i);else{if(!("keyName"in i)){const e="Expected token request callback to call back with a token string, token request object, or token details object";return S.logAction(this.logger,S.LOG_ERROR,"Auth.requestToken()",e),void t(new E(e,40170,401))}s(i,(n,r,i)=>{if(n)return S.logAction(this.logger,S.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+X(n)),void t(ze(n));i||(r=JSON.parse(r)),S.logAction(this.logger,S.LOG_MINOR,"Auth.getToken()","token received"),e(r)})}})})}async createTokenRequest(e,t){t=t||this.authOptions,e=e||A(this.tokenParams);const n=t.key;if(!n)throw new E("No key specified",40101,403);const r=n.split(":"),i=r[0],o=r[1];if(!o)throw new E("Invalid key specified",40101,403);if(""===e.clientId)throw new E("clientId can\u2019t be an empty string",40012,400);"capability"in e&&(e.capability=je(e.capability));const s=R({keyName:i},e),a=e.clientId||"",l=e.ttl||"",c=e.capability||"";s.timestamp||(s.timestamp=await this._getTimestamp(t&&t.queryTime));const u=s.nonce||(s.nonce=("000000"+Math.floor(1e16*Math.random())).slice(-16)),h=s.timestamp,d=s.keyName+"\n"+l+"\n"+c+"\n"+a+"\n"+h+"\n"+u+"\n";return s.mac=s.mac||((e,t)=>{const n=y.BufferUtils,r=n.utf8Encode(e),i=n.utf8Encode(t),o=n.hmacSha256(r,i);return n.base64Encode(o)})(d,o),S.logAction(this.logger,S.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),s}async getAuthParams(){if("basic"==this.method)return{key:this.key};{let e=await this._ensureValidAuthCredentials(!1);if(!e)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");return{access_token:e.token}}}async getAuthHeaders(){if("basic"==this.method)return{authorization:"Basic "+this.basicKey};{const e=await this._ensureValidAuthCredentials(!1);if(!e)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");return{authorization:"Bearer "+pe(e.token)}}}_saveBasicOptions(e){this.method="basic",this.key=e.key,this.basicKey=pe(e.key),this.authOptions=e||{},"clientId"in e&&this._userSetClientId(e.clientId)}_saveTokenOptions(e,t){this.method="token",e&&(this.tokenParams=e),t&&(t.token&&(t.tokenDetails="string"===typeof t.token?{token:t.token}:t.token),t.tokenDetails&&(this.tokenDetails=t.tokenDetails),"clientId"in t&&this._userSetClientId(t.clientId),this.authOptions=t)}async _ensureValidAuthCredentials(e){const t=this.tokenDetails;if(t){if(this._tokenClientIdMismatch(t.clientId))throw new E("Mismatch between clientId in token ("+t.clientId+") and current clientId ("+this.clientId+")",40102,403);if(!this.client.isTimeOffsetSet()||!t.expires||t.expires>=this.client.getTimestampUsingOffset())return S.logAction(this.logger,S.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+t.expires),t;S.logAction(this.logger,S.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}const n=(this.waitingForTokenRequest||(this.waitingForTokenRequest=Ie.create(this.logger))).createPromise();if(null!==this.currentTokenRequestId&&!e)return n;const r=this.currentTokenRequestId=Fe++;let i,o=null;try{i=await this.requestToken(this.tokenParams,this.authOptions)}catch(a){o=a}if(this.currentTokenRequestId>r)return S.logAction(this.logger,S.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one"),n;this.currentTokenRequestId=null;const s=this.waitingForTokenRequest;return this.waitingForTokenRequest=null,o?(null==s||s.rejectAll(o),n):(null==s||s.resolveAll(this.tokenDetails=i),n)}_userSetClientId(e){if("string"!==typeof e&&null!==e)throw new E("clientId must be either a string or null",40012,400);if("*"===e)throw new E('Can\u2019t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);{const t=this._uncheckedSetClientId(e);if(t)throw t}}_uncheckedSetClientId(e){if(this._tokenClientIdMismatch(e)){const t="Unexpected clientId mismatch: client has "+this.clientId+", requested "+e,n=new E(t,40102,401);return S.logAction(this.logger,S.LOG_ERROR,"Auth._uncheckedSetClientId()",t),n}return this.clientId=this.tokenParams.clientId=e,null}_tokenClientIdMismatch(e){return!(!this.clientId||"*"===this.clientId||!e||"*"===e||this.clientId===e)}static isTokenErr(e){return e.code&&e.code>=40140&&e.code<40150}revokeTokens(e,t){return this.client.rest.revokeTokens(e,t)}async _getTimestamp(e){return this.client.getTimestamp(e||!!this.authOptions.queryTime)}};function qe(e){const t=[];if(e)for(const n in e)t.push(n+"="+e[n]);return t.join("&")}function Ve(e,t){return e+(t?"?":"")+qe(t)}var We=class{constructor(e){this.client=e,this.platformHttp=new y.Http(e),this.checkConnectivity=this.platformHttp.checkConnectivity?()=>this.platformHttp.checkConnectivity():void 0}get logger(){var e,t;return null!=(t=null==(e=this.client)?void 0:e.logger)?t:S.defaultLogger}get supportsAuthHeaders(){return this.platformHttp.supportsAuthHeaders}get supportsLinkHeaders(){return this.platformHttp.supportsLinkHeaders}_getHosts(e){const t=e.connection,n=t&&t.connectionManager.host;return n?[n].concat(Me.getFallbackHosts(e.options)):Me.getHosts(e.options)}async do(e,t,n,r,i){try{const o=this.client;if(!o)return{error:new E("http.do called without client",5e4,500)};const s="function"===typeof t?t:function(e){return o.baseUri(e)+t},a=o._currentFallback;if(a){if(a.validUntil>Date.now()){const l=await this.doUri(e,s(a.host),n,r,i);return l.error&&this.platformHttp.shouldFallback(l.error)?(o._currentFallback=null,this.do(e,t,n,r,i)):l}o._currentFallback=null}const l=this._getHosts(o);if(1===l.length)return this.doUri(e,s(l[0]),n,r,i);let c=null;const u=async(t,a)=>{const l=t.shift();c=null!=c?c:new Date;const h=await this.doUri(e,s(l),n,r,i);return h.error&&this.platformHttp.shouldFallback(h.error)&&t.length?Date.now()-c.getTime()>o.options.timeouts.httpMaxRetryDuration?{error:new E("Timeout for trying fallback hosts retries. Total elapsed time exceeded the ".concat(o.options.timeouts.httpMaxRetryDuration,"ms limit"),50003,500)}:u(t,!0):(a&&(o._currentFallback={host:l,validUntil:Date.now()+o.options.timeouts.fallbackRetryTimeout}),h)};return u(l)}catch(o){return{error:new E("Unexpected error in Http.do: ".concat(X(o)),500,5e4)}}}async doUri(e,t,n,r,i){try{!function(e,t,n,r,i){i.shouldLog(S.LOG_MICRO)&&S.logActionNoStrip(i,S.LOG_MICRO,"Http."+e+"()","Sending; "+Ve(t,r)+"; Body"+(y.BufferUtils.isBuffer(n)?" (Base64): "+y.BufferUtils.base64Encode(n):": "+n))}(e,t,r,i,this.logger);const o=await this.platformHttp.doUri(e,t,n,r,i);return this.logger.shouldLog(S.LOG_MICRO)&&function(e,t,n,r,i){e.error?S.logActionNoStrip(i,S.LOG_MICRO,"Http."+t+"()","Received Error; "+Ve(n,r)+"; Error: "+X(e.error)):S.logActionNoStrip(i,S.LOG_MICRO,"Http."+t+"()","Received; "+Ve(n,r)+"; Headers: "+qe(e.headers)+"; StatusCode: "+e.statusCode+"; Body"+(y.BufferUtils.isBuffer(e.body)?" (Base64): "+y.BufferUtils.base64Encode(e.body):": "+e.body))}(o,e,t,i,this.logger),o}catch(o){return{error:new E("Unexpected error in Http.doUri: ".concat(X(o)),500,5e4)}}}};function Qe(e,t,n){let r,i,o;for(let s=0;s<e.length;s++)if(r=e[s],n&&(r=r[n]),Array.isArray(r)){for(;-1!==(i=r.indexOf(t));)r.splice(i,1);n&&0===r.length&&delete e[s][n]}else if(P(r))for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&Array.isArray(r[o])&&Qe([r],t,o)}var $e=class{constructor(e){this.logger=e,this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}on(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(1===t.length){const e=t[0];if("function"!==typeof e)throw new Error("EventListener.on(): Invalid arguments: "+y.Config.inspect(t));this.any.push(e)}if(2===t.length){const[e,n]=t;if("function"!==typeof n)throw new Error("EventListener.on(): Invalid arguments: "+y.Config.inspect(t));if(I(e))this.any.push(n);else if(Array.isArray(e))e.forEach(e=>{this.on(e,n)});else{if("string"!==typeof e)throw new Error("EventListener.on(): Invalid arguments: "+y.Config.inspect(t));(this.events[e]||(this.events[e]=[])).push(n)}}}off(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0==t.length||I(t[0])&&I(t[1]))return this.any=[],this.events=Object.create(null),this.anyOnce=[],void(this.eventsOnce=Object.create(null));const[r,i]=t;let o=null,s=null;if(1!==t.length&&i){if("function"!==typeof i)throw new Error("EventEmitter.off(): invalid arguments:"+y.Config.inspect(t));[s,o]=[r,i]}else"function"===typeof r?o=r:s=r;if(o&&I(s))Qe([this.any,this.events,this.anyOnce,this.eventsOnce],o);else if(Array.isArray(s))s.forEach(e=>{this.off(e,o)});else{if("string"!==typeof s)throw new Error("EventEmitter.off(): invalid arguments:"+y.Config.inspect(t));o?Qe([this.events,this.eventsOnce],o,s):(delete this.events[s],delete this.eventsOnce[s])}}listeners(e){if(e){const t=this.events[e]||[];return this.eventsOnce[e]&&Array.prototype.push.apply(t,this.eventsOnce[e]),t.length?t:null}return this.any.length?this.any:null}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i={event:e},o=[];this.anyOnce.length&&(Array.prototype.push.apply(o,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(o,this.any);const s=this.eventsOnce[e];s&&(Array.prototype.push.apply(o,s),delete this.eventsOnce[e]);const a=this.events[e];a&&Array.prototype.push.apply(o,a),o.forEach(e=>{!function(e,t,n,r){try{n.apply(t,r)}catch(i){S.logAction(e,S.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+i+"; stack = "+(i&&i.stack))}}(this.logger,i,e,n)})}once(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.length;if(0===r||1===r&&"function"!==typeof t[0]){const e=t[0];return new Promise(t=>{this.once(e,t)})}const[i,o]=t;if(1===t.length&&"function"===typeof i)this.anyOnce.push(i);else if(I(i)){if("function"!==typeof o)throw new Error("EventEmitter.once(): Invalid arguments:"+y.Config.inspect(t));this.anyOnce.push(o)}else if(Array.isArray(i)){const e=this,n=function(){const r=Array.prototype.slice.call(arguments);if(i.forEach(function(t){e.off(t,n)}),"function"!==typeof o)throw new Error("EventEmitter.once(): Invalid arguments:"+y.Config.inspect(t));o.apply(this,r)};i.forEach(function(t){e.on(t,n)})}else{if("string"!==typeof i)throw new Error("EventEmitter.once(): Invalid arguments:"+y.Config.inspect(t));const e=this.eventsOnce[i]||(this.eventsOnce[i]=[]);if(o){if("function"!==typeof o)throw new Error("EventEmitter.once(): Invalid arguments:"+y.Config.inspect(t));e.push(o)}}}async whenState(e,t){if("string"!==typeof e||"string"!==typeof t)throw new Error("whenState requires a valid state String argument");return e===t?null:this.once(e)}},Ke={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17,ACTIVATE:18,OBJECT:19,OBJECT_SYNC:20,ANNOTATION:21},Je=[];Object.keys(Ke).forEach(function(e){Je[Ke[e]]=e});var Xe={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,ATTACH_RESUME:32,HAS_OBJECTS:128,PRESENCE:65536,PUBLISH:1<<17,SUBSCRIBE:1<<18,PRESENCE_SUBSCRIBE:1<<19,ANNOTATION_PUBLISH:1<<21,ANNOTATION_SUBSCRIBE:1<<22,OBJECT_SUBSCRIBE:1<<24,OBJECT_PUBLISH:1<<25},Ye=Object.keys(Xe);Xe.MODE_ALL=Xe.PRESENCE|Xe.PUBLISH|Xe.SUBSCRIBE|Xe.PRESENCE_SUBSCRIBE|Xe.ANNOTATION_PUBLISH|Xe.ANNOTATION_SUBSCRIBE|Xe.OBJECT_SUBSCRIBE|Xe.OBJECT_PUBLISH;var Ze=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE","ANNOTATION_PUBLISH","ANNOTATION_SUBSCRIBE","OBJECT_SUBSCRIBE","OBJECT_PUBLISH"];function et(e,t,n){if(n&&n.cipher){e||ye("Crypto");const r=e.getCipher(n.cipher,t);return{cipher:r.cipherParams,channelCipher:r.cipher}}return null!=n?n:{}}async function tt(e,t,n){let r=n.channelCipher,i=e,o=t?t+"/":"";y.BufferUtils.isBuffer(i)||(i=y.BufferUtils.utf8Encode(String(i)),o+="utf-8/");const s=await r.encrypt(i);return o=o+"cipher+"+r.algorithm,{data:s,encoding:o}}async function nt(e,t){const{data:n,encoding:r}=rt(e.data,e.encoding);return e.data=n,e.encoding=r,null!=t&&t.cipher?async function(e,t){const{data:n,encoding:r}=await tt(e.data,e.encoding,t);return e.data=n,e.encoding=r,e}(e,t):e}function rt(e,t){if("string"==typeof e||y.BufferUtils.isBuffer(e)||null===e||void 0===e)return{data:e,encoding:t};if(P(e)||Array.isArray(e))return{data:JSON.stringify(e),encoding:t?t+"/json":"json"};throw new E("Data type is unsupported",40013,400)}async function it(e,t){const{data:n,encoding:r,error:i}=await ot(e.data,e.encoding,t);if(e.data=n,e.encoding=r,i)throw i}async function ot(e,t,n){const r=function(e){return e&&e.channelOptions?e:{channelOptions:e,plugins:{},baseEncodedPreviousPayload:void 0}}(n);let i,o=e,s=e,a=t;if(t){const e=t.split("/");let n,c=e.length,u="";try{for(;(n=c)>0;){const t=e[--c].match(/([-\w]+)(\+([\w-]+))?/);if(!t)break;switch(u=t[1],u){case"base64":s=y.BufferUtils.base64Decode(String(s)),n==e.length&&(o=s);continue;case"utf-8":s=y.BufferUtils.utf8Decode(s);continue;case"json":s=JSON.parse(s);continue;case"cipher":if(null!=r.channelOptions&&r.channelOptions.cipher&&r.channelOptions.channelCipher){const e=t[3],n=r.channelOptions.channelCipher;if(e!=n.algorithm)throw new Error("Unable to decrypt message with given cipher; incompatible cipher params");s=await n.decrypt(s);continue}throw new Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!r.plugins||!r.plugins.vcdiff)throw new E("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if("undefined"===typeof Uint8Array)throw new E("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{let e=r.baseEncodedPreviousPayload;"string"===typeof e&&(e=y.BufferUtils.utf8Encode(e));const t=y.BufferUtils.toBuffer(e);s=y.BufferUtils.toBuffer(s),s=y.BufferUtils.arrayBufferViewToBuffer(r.plugins.vcdiff.decode(s,t)),o=s}catch(l){throw new E("Vcdiff delta decode failed with "+l,40018,400)}continue;default:throw new Error("Unknown encoding")}}}catch(l){const e=l;i=new E("Error processing the ".concat(u," encoding, decoder returned \u2018").concat(e.message,"\u2019"),e.code||40013,400)}finally{a=n<=0?null:e.slice(0,n).join("/")}}return i?{error:i,data:s,encoding:a}:(r.baseEncodedPreviousPayload=o,{data:s,encoding:a})}function st(){const e=arguments.length>0?"json":"msgpack",{data:t,encoding:n}=at(this.data,this.encoding,e);return Object.assign({},this,{encoding:n,data:t})}function at(e,t,n){return e&&y.BufferUtils.isBuffer(e)?"msgpack"===n?{data:y.BufferUtils.toBuffer(e),encoding:t}:{data:y.BufferUtils.base64Encode(e),encoding:t?t+"/base64":"base64"}:{data:e,encoding:t}}var lt={encryptData:tt,encodeData:rt,encodeDataForWire:at,decodeData:ot};function ct(e){const{id:t,connectionId:n,timestamp:r}=e;let i;switch(e.action){case Ke.MESSAGE:i=e.messages;break;case Ke.PRESENCE:case Ke.SYNC:i=e.presence;break;case Ke.ANNOTATION:i=e.annotations;break;case Ke.OBJECT:case Ke.OBJECT_SYNC:i=e.state;break;default:throw new E("Unexpected action "+e.action,4e4,400)}for(let o=0;o<i.length;o++){const e=i[o];e.connectionId||(e.connectionId=n),e.timestamp||(e.timestamp=r),t&&!e.id&&(e.id=t+":"+o)}}function ut(e,t){let n="["+t;for(const r in e)"data"===r?"string"==typeof e.data?n+="; data="+e.data:y.BufferUtils.isBuffer(e.data)?n+="; data (buffer)="+y.BufferUtils.base64Encode(e.data):"undefined"!==typeof e.data&&(n+="; data (json)="+JSON.stringify(e.data)):!r||"extras"!==r&&"operation"!==r?"version"===r?n+="; version="+JSON.stringify(e[r]):"annotations"===r?n+="; annotations="+JSON.stringify(e[r]):void 0!==e[r]&&(n+="; "+r+"="+e[r]):n+="; "+r+"="+JSON.stringify(e[r]);return n+="]",n}var ht=class{},dt=class{constructor(e){var t,n,r,i,o,s,a,l,c,u;this.Platform=y,this.ErrorInfo=E,this.Logger=S,this.Defaults=Me,this.Utils=C,this.EventEmitter=$e,this.MessageEncoding=lt,this._additionalHTTPRequestImplementations=null!=(t=e.plugins)?t:null,this.logger=new S,this.logger.setLog(e.logLevel,e.logHandler),S.logAction(this.logger,S.LOG_MICRO,"BaseClient()","initialized with clientOptions "+y.Config.inspect(e)),this._MsgPack=null!=(r=null==(n=e.plugins)?void 0:n.MsgPack)?r:null;const h=this.options=Me.normaliseOptions(e,this._MsgPack,this.logger);if(h.key){const e=h.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!e){const e="invalid key parameter";throw S.logAction(this.logger,S.LOG_ERROR,"BaseClient()",e),new E(e,40400,404)}h.keyName=e[1],h.keySecret=e[2]}if("clientId"in h){if("string"!==typeof h.clientId&&null!==h.clientId)throw new E("clientId must be either a string or null",40012,400);if("*"===h.clientId)throw new E('Can\u2019t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}S.logAction(this.logger,S.LOG_MINOR,"BaseClient()","started; version = "+Me.version),this._currentFallback=null,this.serverTimeOffset=null,this.http=new We(this),this.auth=new He(this,h),this._rest=(null==(i=e.plugins)?void 0:i.Rest)?new e.plugins.Rest(this):null,this._Crypto=null!=(s=null==(o=e.plugins)?void 0:o.Crypto)?s:null,this.__FilteredSubscriptions=null!=(l=null==(a=e.plugins)?void 0:a.MessageInteractions)?l:null,this._Annotations=null!=(u=null==(c=e.plugins)?void 0:c.Annotations)?u:null}get rest(){return this._rest||ye("Rest"),this._rest}get _FilteredSubscriptions(){return this.__FilteredSubscriptions||ye("MessageInteractions"),this.__FilteredSubscriptions}get channels(){return this.rest.channels}get push(){return this.rest.push}device(){var e;return(null==(e=this.options.plugins)?void 0:e.Push)&&this.push.LocalDevice||ye("Push"),this._device||(this._device=this.push.LocalDevice.load(this)),this._device}baseUri(e){return Me.getHttpScheme(this.options)+e+":"+Me.getPort(this.options,!1)}async stats(e){return this.rest.stats(e)}async time(e){return this.rest.time(e)}async request(e,t,n,r,i,o){return this.rest.request(e,t,n,r,i,o)}batchPublish(e){return this.rest.batchPublish(e)}batchPresence(e){return this.rest.batchPresence(e)}setLog(e){this.logger.setLog(e.level,e.handler)}async getTimestamp(e){return!this.isTimeOffsetSet()&&e?this.time():this.getTimestampUsingOffset()}getTimestampUsingOffset(){return Date.now()+(this.serverTimeOffset||0)}isTimeOffsetSet(){return null!==this.serverTimeOffset}};dt.Platform=y;var ft=dt,pt=class e{toJSON(){var e,t,n;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:null==(e=this.push)?void 0:e.recipient,state:null==(t=this.push)?void 0:t.state,error:null==(n=this.push)?void 0:n.error}}}toString(){var e,t,n,r;let i="[DeviceDetails";return this.id&&(i+="; id="+this.id),this.platform&&(i+="; platform="+this.platform),this.formFactor&&(i+="; formFactor="+this.formFactor),this.clientId&&(i+="; clientId="+this.clientId),this.metadata&&(i+="; metadata="+this.metadata),this.deviceIdentityToken&&(i+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),(null==(e=this.push)?void 0:e.recipient)&&(i+="; push.recipient="+JSON.stringify(this.push.recipient)),(null==(t=this.push)?void 0:t.state)&&(i+="; push.state="+this.push.state),(null==(n=this.push)?void 0:n.error)&&(i+="; push.error="+JSON.stringify(this.push.error)),(null==(r=this.push)?void 0:r.metadata)&&(i+="; push.metadata="+this.push.metadata),i+="]",i}static toRequestBody(e,t,n){return oe(e,t,n)}static fromResponseBody(t,n,r){return r&&(t=ie(t,n,r)),Array.isArray(t)?e.fromValuesArray(t):e.fromValues(t)}static fromValues(t){return t.error=t.error&&E.fromValues(t.error),Object.assign(new e,t)}static fromLocalDevice(t){return Object.assign(new e,t)}static fromValuesArray(t){const n=t.length,r=new Array(n);for(let i=0;i<n;i++)r[i]=e.fromValues(t[i]);return r}};async function gt(e,t,n,r){return e.http.supportsAuthHeaders?r(R(await e.auth.getAuthHeaders(),t),n):r(t,R(await e.auth.getAuthParams(),n))}var mt=class e{static async get(t,n,r,i,o,s){return e.do(Ne.Get,t,n,null,r,i,o,null!=s&&s)}static async delete(t,n,r,i,o,s){return e.do(Ne.Delete,t,n,null,r,i,o,s)}static async post(t,n,r,i,o,s,a){return e.do(Ne.Post,t,n,r,i,o,s,a)}static async patch(t,n,r,i,o,s,a){return e.do(Ne.Patch,t,n,r,i,o,s,a)}static async put(t,n,r,i,o,s,a){return e.do(Ne.Put,t,n,r,i,o,s,a)}static async do(e,t,n,r,i,o,s,a){s&&((o=o||{}).envelope=s);const l=t.logger;let c=await gt(t,i,o,async function i(o,s){var a;if(l.shouldLog(S.LOG_MICRO)){let i=r;if((null==(a=o["content-type"])?void 0:a.indexOf("msgpack"))>0)try{t._MsgPack||ye("MsgPack"),i=t._MsgPack.decode(r)}catch(u){S.logAction(l,S.LOG_MICRO,"Resource."+e+"()","Sending MsgPack Decoding Error: "+X(u))}S.logAction(l,S.LOG_MICRO,"Resource."+e+"()","Sending; "+Ve(n,s)+"; Body: "+i)}const c=await t.http.do(e,n,o,r,s);return c.error&&He.isTokenErr(c.error)?(await t.auth.authorize(null,null),gt(t,o,s,i)):{err:c.error,body:c.body,headers:c.headers,unpacked:c.unpacked,statusCode:c.statusCode}});if(s&&(c=function(e,t,n){if(e.err&&!e.body)return{err:e.err};if(e.statusCode===Ue.NoContent)return p(f({},e),{body:[],unpacked:!0});let r=e.body;if(!e.unpacked)try{r=ie(r,t,n)}catch(a){return J(a)?{err:a}:{err:new T(X(a),null)}}if(!r)return{err:new T("unenvelope(): Response body is missing",null)};const{statusCode:i,response:o,headers:s}=r;if(void 0===i)return p(f({},e),{body:r,unpacked:!0});if(i<200||i>=300){let t=o&&o.error||e.err;return t||(t=new Error("Error in unenveloping "+r),t.statusCode=i),{err:t,body:o,headers:s,unpacked:!0,statusCode:i}}return{err:e.err,body:o,headers:s,unpacked:!0,statusCode:i}}(c,t._MsgPack,s)),l.shouldLog(S.LOG_MICRO)&&function(e,t,n,r,i){e.err?S.logAction(i,S.LOG_MICRO,"Resource."+t+"()","Received Error; "+Ve(n,r)+"; Error: "+X(e.err)):S.logAction(i,S.LOG_MICRO,"Resource."+t+"()","Received; "+Ve(n,r)+"; Headers: "+qe(e.headers)+"; StatusCode: "+e.statusCode+"; Body: "+(y.BufferUtils.isBuffer(e.body)?" (Base64): "+y.BufferUtils.base64Encode(e.body):": "+y.Config.inspect(e.body)))}(c,e,n,o,l),a){if(c.err)throw c.err;{const e=f({},c);return delete e.err,e}}return c}};function yt(e){const t=e.match(/^\.\/(\w+)\?(.*)$/);return t&&t[2]&&K(t[2])}var vt=class{constructor(e,t,n){this.resource=e,this.items=t,this._relParams=n}async first(){if(this.hasFirst())return this.get(this._relParams.first);throw new E("No link to the first page of results",40400,404)}async current(){if(this.hasCurrent())return this.get(this._relParams.current);throw new E("No link to the current page of results",40400,404)}async next(){return this.hasNext()?this.get(this._relParams.next):null}hasFirst(){return null!=this._relParams&&"first"in this._relParams}hasCurrent(){return null!=this._relParams&&"current"in this._relParams}hasNext(){return null!=this._relParams&&"next"in this._relParams}isLast(){return!this.hasNext()}async get(e){const t=this.resource,n=await mt.get(t.client,t.path,t.headers,e,t.envelope,!1);return t.handlePage(n)}},bt=class extends vt{constructor(e,t,n,r,i,o){super(e,t,i),this.statusCode=r,this.success=r<300&&r>=200,this.headers=n,this.errorCode=o&&o.code,this.errorMessage=o&&o.message}toJSON(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}}},wt=class{constructor(e,t,n,r,i,o){this.client=e,this.path=t,this.headers=n,this.envelope=null!=r?r:null,this.bodyHandler=i,this.useHttpPaginatedResponse=o||!1}get logger(){return this.client.logger}async get(e){const t=await mt.get(this.client,this.path,this.headers,e,this.envelope,!1);return this.handlePage(t)}async delete(e){const t=await mt.delete(this.client,this.path,this.headers,e,this.envelope,!1);return this.handlePage(t)}async post(e,t){const n=await mt.post(this.client,this.path,t,this.headers,e,this.envelope,!1);return this.handlePage(n)}async put(e,t){const n=await mt.put(this.client,this.path,t,this.headers,e,this.envelope,!1);return this.handlePage(n)}async patch(e,t){const n=await mt.patch(this.client,this.path,t,this.headers,e,this.envelope,!1);return this.handlePage(n)}async handlePage(e){if(e.err&&(t=e.err,n=e.body,!this.useHttpPaginatedResponse||!n&&"number"!==typeof t.code))throw S.logAction(this.logger,S.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+X(e.err)),e.err;var t,n;let r,i,o;try{r=e.statusCode==Ue.NoContent?[]:await this.bodyHandler(e.body,e.headers||{},e.unpacked)}catch(s){throw e.err||s}return e.headers&&(i=e.headers.Link||e.headers.link)&&(o=function(e){"string"==typeof e&&(e=e.split(","));const t={};for(let n=0;n<e.length;n++){const r=e[n].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(r){const e=yt(r[1]);e&&(t[r[2]]=e)}}return t}(i)),this.useHttpPaginatedResponse?new bt(this,r,e.headers||{},e.statusCode,o,e.err):new vt(this,r,o)}},kt=class e{toJSON(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}}toString(){let e="[PushChannelSubscription";return this.channel&&(e+="; channel="+this.channel),this.deviceId&&(e+="; deviceId="+this.deviceId),this.clientId&&(e+="; clientId="+this.clientId),e+="]",e}static fromResponseBody(t,n,r){return r&&(t=ie(t,n,r)),Array.isArray(t)?e.fromValuesArray(t):e.fromValues(t)}static fromValues(t){return Object.assign(new e,t)}static fromValuesArray(t){const n=t.length,r=new Array(n);for(let i=0;i<n;i++)r[i]=e.fromValues(t[i]);return r}};kt.toRequestBody=oe;var St=kt,Ct=class{constructor(e){this.client=e,this.deviceRegistrations=new Ot(e),this.channelSubscriptions=new Et(e)}async publish(e,t){const n=this.client,r=n.options.useBinaryProtocol?"msgpack":"json",i=Me.defaultPostHeaders(n.options,{format:r}),o={},s=R({recipient:e},t);R(i,n.options.headers),n.options.pushFullWait&&R(o,{fullWait:"true"});const a=oe(s,n._MsgPack,r);await mt.post(n,"/push/publish",a,i,o,null,!0)}},Ot=class{constructor(e){this.client=e}async save(e){const t=this.client,n=pt.fromValues(e),r=t.options.useBinaryProtocol?"msgpack":"json",i=Me.defaultPostHeaders(t.options,{format:r}),o={};R(i,t.options.headers),t.options.pushFullWait&&R(o,{fullWait:"true"});const s=oe(n,t._MsgPack,r),a=await mt.put(t,"/push/deviceRegistrations/"+encodeURIComponent(e.id),s,i,o,null,!0);return pt.fromResponseBody(a.body,t._MsgPack,a.unpacked?void 0:r)}async get(e){const t=this.client,n=t.options.useBinaryProtocol?"msgpack":"json",r=Me.defaultGetHeaders(t.options,{format:n}),i=e.id||e;if("string"!==typeof i||!i.length)throw new E("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400);R(r,t.options.headers);const o=await mt.get(t,"/push/deviceRegistrations/"+encodeURIComponent(i),r,{},null,!0);return pt.fromResponseBody(o.body,t._MsgPack,o.unpacked?void 0:n)}async list(e){const t=this.client,n=t.options.useBinaryProtocol?"msgpack":"json",r=this.client.http.supportsLinkHeaders?void 0:n,i=Me.defaultGetHeaders(t.options,{format:n});return R(i,t.options.headers),new wt(t,"/push/deviceRegistrations",i,r,async function(e,r,i){return pt.fromResponseBody(e,t._MsgPack,i?void 0:n)}).get(e)}async remove(e){const t=this.client,n=t.options.useBinaryProtocol?"msgpack":"json",r=Me.defaultGetHeaders(t.options,{format:n}),i={},o=e.id||e;if("string"!==typeof o||!o.length)throw new E("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400);R(r,t.options.headers),t.options.pushFullWait&&R(i,{fullWait:"true"}),await mt.delete(t,"/push/deviceRegistrations/"+encodeURIComponent(o),r,i,null,!0)}async removeWhere(e){const t=this.client,n=t.options.useBinaryProtocol?"msgpack":"json",r=Me.defaultGetHeaders(t.options,{format:n});R(r,t.options.headers),t.options.pushFullWait&&R(e,{fullWait:"true"}),await mt.delete(t,"/push/deviceRegistrations",r,e,null,!0)}},Et=class e{constructor(t){this.remove=e.prototype.removeWhere,this.client=t}async save(e){const t=this.client,n=St.fromValues(e),r=t.options.useBinaryProtocol?"msgpack":"json",i=Me.defaultPostHeaders(t.options,{format:r}),o={};R(i,t.options.headers),t.options.pushFullWait&&R(o,{fullWait:"true"});const s=oe(n,t._MsgPack,r),a=await mt.post(t,"/push/channelSubscriptions",s,i,o,null,!0);return St.fromResponseBody(a.body,t._MsgPack,a.unpacked?void 0:r)}async list(e){const t=this.client,n=t.options.useBinaryProtocol?"msgpack":"json",r=this.client.http.supportsLinkHeaders?void 0:n,i=Me.defaultGetHeaders(t.options,{format:n});return R(i,t.options.headers),new wt(t,"/push/channelSubscriptions",i,r,async function(e,r,i){return St.fromResponseBody(e,t._MsgPack,i?void 0:n)}).get(e)}async removeWhere(e){const t=this.client,n=t.options.useBinaryProtocol?"msgpack":"json",r=Me.defaultGetHeaders(t.options,{format:n});R(r,t.options.headers),t.options.pushFullWait&&R(e,{fullWait:"true"}),await mt.delete(t,"/push/channelSubscriptions",r,e,null,!0)}async listChannels(e){const t=this.client,n=t.options.useBinaryProtocol?"msgpack":"json",r=this.client.http.supportsLinkHeaders?void 0:n,i=Me.defaultGetHeaders(t.options,{format:n});return R(i,t.options.headers),t.options.pushFullWait&&R(e,{fullWait:"true"}),new wt(t,"/push/channels",i,r,async function(e,r,i){const o=!i&&n?ie(e,t._MsgPack,n):e;for(let t=0;t<o.length;t++)o[t]=String(o[t]);return o}).get(e)}},Tt=class{constructor(e){var t;this.client=e,this.admin=new Ct(e),y.Config.push&&(null==(t=e.options.plugins)?void 0:t.Push)&&(this.stateMachine=new e.options.plugins.Push.ActivationStateMachine(e),this.LocalDevice=e.options.plugins.Push.localDeviceFactory(pt))}async activate(e,t){await new Promise((n,r)=>{var i;(null==(i=this.client.options.plugins)?void 0:i.Push)?this.stateMachine?this.stateMachine.activatedCallback?r(new E("Activation already in progress",4e4,400)):(this.stateMachine.activatedCallback=e=>{e?r(e):n()},this.stateMachine.updateFailedCallback=t,this.stateMachine.handleEvent(new this.client.options.plugins.Push.CalledActivate(this.stateMachine,e))):r(new E("This platform is not supported as a target of push notifications",4e4,400)):r(me("Push"))})}async deactivate(e){await new Promise((t,n)=>{var r;(null==(r=this.client.options.plugins)?void 0:r.Push)?this.stateMachine?this.stateMachine.deactivatedCallback?n(new E("Deactivation already in progress",4e4,400)):(this.stateMachine.deactivatedCallback=e=>{e?n(e):t()},this.stateMachine.handleEvent(new this.client.options.plugins.Push.CalledDeactivate(this.stateMachine,e))):n(new E("This platform is not supported as a target of push notifications",4e4,400)):n(me("Push"))})}},Rt=["absent","present","enter","leave","update"];async function At(e,t,n,r){const i=et(t,e,null!=r?r:null);return Mt.fromValues(n).decode(i,e)}async function _t(e,t){return Promise.all(e.map(function(e){return async function(e,t){return Mt.fromValues(e).decode(t.channelOptions,t.logger)}(e,t)}))}var Pt=class e extends ht{isSynthesized(){return!this.id||!this.connectionId||this.id.substring(this.connectionId.length,0)!==this.connectionId}parseId(){if(!this.id)throw new Error("parseId(): Presence message does not contain an id");const e=this.id.split(":");return{connectionId:e[0],msgSerial:parseInt(e[1],10),index:parseInt(e[2],10)}}async encode(e){return nt(Object.assign(new Mt,this,{action:Rt.indexOf(this.action||"present")}),e)}static fromValues(t){return Object.assign(new e,t)}static fromValuesArray(t){return t.map(t=>e.fromValues(t))}static fromData(t){return t instanceof e?t:e.fromValues({data:t})}toString(){return ut(this,"PresenceMessage")}},Mt=class e extends ht{toJSON(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return st.call(this,...t)}static fromValues(t){return Object.assign(new e,t)}static fromValuesArray(t){return t.map(t=>e.fromValues(t))}async decode(e,t){const n=Object.assign(new Pt,p(f({},this),{action:Rt[this.action]}));try{await it(n,e)}catch(r){S.logAction(t,S.LOG_ERROR,"WirePresenceMessage.decode()",X(r))}return n}toString(){return ut(this,"WirePresenceMessage")}},It=Pt,xt=class{constructor(e){this.channel=e}get logger(){return this.channel.logger}async get(e){S.logAction(this.logger,S.LOG_MICRO,"RestPresence.get()","channel = "+this.channel.name);const t=this.channel.client,n=t.options.useBinaryProtocol?"msgpack":"json",r=this.channel.client.http.supportsLinkHeaders?void 0:n,i=Me.defaultGetHeaders(t.options,{format:n});return R(i,t.options.headers),new wt(t,this.channel.client.rest.presenceMixin.basePath(this),i,r,async(e,r,i)=>_t(i?e:ie(e,t._MsgPack,n),this.channel)).get(e)}async history(e){return S.logAction(this.logger,S.LOG_MICRO,"RestPresence.history()","channel = "+this.channel.name),this.channel.client.rest.presenceMixin.history(this,e)}},Nt=["message.create","message.update","message.delete","meta","message.summary"];function Lt(e){let t=0;return e.name&&(t+=e.name.length),e.clientId&&(t+=e.clientId.length),e.extras&&(t+=JSON.stringify(e.extras).length),e.data&&(t+=Z(e.data)),t}async function Ut(e,t,n,r){const i=et(t,e,null!=r?r:null);return Ft.fromValues(n).decode(i,e)}async function Dt(e,t){return Promise.all(e.map(function(e){return async function(e,t){return Ft.fromValues(e).decode(t.channelOptions,t.logger)}(e,t)}))}async function zt(e,t){return Promise.all(e.map(e=>e.encode(t)))}var jt=oe;function Bt(e){let t,n=0;for(let r=0;r<e.length;r++)t=e[r],n+=t.size||(t.size=Lt(t));return n}var Gt=class e extends ht{expandFields(){this.version||(this.version={}),!this.version.serial&&this.serial&&(this.version.serial=this.serial),!this.version.timestamp&&this.timestamp&&(this.version.timestamp=this.timestamp),this.annotations?this.annotations.summary||(this.annotations.summary={}):this.annotations={summary:{}}}async encode(e){return nt(Object.assign(new Ft,this,{action:Nt.indexOf(this.action||"message.create")}),e)}static fromValues(t){return Object.assign(new e,t)}static fromValuesArray(t){return t.map(t=>e.fromValues(t))}toString(){return ut(this,"Message")}},Ft=class e extends ht{toJSON(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return st.call(this,...t)}static fromValues(t){return Object.assign(new e,t)}static fromValuesArray(t){return t.map(t=>e.fromValues(t))}async decodeWithErr(e,t){const n=Object.assign(new Gt,p(f({},this),{action:(r=this.action,Nt[r||0]||"unknown")}));var r;let i;try{await it(n,e)}catch(o){S.logAction(t,S.LOG_ERROR,"WireMessage.decode()",X(o)),i=o}return n.expandFields(),{decoded:n,err:i}}async decode(e,t){const{decoded:n}=await this.decodeWithErr(e,t);return n}toString(){return ut(this,"WireMessage")}},Ht=Gt,qt=class{constructor(e,t,n){var r,i;this._annotations=null,S.logAction(e.logger,S.LOG_MINOR,"RestChannel()","started; name = "+t),this.name=t,this.client=e,this.presence=new xt(this),this.channelOptions=Ae(null!=(r=e._Crypto)?r:null,this.logger,n),(null==(i=e.options.plugins)?void 0:i.Push)&&(this._push=new e.options.plugins.Push.PushChannel(this)),e._Annotations&&(this._annotations=new e._Annotations.RestAnnotations(this))}get annotations(){return this._annotations||ye("Annotations"),this._annotations}get push(){return this._push||ye("Push"),this._push}get logger(){return this.client.logger}setOptions(e){var t;this.channelOptions=Ae(null!=(t=this.client._Crypto)?t:null,this.logger,e)}async history(e){return S.logAction(this.logger,S.LOG_MICRO,"RestChannel.history()","channel = "+this.name),this.client.rest.channelMixin.history(this,e)}async publish(){const e=arguments.length<=0?void 0:arguments[0],t=arguments.length<=1?void 0:arguments[1];let n,r;if("string"===typeof e||null===e)n=[Ht.fromValues({name:e,data:t})],r=arguments.length<=2?void 0:arguments[2];else if(P(e))n=[Ht.fromValues(e)],r=arguments.length<=1?void 0:arguments[1];else{if(!Array.isArray(e))throw new E("The single-argument form of publish() expects a message object or an array of message objects",40013,400);n=Ht.fromValuesArray(e),r=arguments.length<=1?void 0:arguments[1]}r||(r={});const i=this.client,o=i.options,s=o.useBinaryProtocol?"msgpack":"json",a=i.options.idempotentRestPublishing,l=Me.defaultPostHeaders(i.options,{format:s});if(R(l,o.headers),a&&function(e){return e.every(function(e){return!e.id})}(n)){const e=await te(9);n.forEach(function(t,n){t.id=e+":"+n.toString()})}const c=await zt(n,this.channelOptions),u=Bt(c),h=o.maxMessageSize;if(u>h)throw new E("Maximum size of messages that can be published at once exceeded (was ".concat(u," bytes; limit is ").concat(h," bytes)"),40009,400);await this._publish(jt(c,i._MsgPack,s),l,r)}async _publish(e,t,n){await mt.post(this.client,this.client.rest.channelMixin.basePath(this)+"/messages",e,t,n,null,!0)}async status(){return this.client.rest.channelMixin.status(this)}},Vt=class e{constructor(e){this.entries=e&&e.entries||void 0,this.schema=e&&e.schema||void 0,this.appId=e&&e.appId||void 0,this.inProgress=e&&e.inProgress||void 0,this.unit=e&&e.unit||void 0,this.intervalId=e&&e.intervalId||void 0}static fromValues(t){return new e(t)}},Wt=class{static basePath(e){return"/channels/"+encodeURIComponent(e.name)}static history(e,t){const n=e.client,r=n.options.useBinaryProtocol?"msgpack":"json",i=e.client.http.supportsLinkHeaders?void 0:r,o=Me.defaultGetHeaders(n.options,{format:r});return R(o,n.options.headers),new wt(n,this.basePath(e)+"/messages",o,i,async function(t,i,o){return Dt(o?t:ie(t,n._MsgPack,r),e)}).get(t)}static async status(e){const t=e.client.options.useBinaryProtocol?"msgpack":"json",n=Me.defaultPostHeaders(e.client.options,{format:t});return(await mt.get(e.client,this.basePath(e),n,{},t,!0)).body}},Qt=class{static basePath(e){return Wt.basePath(e.channel)+"/presence"}static async history(e,t){const n=e.channel.client,r=n.options.useBinaryProtocol?"msgpack":"json",i=e.channel.client.http.supportsLinkHeaders?void 0:r,o=Me.defaultGetHeaders(n.options,{format:r});return R(o,n.options.headers),new wt(n,this.basePath(e)+"/history",o,i,async(t,i,o)=>_t(o?t:ie(t,n._MsgPack,r),e.channel)).get(t)}},$t=class{constructor(e){this.channelMixin=Wt,this.presenceMixin=Qt,this.Resource=mt,this.PaginatedResource=wt,this.DeviceDetails=pt,this.PushChannelSubscription=St,this.client=e,this.channels=new Kt(this.client),this.push=new Tt(this.client)}async stats(e){const t=Me.defaultGetHeaders(this.client.options),n=this.client.options.useBinaryProtocol?"msgpack":"json",r=this.client.http.supportsLinkHeaders?void 0:n;return R(t,this.client.options.headers),new wt(this.client,"/stats",t,r,function(e,t,n){const r=n?e:JSON.parse(e);for(let i=0;i<r.length;i++)r[i]=Vt.fromValues(r[i]);return r}).get(e)}async time(e){const t=Me.defaultGetHeaders(this.client.options);this.client.options.headers&&R(t,this.client.options.headers);let{error:n,body:r,unpacked:i}=await this.client.http.do(Ne.Get,e=>this.client.baseUri(e)+"/time",t,null,e);if(n)throw n;i||(r=JSON.parse(r));const o=r[0];if(!o)throw new E("Internal error (unexpected result type from GET /time)",5e4,500);return this.client.serverTimeOffset=o-Date.now(),o}async request(e,t,n,r,i,o){var s;const[a,l,c]=(()=>this.client.options.useBinaryProtocol?(this.client._MsgPack||ye("MsgPack"),[this.client._MsgPack.encode,this.client._MsgPack.decode,"msgpack"]):[JSON.stringify,JSON.parse,"json"])(),u=this.client.http.supportsLinkHeaders?void 0:c;r=r||{};const h=e.toLowerCase(),d="get"==h?Me.defaultGetHeaders(this.client.options,{format:c,protocolVersion:n}):Me.defaultPostHeaders(this.client.options,{format:c,protocolVersion:n});"string"!==typeof i&&(i=null!=(s=a(i))?s:null),R(d,this.client.options.headers),o&&R(d,o);const f=new wt(this.client,t,d,u,async function(e,t,n){return _(n?e:l(e))},!0);if(!y.Http.methods.includes(h))throw new E("Unsupported method "+h,40500,405);return y.Http.methodsWithBody.includes(h)?f[h](r,i):f[h](r)}async batchPublish(e){let t,n;Array.isArray(e)?(t=e,n=!1):(t=[e],n=!0);const r=this.client.options.useBinaryProtocol?"msgpack":"json",i=Me.defaultPostHeaders(this.client.options,{format:r});this.client.options.headers&&R(i,this.client.options.headers);const o=oe(t,this.client._MsgPack,r),s=await mt.post(this.client,"/messages",o,i,{},null,!0),a=s.unpacked?s.body:ie(s.body,this.client._MsgPack,r);return n?a[0]:a}async batchPresence(e){const t=this.client.options.useBinaryProtocol?"msgpack":"json",n=Me.defaultPostHeaders(this.client.options,{format:t});this.client.options.headers&&R(n,this.client.options.headers);const r=e.join(","),i=await mt.get(this.client,"/presence",n,{channels:r},null,!0);return i.unpacked?i.body:ie(i.body,this.client._MsgPack,t)}async revokeTokens(e,t){if(Ge(this.client.options))throw new E("Cannot revoke tokens when using token auth",40162,401);const n=this.client.options.keyName;let r=null!=t?t:{};const i=f({targets:e.map(e=>"".concat(e.type,":").concat(e.value))},r),o=this.client.options.useBinaryProtocol?"msgpack":"json",s=Me.defaultPostHeaders(this.client.options,{format:o});this.client.options.headers&&R(s,this.client.options.headers);const a=oe(i,this.client._MsgPack,o),l=await mt.post(this.client,"/keys/".concat(n,"/revokeTokens"),a,s,{},null,!0);return l.unpacked?l.body:ie(l.body,this.client._MsgPack,o)}},Kt=class{constructor(e){this.client=e,this.all=Object.create(null)}get(e,t){e=String(e);let n=this.all[e];return n?t&&n.setOptions(t):this.all[e]=n=new qt(this.client,e,t),n}release(e){delete this.all[String(e)]}},Jt=class extends ft{constructor(e){super(Me.objectifyOptions(e,!1,"BaseRest",S.defaultLogger,{Rest:$t}))}},Xt={Rest:$t},Yt=class extends Ht{static async fromEncoded(e,t){return Ut(S.defaultLogger,y.Crypto,e,t)}static async fromEncodedArray(e,t){return async function(e,t,n,r){return Promise.all(n.map(function(n){return Ut(e,t,n,r)}))}(S.defaultLogger,y.Crypto,e,t)}static fromValues(e){return Ht.fromValues(e)}},Zt=class extends It{static async fromEncoded(e,t){return At(S.defaultLogger,y.Crypto,e,t)}static async fromEncodedArray(e,t){return async function(e,t,n,r){return Promise.all(n.map(function(n){return At(e,t,n,r)}))}(S.defaultLogger,y.Crypto,e,t)}static fromValues(e){return It.fromValues(e)}},en=["annotation.create","annotation.delete"];async function tn(e,t,n){return on.fromValues(t).decode(n||{},e)}async function nn(e,t){return Promise.all(e.map(function(e){return async function(e,t){return on.fromValues(e).decode(t.channelOptions,t.logger)}(e,t)}))}var rn=class e extends ht{async encode(){return nt(Object.assign(new on,this,{action:en.indexOf(this.action||"annotation.create")}),{})}static fromValues(t){return Object.assign(new e,t)}static fromValuesArray(t){return t.map(t=>e.fromValues(t))}toString(){return ut(this,"Annotation")}},on=class e extends ht{toJSON(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return st.call(this,...t)}static fromValues(t){return Object.assign(new e,t)}static fromValuesArray(t){return t.map(t=>e.fromValues(t))}async decode(e,t){const n=Object.assign(new rn,p(f({},this),{action:en[this.action]}));try{await it(n,e)}catch(r){S.logAction(t,S.LOG_ERROR,"WireAnnotation.decode()",X(r))}return n}toString(){return ut(this,"WireAnnotation")}},sn=rn,an=class extends sn{static async fromEncoded(e,t){return tn(S.defaultLogger,e,t)}static async fromEncodedArray(e,t){return async function(e,t,n){return Promise.all(t.map(function(t){return tn(e,t,n)}))}(S.defaultLogger,e,t)}static fromValues(e){return sn.fromValues(e)}};function ln(e){let t;switch(typeof e){case"string":t=e;break;case"object":t=e.serial}if(!t||"string"!==typeof t)throw new E("First argument of annotations.publish() must be either a Message (or at least an object with a string `serial` property) or a message serial (string)",40003,400);return t}function cn(e,t){const n=ln(e);if(!t||"object"!==typeof t)throw new E("Second argument of annotations.publish() must be an object (the intended annotation to publish)",40003,400);const r=sn.fromValues(t);return r.messageSerial=n,r.action||(r.action="annotation.create"),r}function un(e,t){return e.client.rest.channelMixin.basePath(e)+"/messages/"+encodeURIComponent(t)+"/annotations"}var hn=class{constructor(e){this.channel=e}async publish(e,t){const n=cn(e,t),r=await n.encode(),i=this.channel.client,o=i.options.useBinaryProtocol?"msgpack":"json",s=Me.defaultPostHeaders(i.options,{format:o});R(s,i.options.headers);const a=oe([r],i._MsgPack,o);await mt.post(i,un(this.channel,n.messageSerial),a,s,{},null,!0)}async delete(e,t){return t.action="annotation.delete",this.publish(e,t)}async get(e,t){const n=this.channel.client,r=ln(e),i=n.options.useBinaryProtocol?"msgpack":"json",o=n.http.supportsLinkHeaders?void 0:i,s=Me.defaultGetHeaders(n.options,{format:i});return R(s,n.options.headers),new wt(n,un(this.channel,r),s,o,async(e,t,r)=>nn(r?e:ie(e,n._MsgPack,i),this.channel)).get(t)}},dn=oe;function fn(e){const t=[];if(e)for(let n=0;n<e.length;n++)t.push(e[n].toString());return"[ "+t.join(", ")+" ]"}function pn(e,t,n,r){let i,o,s,a,l;return e.error&&(i=E.fromValues(e.error)),e.messages&&(o=Ft.fromValuesArray(e.messages)),t&&e.presence&&(s=t.WirePresenceMessage.fromValuesArray(e.presence)),n&&e.annotations&&(a=n.WireAnnotation.fromValuesArray(e.annotations)),r&&e.state&&(l=r.WireObjectMessage.fromValuesArray(e.state,C,lt)),Object.assign(new vn,p(f({},e),{presence:s,messages:o,annotations:a,state:l,error:i}))}function gn(e){return t=>{var n;return pn(t,{PresenceMessage:It,WirePresenceMessage:Mt},{Annotation:sn,WireAnnotation:on,RealtimeAnnotations:On,RestAnnotations:hn},null!=(n=null==e?void 0:e.ObjectsPlugin)?n:null)}}function mn(e){return Object.assign(new vn,e)}function yn(e,t,n,r){let i="[ProtocolMessage";void 0!==e.action&&(i+="; action="+Je[e.action]||0);const o=["id","channel","channelSerial","connectionId","count","msgSerial","timestamp"];let s;for(let a=0;a<o.length;a++)s=o[a],void 0!==e[s]&&(i+="; "+s+"="+e[s]);if(e.messages&&(i+="; messages="+fn(Ft.fromValuesArray(e.messages))),e.presence&&t&&(i+="; presence="+fn(t.WirePresenceMessage.fromValuesArray(e.presence))),e.annotations&&n&&(i+="; annotations="+fn(n.WireAnnotation.fromValuesArray(e.annotations))),e.state&&r&&(i+="; state="+fn(r.WireObjectMessage.fromValuesArray(e.state,C,lt))),e.error&&(i+="; error="+E.fromValues(e.error).toString()),e.auth&&e.auth.accessToken&&(i+="; token="+e.auth.accessToken),e.flags&&(i+="; flags="+Ye.filter(e.hasFlag).join(",")),e.params){let t="";q(e.params,function(n){t.length>0&&(t+="; "),t+=n+"="+e.params[n]}),t.length>0&&(i+="; params=["+t+"]")}return i+="]",i}var vn=class{constructor(){this.hasFlag=e=>(this.flags&Xe[e])>0}setFlag(e){return this.flags=this.flags|Xe[e]}getMode(){return(this.flags||0)&Xe.MODE_ALL}encodeModesToFlags(e){e.forEach(e=>this.setFlag(e))}decodeModesFromFlags(){const e=[];return Ze.forEach(t=>{this.hasFlag(t)&&e.push(t)}),e.length>0?e:void 0}},bn=vn,wn=class{constructor(e,t,n,r,i){this.previous=e,this.current=t,"attached"===t&&(this.resumed=n,this.hasBacklog=r),i&&(this.reason=i)}},kn=function(){};function Sn(e){const t=e||{},{agent:n}=t;return((e,t)=>{var n={};for(var r in e)u.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&c)for(var r of c(e))t.indexOf(r)<0&&h.call(e,r)&&(n[r]=e[r]);return n})(t,["agent"])}var Cn=class e extends $e{constructor(e,t,n){var r,i,o;super(e.logger),this._annotations=null,this._mode=0,this.retryCount=0,this.history=async function(e){S.logAction(this.logger,S.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name);const t=this.client.rest.channelMixin;if(e&&e.untilAttach){if("attached"!==this.state)throw new E("option untilAttach requires the channel to be attached",4e4,400);if(!this.properties.attachSerial)throw new E("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400);delete e.untilAttach,e.from_serial=this.properties.attachSerial}return t.history(this,e)},this.whenState=e=>$e.prototype.whenState.call(this,e,this.state),S.logAction(this.logger,S.LOG_MINOR,"RealtimeChannel()","started; name = "+t),this.name=t,this.channelOptions=Ae(null!=(r=e._Crypto)?r:null,this.logger,n),this.client=e,this._presence=e._RealtimePresence?new e._RealtimePresence.RealtimePresence(this):null,e._Annotations&&(this._annotations=new e._Annotations.RealtimeAnnotations(this)),this.connectionManager=e.connection.connectionManager,this.state="initialized",this.subscriptions=new $e(this.logger),this.syncChannelSerial=void 0,this.properties={attachSerial:void 0,channelSerial:void 0},this.setOptions(n),this.errorReason=null,this._attachResume=!1,this._decodingContext={channelOptions:this.channelOptions,plugins:e.options.plugins||{},baseEncodedPreviousPayload:void 0},this._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},this._allChannelChanges=new $e(this.logger),(null==(i=e.options.plugins)?void 0:i.Push)&&(this._push=new e.options.plugins.Push.PushChannel(this)),(null==(o=e.options.plugins)?void 0:o.Objects)&&(this._objects=new e.options.plugins.Objects.Objects(this))}get presence(){return this._presence||ye("RealtimePresence"),this._presence}get annotations(){return this._annotations||ye("Annotations"),this._annotations}get push(){return this._push||ye("Push"),this._push}get objects(){return this._objects||ye("Objects"),this._objects}invalidStateError(){return new E("Channel operation failed as channel state is "+this.state,90001,400,this.errorReason||void 0)}static processListenerArgs(e){return"function"===typeof(e=Array.prototype.slice.call(e))[0]&&e.unshift(null),e}async setOptions(e){var t;const n=this.channelOptions,r=function(e){if(e&&"params"in e&&!P(e.params))return new E("options.params must be an object",4e4,400);if(e&&"modes"in e){if(!Array.isArray(e.modes))return new E("options.modes must be an array",4e4,400);for(let t=0;t<e.modes.length;t++){const n=e.modes[t];if(!n||"string"!==typeof n||!Ze.includes(String.prototype.toUpperCase.call(n)))return new E("Invalid channel mode: "+n,4e4,400)}}}(e);if(r)throw r;if(this.channelOptions=Ae(null!=(t=this.client._Crypto)?t:null,this.logger,e),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(e,n))return this.attachImpl(),new Promise((e,t)=>{this._allChannelChanges.once(["attached","update","detached","failed"],function(n){switch(this.event){case"update":case"attached":e();break;default:t(n.reason)}})})}_shouldReattachToSetOptions(e,t){if("attached"!==this.state&&"attaching"!==this.state)return!1;if(null==e?void 0:e.params){const n=Sn(e.params),r=Sn(t.params);if(Object.keys(n).length!==Object.keys(r).length)return!0;if(!de(r,n))return!0}return!(!(null==e?void 0:e.modes)||t.modes&&ge(e.modes,t.modes))}async publish(){let e;if(1==arguments.length)if(P(arguments.length<=0?void 0:arguments[0]))e=[Ht.fromValues(arguments.length<=0?void 0:arguments[0])];else{if(!Array.isArray(arguments.length<=0?void 0:arguments[0]))throw new E("The single-argument form of publish() expects a message object or an array of message objects",40013,400);e=Ht.fromValuesArray(arguments.length<=0?void 0:arguments[0])}else e=[Ht.fromValues({name:arguments.length<=0?void 0:arguments[0],data:arguments.length<=1?void 0:arguments[1]})];const t=this.client.options.maxMessageSize,n=await zt(e,this.channelOptions),r=Bt(n);if(r>t)throw new E("Maximum size of messages that can be published at once exceeded (was ".concat(r," bytes; limit is ").concat(t," bytes)"),40009,400);this.throwIfUnpublishableState(),S.logAction(this.logger,S.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+this.state+", message count = "+n.length);const i=mn({action:Ke.MESSAGE,channel:this.name,messages:n});return this.sendMessage(i)}throwIfUnpublishableState(){if(!this.connectionManager.activeState())throw this.connectionManager.getError();if("failed"===this.state||"suspended"===this.state)throw this.invalidStateError()}onEvent(e){S.logAction(this.logger,S.LOG_MICRO,"RealtimeChannel.onEvent()","received message");const t=this.subscriptions;for(let n=0;n<e.length;n++){const r=e[n];t.emit(r.name,r)}}async attach(){return"attached"===this.state?null:new Promise((e,t)=>{this._attach(!1,null,(n,r)=>n?t(n):e(r))})}_attach(e,t,n){n||(n=e=>{e&&S.logAction(this.logger,S.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+e.toString())});const r=this.connectionManager;r.activeState()?(("attaching"!==this.state||e)&&this.requestState("attaching",t),this.once(function(e){switch(this.event){case"attached":null==n||n(null,e);break;case"detached":case"suspended":case"failed":null==n||n(e.reason||r.getError()||new E("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":null==n||n(new E("Attach request superseded by a subsequent detach request",9e4,409))}})):n(r.getError())}attachImpl(){S.logAction(this.logger,S.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message");const e=mn({action:Ke.ATTACH,channel:this.name,params:this.channelOptions.params,channelSerial:this.properties.channelSerial});this.channelOptions.modes&&e.encodeModesToFlags(ae(this.channelOptions.modes)),this._attachResume&&e.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(e.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(e).catch(kn)}async detach(){const e=this.connectionManager;if(!e.activeState())throw e.getError();switch(this.state){case"suspended":return void this.notifyState("detached");case"detached":return;case"failed":throw new E("Unable to detach; channel state = failed",90001,400);default:this.requestState("detaching");case"detaching":return new Promise((t,n)=>{this.once(function(r){switch(this.event){case"detached":t();break;case"attached":case"suspended":case"failed":n(r.reason||e.getError()||new E("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":n(new E("Detach request superseded by a subsequent attach request",9e4,409))}})})}}detachImpl(){S.logAction(this.logger,S.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message");const e=mn({action:Ke.DETACH,channel:this.name});this.sendMessage(e).catch(kn)}async subscribe(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];const[i,o]=e.processListenerArgs(n);if("failed"===this.state)throw E.fromValues(this.invalidStateError());return i&&"object"===typeof i&&!Array.isArray(i)?this.client._FilteredSubscriptions.subscribeFilter(this,i,o):this.subscriptions.on(i,o),!1!==this.channelOptions.attachOnSubscribe?this.attach():null}unsubscribe(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];const[o,s]=e.processListenerArgs(r);"object"===typeof o&&!s||(null==(t=this.filteredSubscriptions)?void 0:t.has(s))?this.client._FilteredSubscriptions.getAndDeleteFilteredSubscriptions(this,o,s).forEach(e=>this.subscriptions.off(e)):this.subscriptions.off(o,s)}sync(){switch(this.state){case"initialized":case"detaching":case"detached":throw new T("Unable to sync to channel; not attached",4e4)}const e=this.connectionManager;if(!e.activeState())throw e.getError();const t=mn({action:Ke.SYNC,channel:this.name});this.syncChannelSerial&&(t.channelSerial=this.syncChannelSerial),e.send(t)}async sendMessage(e){return new Promise((t,n)=>{this.connectionManager.send(e,this.client.options.queueMessages,e=>{e?n(e):t()})})}async sendPresence(e){const t=mn({action:Ke.PRESENCE,channel:this.name,presence:e});return this.sendMessage(t)}sendState(e){const t=mn({action:Ke.OBJECT,channel:this.name,state:e});return this.sendMessage(t)}async processMessage(e){e.action!==Ke.ATTACHED&&e.action!==Ke.MESSAGE&&e.action!==Ke.PRESENCE&&e.action!==Ke.OBJECT&&e.action!==Ke.ANNOTATION||this.setChannelSerial(e.channelSerial);let t,n=!1;switch(e.action){case Ke.ATTACHED:{this.properties.attachSerial=e.channelSerial,this._mode=e.getMode(),this.params=e.params||{};const t=e.decodeModesFromFlags();this.modes=t&&se(t)||void 0;const n=e.hasFlag("RESUMED"),r=e.hasFlag("HAS_PRESENCE"),i=e.hasFlag("HAS_BACKLOG"),o=e.hasFlag("HAS_OBJECTS");if("attached"===this.state){n||(this._presence&&this._presence.onAttached(r),this._objects&&this._objects.onAttached(o));const t=new wn(this.state,this.state,n,i,e.error);this._allChannelChanges.emit("update",t),n&&!this.channelOptions.updateOnAttached||this.emit("update",t)}else"detaching"===this.state?this.checkPendingState():this.notifyState("attached",e.error,n,r,i,o);break}case Ke.DETACHED:{const t=e.error?E.fromValues(e.error):new E("Channel detached",90001,404);"detaching"===this.state?this.notifyState("detached",t):"attaching"===this.state?this.notifyState("suspended",t):"attached"!==this.state&&"suspended"!==this.state||this.requestState("attaching",t);break}case Ke.SYNC:if(n=!0,t=this.syncChannelSerial=e.channelSerial,!e.presence)break;case Ke.PRESENCE:{if(!e.presence)break;ct(e);const r=this.channelOptions;if(this._presence){const i=await Promise.all(e.presence.map(e=>e.decode(r,this.logger)));this._presence.setPresence(i,n,t)}break}case Ke.OBJECT:case Ke.OBJECT_SYNC:{if(!this._objects||!e.state)return;ct(e);const t=this.client.connection.connectionManager.getActiveTransportFormat(),n=e.state.map(e=>e.decode(this.client,t));e.action===Ke.OBJECT?this._objects.handleObjectMessages(n):this._objects.handleObjectSyncMessages(n,e.channelSerial);break}case Ke.MESSAGE:{if("attached"!==this.state)return void S.logAction(this.logger,S.LOG_MAJOR,"RealtimeChannel.processMessage()",'Message "'+e.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');ct(e);const t=e.messages,n=t[0],r=t[t.length-1];if(n.extras&&n.extras.delta&&n.extras.delta.from!==this._lastPayload.messageId){const t='Delta message decode failure - previous message not available for message "'+e.id+'" on this channel "'+this.name+'".';S.logAction(this.logger,S.LOG_ERROR,"RealtimeChannel.processMessage()",t),this._startDecodeFailureRecovery(new E(t,40018,400));break}let i=[];for(let e=0;e<t.length;e++){const{decoded:n,err:r}=await t[e].decodeWithErr(this._decodingContext,this.logger);if(i[e]=n,r)switch(r.code){case 40018:return void this._startDecodeFailureRecovery(r);case 40019:case 40021:return void this.notifyState("failed",r)}}this._lastPayload.messageId=r.id,this._lastPayload.protocolMessageChannelSerial=e.channelSerial,this.onEvent(i);break}case Ke.ANNOTATION:{ct(e);const t=this.channelOptions;if(this._annotations){const n=await Promise.all((e.annotations||[]).map(e=>e.decode(t,this.logger)));this._annotations._processIncoming(n)}break}case Ke.ERROR:{const t=e.error;t&&80016==t.code?this.checkPendingState():this.notifyState("failed",E.fromValues(t));break}default:S.logAction(this.logger,S.LOG_MAJOR,"RealtimeChannel.processMessage()","Protocol error: unrecognised message action ("+e.action+")")}}_startDecodeFailureRecovery(e){this._lastPayload.decodeFailureRecoveryInProgress||(S.logAction(this.logger,S.LOG_MAJOR,"RealtimeChannel.processMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,e,()=>{this._lastPayload.decodeFailureRecoveryInProgress=!1}))}onAttached(){S.logAction(this.logger,S.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)}notifyState(e,t,n,r,i,o){if(S.logAction(this.logger,S.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+e),this.clearStateTimer(),["detached","suspended","failed"].includes(e)&&(this.properties.channelSerial=null),e===this.state)return;this._presence&&this._presence.actOnChannelState(e,r,t),this._objects&&this._objects.actOnChannelState(e,o),"suspended"===e&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),t&&(this.errorReason=t);const s=new wn(this.state,e,n,i,t),a='Channel state for channel "'+this.name+'"',l=e+(t?"; reason: "+t:"");"failed"===e?S.logAction(this.logger,S.LOG_ERROR,a,l):S.logAction(this.logger,S.LOG_MAJOR,a,l),"attaching"!==e&&"suspended"!==e&&(this.retryCount=0),"attached"===e&&this.onAttached(),"attached"===e?this._attachResume=!0:"detaching"!==e&&"failed"!==e||(this._attachResume=!1),this.state=e,this._allChannelChanges.emit(e,s),this.emit(e,s)}requestState(e,t){S.logAction(this.logger,S.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+e),this.notifyState(e,t),this.checkPendingState()}checkPendingState(){if(this.connectionManager.state.sendEvents)switch(S.logAction(this.logger,S.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync()}else S.logAction(this.logger,S.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state)}timeoutPendingState(){switch(this.state){case"attaching":{const e=new E("Channel attach timed out",90007,408);this.notifyState("suspended",e);break}case"detaching":{const e=new E("Channel detach timed out",90007,408);this.notifyState("attached",e);break}default:this.checkPendingState()}}startStateTimerIfNotRunning(){this.stateTimer||(this.stateTimer=setTimeout(()=>{S.logAction(this.logger,S.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),this.stateTimer=null,this.timeoutPendingState()},this.client.options.timeouts.realtimeRequestTimeout))}clearStateTimer(){const e=this.stateTimer;e&&(clearTimeout(e),this.stateTimer=null)}startRetryTimer(){if(this.retryTimer)return;this.retryCount++;const e=ue(this.client.options.timeouts.channelRetryTimeout,this.retryCount);this.retryTimer=setTimeout(()=>{"suspended"===this.state&&this.connectionManager.state.sendEvents&&(this.retryTimer=null,S.logAction(this.logger,S.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),this.requestState("attaching"))},e)}cancelRetryTimer(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)}getReleaseErr(){const e=this.state;return"initialized"===e||"detached"===e||"failed"===e?null:new E("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+e,90001,400)}setChannelSerial(e){S.logAction(this.logger,S.LOG_MICRO,"RealtimeChannel.setChannelSerial()","Updating channel serial; serial = "+e+"; previous = "+this.properties.channelSerial),e&&(this.properties.channelSerial=e)}async status(){return this.client.rest.channelMixin.status(this)}},On=class{constructor(e){this.channel=e,this.logger=e.logger,this.subscriptions=new $e(this.logger)}async publish(e,t){const n=this.channel.name,r=cn(e,t),i=await r.encode();this.channel.throwIfUnpublishableState(),S.logAction(this.logger,S.LOG_MICRO,"RealtimeAnnotations.publish()","channelName = "+n+", sending annotation with messageSerial = "+r.messageSerial+", type = "+r.type);const o=mn({action:Ke.ANNOTATION,channel:n,annotations:[i]});return this.channel.sendMessage(o)}async delete(e,t){return t.action="annotation.delete",this.publish(e,t)}async subscribe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=Cn.processListenerArgs(t),i=r[0],o=r[1],s=this.channel;if("failed"===s.state)throw E.fromValues(s.invalidStateError());if(this.subscriptions.on(i,o),!1!==this.channel.channelOptions.attachOnSubscribe&&await s.attach(),0===("attached"===this.channel.state&&this.channel._mode&Xe.ANNOTATION_SUBSCRIBE))throw new E("You are trying to add an annotation listener, but you haven't requested the annotation_subscribe channel mode in ChannelOptions, so this won't do anything (we only deliver annotations to clients who have explicitly requested them)",93001,400)}unsubscribe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=Cn.processListenerArgs(t),i=r[0],o=r[1];this.subscriptions.off(i,o)}_processIncoming(e){for(const t of e)this.subscriptions.emit(t.type||"",t)}async get(e,t){return hn.prototype.get.call(this,e,t)}},En=class e extends Jt{constructor(t){var n,r;if(!e._MsgPack)throw new Error("Expected DefaultRest._MsgPack to have been set");super(Me.objectifyOptions(t,!0,"Rest",S.defaultLogger,p(f({},Xt),{Crypto:null!=(n=e.Crypto)?n:void 0,MsgPack:null!=(r=e._MsgPack)?r:void 0,Annotations:{Annotation:sn,WireAnnotation:on,RealtimeAnnotations:On,RestAnnotations:hn}})))}static get Crypto(){if(null===this._Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");return this._Crypto}static set Crypto(e){this._Crypto=e}};En._Crypto=null,En.Message=Yt,En.PresenceMessage=Zt,En.Annotation=an,En._MsgPack=null,En._Http=We;var Tn,Rn,An=En,_n=class extends $e{constructor(e){super(e),this.messages=[]}count(){return this.messages.length}push(e){this.messages.push(e)}shift(){return this.messages.shift()}last(){return this.messages[this.messages.length-1]}copyAll(){return this.messages.slice()}append(e){this.messages.push.apply(this.messages,e)}prepend(e){this.messages.unshift.apply(this.messages,e)}completeMessages(e,t,n){S.logAction(this.logger,S.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+e+"; count = "+t),n=n||null;const r=this.messages;if(0===r.length)throw new Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");const i=r[0];if(i){const o=i.message.msgSerial,s=e+t;if(s>o){const e=r.splice(0,s-o);for(const t of e)t.callback(n)}0==r.length&&this.emit("idle")}}completeAllMessages(e){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,e)}resetSendAttempted(){for(let e of this.messages)e.sendAttempted=!1}clear(){S.logAction(this.logger,S.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")}},Pn=class{constructor(e,t){this.message=e,this.callback=t,this.merged=!1;const n=e.action;this.sendAttempted=!1,this.ackRequired="number"===typeof n&&[Ke.MESSAGE,Ke.PRESENCE,Ke.ANNOTATION,Ke.OBJECT].includes(n)}},Mn=class extends $e{constructor(e){super(e.logger),this.transport=e,this.messageQueue=new _n(this.logger),e.on("ack",(e,t)=>{this.onAck(e,t)}),e.on("nack",(e,t,n)=>{this.onNack(e,t,n)})}onAck(e,t){S.logAction(this.logger,S.LOG_MICRO,"Protocol.onAck()","serial = "+e+"; count = "+t),this.messageQueue.completeMessages(e,t)}onNack(e,t,n){S.logAction(this.logger,S.LOG_ERROR,"Protocol.onNack()","serial = "+e+"; count = "+t+"; err = "+X(n)),n||(n=new E("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(e,t,n)}onceIdle(e){const t=this.messageQueue;0!==t.count()?t.once("idle",e):e()}send(e){e.ackRequired&&this.messageQueue.push(e),this.logger.shouldLog(S.LOG_MICRO)&&S.logActionNoStrip(this.logger,S.LOG_MICRO,"Protocol.send()","sending msg; "+yn(e.message,this.transport.connectionManager.realtime._RealtimePresence,this.transport.connectionManager.realtime._Annotations,this.transport.connectionManager.realtime._objectsPlugin)),e.sendAttempted=!0,this.transport.send(e.message)}getTransport(){return this.transport}getPendingMessages(){return this.messageQueue.copyAll()}clearPendingMessages(){return this.messageQueue.clear()}finish(){const e=this.transport;this.onceIdle(function(){e.disconnect()})}},In=class{constructor(e,t,n,r){this.previous=e,this.current=t,n&&(this.retryIn=n),r&&(this.reason=r)}},xn={DISCONNECTED:80003,SUSPENDED:80002,FAILED:8e4,CLOSING:80017,CLOSED:80017,UNKNOWN_CONNECTION_ERR:50002,UNKNOWN_CHANNEL_ERR:50001},Nn={disconnected:()=>E.fromValues({statusCode:400,code:xn.DISCONNECTED,message:"Connection to server temporarily unavailable"}),suspended:()=>E.fromValues({statusCode:400,code:xn.SUSPENDED,message:"Connection to server unavailable"}),failed:()=>E.fromValues({statusCode:400,code:xn.FAILED,message:"Connection failed or disconnected by server"}),closing:()=>E.fromValues({statusCode:400,code:xn.CLOSING,message:"Connection closing"}),closed:()=>E.fromValues({statusCode:400,code:xn.CLOSED,message:"Connection closed"}),unknownConnectionErr:()=>E.fromValues({statusCode:500,code:xn.UNKNOWN_CONNECTION_ERR,message:"Internal connection error"}),unknownChannelErr:()=>E.fromValues({statusCode:500,code:xn.UNKNOWN_CONNECTION_ERR,message:"Internal channel error"})},Ln=mn({action:Ke.CLOSE}),Un=mn({action:Ke.DISCONNECT}),Dn=class extends $e{constructor(e,t,n,r){super(e.logger),r&&(n.format=void 0,n.heartbeats=!0),this.connectionManager=e,this.auth=t,this.params=n,this.timeouts=n.options.timeouts,this.format=n.format,this.isConnected=!1,this.isFinished=!1,this.isDisposed=!1,this.maxIdleInterval=null,this.idleTimer=null,this.lastActivity=null}connect(){}close(){this.isConnected&&this.requestClose(),this.finish("closed",Nn.closed())}disconnect(e){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",e||Nn.disconnected())}fail(e){this.isConnected&&this.requestDisconnect(),this.finish("failed",e||Nn.failed())}finish(e,t){var n;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout(null!=(n=this.idleTimer)?n:void 0),this.idleTimer=null,this.emit(e,t),this.dispose())}onProtocolMessage(e){switch(this.logger.shouldLog(S.LOG_MICRO)&&S.logActionNoStrip(this.logger,S.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+yn(e,this.connectionManager.realtime._RealtimePresence,this.connectionManager.realtime._Annotations,this.connectionManager.realtime._objectsPlugin)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),e.action){case Ke.HEARTBEAT:S.logActionNoStrip(this.logger,S.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",e.id);break;case Ke.CONNECTED:this.onConnect(e),this.emit("connected",e.error,e.connectionId,e.connectionDetails,e);break;case Ke.CLOSED:this.onClose(e);break;case Ke.DISCONNECTED:this.onDisconnect(e);break;case Ke.ACK:this.emit("ack",e.msgSerial,e.count);break;case Ke.NACK:this.emit("nack",e.msgSerial,e.count,e.error);break;case Ke.SYNC:this.connectionManager.onChannelMessage(e,this);break;case Ke.ACTIVATE:break;case Ke.AUTH:re(this.auth.authorize(),e=>{e&&S.logAction(this.logger,S.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+X(e))});break;case Ke.ERROR:if(S.logAction(this.logger,S.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+y.Config.inspect(e.error)+(e.channel?", channel: "+e.channel:"")),void 0===e.channel){this.onFatalError(e);break}this.connectionManager.onChannelMessage(e,this);break;default:this.connectionManager.onChannelMessage(e,this)}}onConnect(e){if(this.isConnected=!0,!e.connectionDetails)throw new Error("Transport.onConnect(): Connect message recieved without connectionDetails");const t=e.connectionDetails.maxIdleInterval;t&&(this.maxIdleInterval=t+this.timeouts.realtimeRequestTimeout,this.onActivity())}onDisconnect(e){const t=e&&e.error;S.logAction(this.logger,S.LOG_MINOR,"Transport.onDisconnect()","err = "+X(t)),this.finish("disconnected",t)}onFatalError(e){const t=e&&e.error;S.logAction(this.logger,S.LOG_MINOR,"Transport.onFatalError()","err = "+X(t)),this.finish("failed",t)}onClose(e){const t=e&&e.error;S.logAction(this.logger,S.LOG_MINOR,"Transport.onClose()","err = "+X(t)),this.finish("closed",t)}requestClose(){S.logAction(this.logger,S.LOG_MINOR,"Transport.requestClose()",""),this.send(Ln)}requestDisconnect(){S.logAction(this.logger,S.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(Un)}ping(e){const t={action:Ke.HEARTBEAT};e&&(t.id=e),this.send(mn(t))}dispose(){S.logAction(this.logger,S.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()}onActivity(){this.maxIdleInterval&&(this.lastActivity=this.connectionManager.lastActivity=Date.now(),this.setIdleTimer(this.maxIdleInterval+100))}setIdleTimer(e){this.idleTimer||(this.idleTimer=setTimeout(()=>{this.onIdleTimerExpire()},e))}onIdleTimerExpire(){if(!this.lastActivity||!this.maxIdleInterval)throw new Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;const e=Date.now()-this.lastActivity,t=this.maxIdleInterval-e;if(t<=0){const t="No activity seen from realtime in "+e+"ms; assuming connection has dropped";S.logAction(this.logger,S.LOG_ERROR,"Transport.onIdleTimerExpire()",t),this.disconnect(new E(t,80003,408))}else this.setIdleTimer(t+100)}static tryConnect(e,t,n,r,i){const o=new e(t,n,r);let s;const a=function(e){clearTimeout(s),i({event:this.event,error:e})},l=t.options.timeouts.realtimeRequestTimeout;return s=setTimeout(()=>{o.off(["preconnect","disconnected","failed"]),o.dispose(),a.call({event:"disconnected"},new E("Timeout waiting for transport to indicate itself viable",5e4,500))},l),o.on(["failed","disconnected"],a),o.on("preconnect",function(){S.logAction(t.logger,S.LOG_MINOR,"Transport.tryConnect()","viable transport "+o),clearTimeout(s),o.off(["failed","disconnected"],a),i(null,o)}),o.connect(),o}static isAvailable(){throw new E("isAvailable not implemented for transport",5e4,500)}};(Rn=Tn||(Tn={})).WebSocket="web_socket",Rn.Comet="comet",Rn.XhrPolling="xhr_polling";var zn="undefined"!==typeof n.g?n.g:"undefined"!==typeof window?window:self,jn=()=>{var e;return"undefined"!==typeof y.WebStorage&&(null==(e=y.WebStorage)?void 0:e.localSupported)},Bn=()=>{var e;return"undefined"!==typeof y.WebStorage&&(null==(e=y.WebStorage)?void 0:e.sessionSupported)},Gn=function(){},Fn="ably-transport-preference";function Hn(e){try{return JSON.parse(e)}catch(t){return null}}var qn=class{constructor(e,t,n,r){this.options=e,this.host=t,this.mode=n,this.connectionKey=r,this.format=e.useBinaryProtocol?"msgpack":"json"}getConnectParams(e){const t=e?A(e):{},n=this.options;switch(this.mode){case"resume":t.resume=this.connectionKey;break;case"recover":{const e=Hn(n.recover);e&&(t.recover=e.connectionKey);break}}return void 0!==n.clientId&&(t.clientId=n.clientId),!1===n.echoMessages&&(t.echo="false"),void 0!==this.format&&(t.format=this.format),void 0!==this.stream&&(t.stream=this.stream),void 0!==this.heartbeats&&(t.heartbeats=this.heartbeats),t.v=Me.protocolVersion,t.agent=Re(this.options),void 0!==n.transportParams&&R(t,n.transportParams),t}toString(){let e="[mode="+this.mode;return this.host&&(e+=",host="+this.host),this.connectionKey&&(e+=",connectionKey="+this.connectionKey),this.format&&(e+=",format="+this.format),e+="]",e}},Vn=class e extends $e{constructor(e,t){super(e.logger),this.supportedTransports={},this.disconnectedRetryCount=0,this.pendingChannelMessagesState={isProcessing:!1,queue:[]},this.realtime=e,this.initTransports(),this.options=t;const n=t.timeouts,r=n.webSocketConnectTimeout+n.realtimeRequestTimeout;if(this.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:r,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:n.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:n.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:n.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},this.state=this.states.initialized,this.errorReason=null,this.queuedMessages=new _n(this.logger),this.msgSerial=0,this.connectionDetails=void 0,this.connectionId=void 0,this.connectionKey=void 0,this.connectionStateTtl=n.connectionStateTtl,this.maxIdleInterval=null,this.transports=D(t.transports||Me.defaultTransports,this.supportedTransports),this.transportPreference=null,this.transports.includes(Tn.WebSocket)&&(this.webSocketTransportAvailable=!0),this.transports.includes(Tn.XhrPolling)?this.baseTransport=Tn.XhrPolling:this.transports.includes(Tn.Comet)&&(this.baseTransport=Tn.Comet),this.domains=Me.getHosts(t),this.activeProtocol=null,this.host=null,this.lastAutoReconnectAttempt=null,this.lastActivity=null,this.forceFallbackHost=!1,this.connectCounter=0,this.wsCheckResult=null,this.webSocketSlowTimer=null,this.webSocketGiveUpTimer=null,this.abandonedWebSocket=!1,S.logAction(this.logger,S.LOG_MINOR,"Realtime.ConnectionManager()","started"),S.logAction(this.logger,S.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(t.transports||Me.defaultTransports)+"]"),S.logAction(this.logger,S.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+this.transports+"]"),S.logAction(this.logger,S.LOG_MICRO,"Realtime.ConnectionManager()","http domains = ["+this.domains+"]"),!this.transports.length){const e="no requested transports available";throw S.logAction(this.logger,S.LOG_ERROR,"realtime.ConnectionManager()",e),new Error(e)}const i=y.Config.addEventListener;i&&(Bn()&&"function"===typeof t.recover&&i("beforeunload",this.persistConnection.bind(this)),!0===t.closeOnUnload&&i("beforeunload",()=>{S.logAction(this.logger,S.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),this.requestState({state:"closing"})}),i("online",()=>{var e;this.state==this.states.disconnected||this.state==this.states.suspended?(S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager caught browser \u2018online\u2019 event","reattempting connection"),this.requestState({state:"connecting"})):this.state==this.states.connecting&&(null==(e=this.pendingTransport)||e.off(),this.disconnectAllTransports(),this.startConnect())}),i("offline",()=>{this.state==this.states.connected&&(S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager caught browser \u2018offline\u2019 event","disconnecting active transport"),this.disconnectAllTransports())}))}static supportedTransports(e){const t={supportedTransports:{}};return this.initTransports(e,t),t.supportedTransports}static initTransports(e,t){const n=f(f({},y.Transports.bundledImplementations),e);[Tn.WebSocket,...y.Transports.order].forEach(e=>{const r=n[e];r&&r.isAvailable()&&(t.supportedTransports[e]=r)})}initTransports(){e.initTransports(this.realtime._additionalTransportImplementations,this)}createTransportParams(e,t){return new qn(this.options,e,t,this.connectionKey)}getTransportParams(e){(e=>{if(this.connectionKey)return void e("resume");if("string"===typeof this.options.recover)return void e("recover");const t=this.options.recover,n=this.getSessionRecoverData(),r=this.sessionRecoveryName();if(n&&"function"===typeof t)return S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data (recovery scope: "+r+")"),void t(n,t=>{t?(this.options.recover=n.recoveryKey,e("recover")):e("clean")});e("clean")})(t=>{const n=this.createTransportParams(null,t);if("recover"===t){S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+this.options.recover);const e=Hn(this.options.recover);e&&(this.msgSerial=e.msgSerial)}else S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+n.toString());e(n)})}tryATransport(e,t,n){S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+t),this.proposedTransport=Dn.tryConnect(this.supportedTransports[t],this,this.realtime.auth,e,(r,i)=>{const o=this.state;return o==this.states.closing||o==this.states.closed||o==this.states.failed?(i&&(S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+o.state+" while we were attempting the transport; closing "+i),i.close()),void n(!0)):r?(S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+t+" "+r.event+", err: "+r.error.toString()),void(!He.isTokenErr(r.error)||this.errorReason&&He.isTokenErr(this.errorReason)?"failed"===r.event?(this.notifyState({state:"failed",error:r.error}),n(!0)):"disconnected"===r.event&&(!(s=r.error).statusCode||!s.code||s.statusCode>=500||Object.values(xn).includes(s.code)?n(!1):(this.notifyState({state:this.states.connecting.failState,error:r.error}),n(!0))):(this.errorReason=r.error,re(this.realtime.auth._forceNewToken(null,null),r=>{r?this.actOnErrorFromAuthorize(r):this.tryATransport(e,t,n)})))):(S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+t+"; setting pending"),this.setTransportPending(i,e),void n(null,i));var s})}setTransportPending(e,t){const n=t.mode;S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+e+"; mode = "+n),this.pendingTransport=e,this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),e.once("connected",(t,r,i)=>{this.activateTransport(t,e,r,i),"recover"===n&&this.options.recover&&(delete this.options.recover,this.unpersistConnection())});const r=this;e.on(["disconnected","closed","failed"],function(t){r.deactivateTransport(e,this.event,t)}),this.emit("transport.pending",e)}activateTransport(e,t,n,r){S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+t),e&&S.logAction(this.logger,S.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+e),n&&S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+n),r&&S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(r)),this.persistTransportPreference(t);const i=this.state,o=this.states.connected.state;if(S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+i.state),i.state==this.states.closing.state||i.state==this.states.closed.state||i.state==this.states.failed.state)return S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),t.disconnect(),!1;if(delete this.pendingTransport,!t.isConnected)return S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+t+" since it appears to no longer be connected"),!1;const s=this.activeProtocol;this.activeProtocol=new Mn(t),this.host=t.params.host;const a=r.connectionKey;if(a&&this.connectionKey!=a&&this.setConnection(n,r,!!e),this.onConnectionDetailsUpdate(r,t),y.Config.nextTick(()=>{t.on("connected",(e,n,r)=>{this.onConnectionDetailsUpdate(r,t),this.emit("update",new In(o,o,null,e))})}),i.state===this.states.connected.state?e&&(this.errorReason=this.realtime.connection.errorReason=e,this.emit("update",new In(o,o,null,e))):(this.notifyState({state:"connected",error:e}),this.errorReason=this.realtime.connection.errorReason=e||null),this.emit("transport.active",t),s)if(s.messageQueue.count()>0&&S.logAction(this.logger,S.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+s.transport.shortName+", new one is "+t.shortName+") finishing with "+s.messageQueue.count()+" messages still pending"),s.transport===t){const e="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+t.shortName+"; stack = "+(new Error).stack;S.logAction(this.logger,S.LOG_ERROR,"ConnectionManager.activateTransport()",e)}else s.finish();return!0}deactivateTransport(e,t,n){const r=this.activeProtocol,i=r&&r.getTransport()===e,o=e===this.pendingTransport,s=this.noTransportsScheduledForActivation();if(S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+e),S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+t+(i?"; was active":o?"; was pending":"")+(s?"":"; another transport is scheduled for activation")),n&&n.message&&S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+n.message),i&&(S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(r.getPendingMessages()),r.clearPendingMessages(),this.activeProtocol=this.host=null),this.emit("transport.inactive",e),i&&s||i&&"failed"===t||"closed"===t||null===r&&o){if("disconnected"===t&&n&&n.statusCode>500&&this.domains.length>1)return this.unpersistTransportPreference(),this.forceFallbackHost=!0,void this.notifyState({state:t,error:n,retryImmediately:!0});const e="failed"===t&&He.isTokenErr(n)?"disconnected":t;return void this.notifyState({state:e,error:n})}}noTransportsScheduledForActivation(){return!this.pendingTransport||!this.pendingTransport.isConnected}setConnection(e,t,n){const r=this.connectionId;(r&&r!==e||!r&&n)&&(S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0,this.queuedMessages.resetSendAttempted()),this.connectionId!==e&&S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),this.realtime.connection.id=this.connectionId=e,this.realtime.connection.key=this.connectionKey=t.connectionKey}clearConnection(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.msgSerial=0,this.unpersistConnection()}createRecoveryKey(){return this.connectionKey?JSON.stringify({connectionKey:this.connectionKey,msgSerial:this.msgSerial,channelSerials:this.realtime.channels.channelSerials()}):null}checkConnectionStateFreshness(){if(!this.lastActivity||!this.connectionId)return;const e=Date.now()-this.lastActivity;e>this.connectionStateTtl+this.maxIdleInterval&&(S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+e+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}persistConnection(){if(Bn()){const e=this.createRecoveryKey();e&&this.setSessionRecoverData({recoveryKey:e,disconnectedAt:Date.now(),location:zn.location,clientId:this.realtime.auth.clientId})}}unpersistConnection(){this.clearSessionRecoverData()}getActiveTransportFormat(){var e;return null==(e=this.activeProtocol)?void 0:e.getTransport().format}getError(){if(this.errorReason){const e=T.fromValues(this.errorReason);return e.cause=this.errorReason,e}return this.getStateError()}getStateError(){var e,t;return null==(t=(e=Nn)[this.state.state])?void 0:t.call(e)}activeState(){return this.state.queueEvents||this.state.sendEvents}enactStateChange(e){const t="Connection state",n=e.current+(e.reason?"; reason: "+e.reason:"");"failed"===e.current?S.logAction(this.logger,S.LOG_ERROR,t,n):S.logAction(this.logger,S.LOG_MAJOR,t,n),S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+e.current+"; reason = "+(e.reason&&e.reason.message));const r=this.state=this.states[e.current];e.reason&&(this.errorReason=e.reason,this.realtime.connection.errorReason=e.reason),(r.terminal||"suspended"===r.state)&&this.clearConnection(),this.emit("connectionstate",e)}startTransitionTimer(e){S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+e.state),this.transitionTimer&&(S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout(()=>{this.transitionTimer&&(this.transitionTimer=null,S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager "+e.state+" timer expired","requesting new state: "+e.failState),this.notifyState({state:e.failState}))},e.retryDelay)}cancelTransitionTimer(){S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)}startSuspendTimer(){this.suspendTimer||(this.suspendTimer=setTimeout(()=>{this.suspendTimer&&(this.suspendTimer=null,S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),this.states.connecting.failState="suspended",this.notifyState({state:"suspended"}))},this.connectionStateTtl))}checkSuspendTimer(e){"disconnected"!==e&&"suspended"!==e&&"connecting"!==e&&this.cancelSuspendTimer()}cancelSuspendTimer(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)}startRetryTimer(e){this.retryTimer=setTimeout(()=>{S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),this.retryTimer=null,this.requestState({state:"connecting"})},e)}cancelRetryTimer(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)}startWebSocketSlowTimer(){this.webSocketSlowTimer=setTimeout(()=>{S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager WebSocket slow timer","checking connectivity"),this.checkWsConnectivity().then(()=>{S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager WebSocket slow timer","ws connectivity check succeeded"),this.wsCheckResult=!0}).catch(()=>{S.logAction(this.logger,S.LOG_MAJOR,"ConnectionManager WebSocket slow timer","ws connectivity check failed"),this.wsCheckResult=!1}),this.realtime.http.checkConnectivity&&re(this.realtime.http.checkConnectivity(),(e,t)=>{e||!t?(S.logAction(this.logger,S.LOG_MAJOR,"ConnectionManager WebSocket slow timer","http connectivity check failed"),this.cancelWebSocketGiveUpTimer(),this.notifyState({state:"disconnected",error:new E("Unable to connect (network unreachable)",80003,404)})):S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager WebSocket slow timer","http connectivity check succeeded")})},this.options.timeouts.webSocketSlowTimeout)}cancelWebSocketSlowTimer(){this.webSocketSlowTimer&&(clearTimeout(this.webSocketSlowTimer),this.webSocketSlowTimer=null)}startWebSocketGiveUpTimer(e){this.webSocketGiveUpTimer=setTimeout(()=>{var t,n;this.wsCheckResult||(S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager WebSocket give up timer","websocket connection took more than 10s; "+(this.baseTransport?"trying base transport":"")),this.baseTransport?(this.abandonedWebSocket=!0,null==(t=this.proposedTransport)||t.dispose(),null==(n=this.pendingTransport)||n.dispose(),this.connectBase(e,++this.connectCounter)):S.logAction(this.logger,S.LOG_MAJOR,"ConnectionManager WebSocket give up timer","websocket connectivity appears to be unavailable but no other transports to try"))},this.options.timeouts.webSocketConnectTimeout)}cancelWebSocketGiveUpTimer(){this.webSocketGiveUpTimer&&(clearTimeout(this.webSocketGiveUpTimer),this.webSocketGiveUpTimer=null)}notifyState(e){var t,n;const r=e.state,i="disconnected"===r&&(this.state===this.states.connected||e.retryImmediately||this.state===this.states.connecting&&e.error&&He.isTokenErr(e.error)&&!(this.errorReason&&He.isTokenErr(this.errorReason)));if(S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+r+(i?"; will retry connection immediately":"")),r==this.state.state)return;if(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),this.checkSuspendTimer(e.state),"suspended"!==r&&"connected"!==r||(this.disconnectedRetryCount=0),this.state.terminal)return;const o=this.states[e.state];let s=o.retryDelay;"disconnected"===o.state&&(this.disconnectedRetryCount++,s=ue(o.retryDelay,this.disconnectedRetryCount));const a=new In(this.state.state,o.state,s,e.error||(null==(n=(t=Nn)[o.state])?void 0:n.call(t)));if(i){const e=()=>{this.state===this.states.disconnected&&(this.lastAutoReconnectAttempt=Date.now(),this.requestState({state:"connecting"}))},t=this.lastAutoReconnectAttempt&&Date.now()-this.lastAutoReconnectAttempt+1;t&&t<1e3?(S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+t+"ms ago, waiting another "+(1e3-t)+"ms before trying again"),setTimeout(e,1e3-t)):y.Config.nextTick(e)}else"disconnected"!==r&&"suspended"!==r||this.startRetryTimer(s);("disconnected"===r&&!i||"suspended"===r||o.terminal)&&y.Config.nextTick(()=>{this.disconnectAllTransports()}),"connected"!=r||this.activeProtocol||S.logAction(this.logger,S.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(a),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(r,a.reason),this.failQueuedMessages(a.reason))}requestState(e){var t,n;const r=e.state;if(S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+r+"; current state: "+this.state.state),r==this.state.state)return;if(this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(r),"connecting"==r&&"connected"==this.state.state)return;if("closing"==r&&"closed"==this.state.state)return;const i=this.states[r],o=new In(this.state.state,i.state,null,e.error||(null==(n=(t=Nn)[i.state])?void 0:n.call(t)));this.enactStateChange(o),"connecting"==r&&y.Config.nextTick(()=>{this.startConnect()}),"closing"==r&&this.closeImpl()}startConnect(){if(this.state!==this.states.connecting)return void S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state);const e=this.realtime.auth,t=++this.connectCounter,n=()=>{this.checkConnectionStateFreshness(),this.getTransportParams(e=>{if("recover"===e.mode&&e.options.recover){const t=Hn(e.options.recover);t&&this.realtime.channels.recoverChannels(t.channelSerials)}t===this.connectCounter&&this.connectImpl(e,t)})};if(S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),"basic"===e.method)n();else{const r=e=>{t===this.connectCounter&&(e?this.actOnErrorFromAuthorize(e):n())};this.errorReason&&He.isTokenErr(this.errorReason)?re(e._forceNewToken(null,null),r):re(e._ensureValidAuthCredentials(!1),r)}}connectImpl(e,t){const n=this.state.state;if(n!==this.states.connecting.state)return void S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect, but was "+n);const r=this.getTransportPreference();r&&r===this.baseTransport&&this.webSocketTransportAvailable&&this.checkWsConnectivity().then(()=>{this.unpersistTransportPreference(),this.state===this.states.connecting&&(S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.connectImpl():","web socket connectivity available, cancelling connection attempt with "+this.baseTransport),this.disconnectAllTransports(),this.connectWs(e,++this.connectCounter))}).catch(Gn),r&&r===this.baseTransport||this.baseTransport&&!this.webSocketTransportAvailable?this.connectBase(e,t):this.connectWs(e,t)}connectWs(e,t){S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.connectWs()"),this.wsCheckResult=null,this.abandonedWebSocket=!1,this.startWebSocketSlowTimer(),this.startWebSocketGiveUpTimer(e),this.tryTransportWithFallbacks("web_socket",e,!0,t,()=>!1!==this.wsCheckResult&&!this.abandonedWebSocket)}connectBase(e,t){S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.connectBase()"),this.baseTransport?this.tryTransportWithFallbacks(this.baseTransport,e,!1,t,()=>!0):this.notifyState({state:"disconnected",error:new E("No transports left to try",8e4,404)})}tryTransportWithFallbacks(e,t,n,r,i){S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.tryTransportWithFallbacks()",e);const o=e=>{this.notifyState({state:this.states.connecting.failState,error:e})},s=this.domains.slice(),a=(e,t)=>{r===this.connectCounter&&(i()?t||e||c():t&&t.dispose())},l=s.shift();if(!l)return void o(new E("Unable to connect (no available host)",80003,404));t.host=l;const c=()=>{s.length?this.realtime.http.checkConnectivity?re(this.realtime.http.checkConnectivity(),(n,l)=>{r===this.connectCounter&&i()&&(n?o(n):l?(t.host=Q(s),this.tryATransport(t,e,a)):o(new E("Unable to connect (network unreachable)",80003,404)))}):o(new T("Internal error: Http.checkConnectivity not set",null,500)):o(new E("Unable to connect (and no more fallback hosts to try)",80003,404))};if(this.forceFallbackHost&&s.length)return this.forceFallbackHost=!1,void c();this.tryATransport(t,e,a)}closeImpl(){S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),this.pendingTransport&&(S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+this.pendingTransport),this.pendingTransport.close()),this.activeProtocol&&(S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})}onAuthUpdated(e,t){var n;switch(this.state.state){case"connected":{S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport");const r=null==(n=this.activeProtocol)?void 0:n.getTransport();r&&r.onAuthUpdated&&r.onAuthUpdated(e);const i=mn({action:Ke.AUTH,auth:{accessToken:e.token}});this.send(i);const o=()=>{this.off(s),t(null,e)},s=e=>{"failed"===e.current&&(this.off(o),this.off(s),t(e.reason||this.getStateError()))};this.once("connectiondetails",o),this.on("connectionstate",s);break}case"connecting":S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:{S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed");const n=r=>{switch(r.current){case"connected":this.off(n),t(null,e);break;case"failed":case"closed":case"suspended":this.off(n),t(r.reason||this.getStateError())}};this.on("connectionstate",n),"connecting"===this.state.state?this.startConnect():this.requestState({state:"connecting"})}}}disconnectAllTransports(){S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"),this.connectCounter++,this.pendingTransport&&(S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+this.pendingTransport),this.pendingTransport.disconnect()),delete this.pendingTransport,this.proposedTransport&&(S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting proposed transport: "+this.pendingTransport),this.proposedTransport.disconnect()),delete this.pendingTransport,this.activeProtocol&&(S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())}send(e,t,n){n=n||Gn;const r=this.state;if(r.sendEvents)return S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.send()","sending event"),void this.sendImpl(new Pn(e,n));if(!t||!r.queueEvents){const e="rejecting event, queueEvent was "+t+", state was "+r.state;return S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.send()",e),void n(this.errorReason||new E(e,9e4,400))}this.logger.shouldLog(S.LOG_MICRO)&&S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+yn(e,this.realtime._RealtimePresence,this.realtime._Annotations,this.realtime._objectsPlugin)),this.queue(e,n)}sendImpl(e){const t=e.message;e.ackRequired&&!e.sendAttempted&&(t.msgSerial=this.msgSerial++);try{this.activeProtocol.send(e)}catch(n){S.logAction(this.logger,S.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+n.stack)}}queue(e,t){S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.queue()","queueing event");const n=this.queuedMessages.last(),r=this.options.maxMessageSize;n&&!n.sendAttempted&&function(e,t,n){let r;if(e.channel!==t.channel)return!1;if((r=e.action)!==Ke.PRESENCE&&r!==Ke.MESSAGE)return!1;if(r!==t.action)return!1;const i=r===Ke.PRESENCE?"presence":"messages",o=e[i].concat(t[i]);return!(Bt(o)>n)&&!!V(o,"clientId")&&!!o.every(function(e){return!e.id})&&(e[i]=o,!0)}(n.message,e,r)?(n.merged||(n.callback=Ie.create(this.logger,[n.callback]),n.merged=!0),n.callback.push(t)):this.queuedMessages.push(new Pn(e,t))}sendQueuedMessages(){let e;for(S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");e=this.queuedMessages.shift();)this.sendImpl(e)}queuePendingMessages(e){e&&e.length&&(S.logAction(this.logger,S.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+e.length+" pending messages"),this.queuedMessages.prepend(e))}failQueuedMessages(e){const t=this.queuedMessages.count();t>0&&(S.logAction(this.logger,S.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+t+" queued messages, err = "+X(e)),this.queuedMessages.completeAllMessages(e))}onChannelMessage(e,t){this.pendingChannelMessagesState.queue.push({message:e,transport:t}),this.pendingChannelMessagesState.isProcessing||this.processNextPendingChannelMessage()}processNextPendingChannelMessage(){if(this.pendingChannelMessagesState.queue.length>0){this.pendingChannelMessagesState.isProcessing=!0;const e=this.pendingChannelMessagesState.queue.shift();this.processChannelMessage(e.message).catch(e=>{S.logAction(this.logger,S.LOG_ERROR,"ConnectionManager.processNextPendingChannelMessage() received error ",e)}).finally(()=>{this.pendingChannelMessagesState.isProcessing=!1,this.processNextPendingChannelMessage()})}}async processChannelMessage(e){await this.realtime.channels.processChannelMessage(e)}async ping(){var e;if("connected"!==this.state.state)throw new E("Unable to ping service; not connected",4e4,400);const t=null==(e=this.activeProtocol)?void 0:e.getTransport();if(!t)throw this.getStateError();S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.ping()","transport = "+t);const n=Date.now(),r=ee();return ve(new Promise(e=>{const i=o=>{o===r&&(t.off("heartbeat",i),e(Date.now()-n))};t.on("heartbeat",i),t.ping(r)}),this.options.timeouts.realtimeRequestTimeout,"Timeout waiting for heartbeat response")}abort(e){this.activeProtocol.getTransport().fail(e)}getTransportPreference(){var e,t;return this.transportPreference||jn()&&(null==(t=null==(e=y.WebStorage)?void 0:e.get)?void 0:t.call(e,Fn))}persistTransportPreference(e){var t,n;this.transportPreference=e.shortName,jn()&&(null==(n=null==(t=y.WebStorage)?void 0:t.set)||n.call(t,Fn,e.shortName))}unpersistTransportPreference(){var e,t;this.transportPreference=null,jn()&&(null==(t=null==(e=y.WebStorage)?void 0:e.remove)||t.call(e,Fn))}actOnErrorFromAuthorize(e){if(40171===e.code)this.notifyState({state:"failed",error:e});else if(40102===e.code)this.notifyState({state:"failed",error:e});else if(e.statusCode===Ue.Forbidden){const t="Client configured authentication provider returned 403; failing the connection";S.logAction(this.logger,S.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",t),this.notifyState({state:"failed",error:new E(t,80019,403,e)})}else{const t="Client configured authentication provider request failed";S.logAction(this.logger,S.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",t),this.notifyState({state:this.state.failState,error:new E(t,80019,401,e)})}}onConnectionDetailsUpdate(e,t){if(!e)return;this.connectionDetails=e,e.maxMessageSize&&(this.options.maxMessageSize=e.maxMessageSize);const n=e.clientId;if(n){const e=this.realtime.auth._uncheckedSetClientId(n);if(e)return S.logAction(this.logger,S.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",e.message),void t.fail(e)}const r=e.connectionStateTtl;r&&(this.connectionStateTtl=r),this.maxIdleInterval=e.maxIdleInterval,this.emit("connectiondetails",e)}checkWsConnectivity(){const e=this.options.wsConnectivityCheckUrl||Me.wsConnectivityCheckUrl,t=new y.Config.WebSocket(e);return new Promise((e,n)=>{let r=!1;t.onopen=()=>{r||(r=!0,e(),t.close())},t.onclose=t.onerror=()=>{r||(r=!0,n())}})}sessionRecoveryName(){return this.options.recoveryKeyStorageName||"ably-connection-recovery"}getSessionRecoverData(){var e,t;return Bn()&&(null==(t=null==(e=y.WebStorage)?void 0:e.getSession)?void 0:t.call(e,this.sessionRecoveryName()))}setSessionRecoverData(e){var t,n;return Bn()&&(null==(n=null==(t=y.WebStorage)?void 0:t.setSession)?void 0:n.call(t,this.sessionRecoveryName(),e))}clearSessionRecoverData(){var e,t;return Bn()&&(null==(t=null==(e=y.WebStorage)?void 0:e.removeSession)?void 0:t.call(e,this.sessionRecoveryName()))}},Wn=class extends $e{constructor(e,t){super(e.logger),this.whenState=e=>$e.prototype.whenState.call(this,e,this.state),this.ably=e,this.connectionManager=new Vn(e,t),this.state=this.connectionManager.state.state,this.key=void 0,this.id=void 0,this.errorReason=null,this.connectionManager.on("connectionstate",e=>{const t=this.state=e.current;y.Config.nextTick(()=>{this.emit(t,e)})}),this.connectionManager.on("update",e=>{y.Config.nextTick(()=>{this.emit("update",e)})})}connect(){S.logAction(this.logger,S.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})}async ping(){return S.logAction(this.logger,S.LOG_MINOR,"Connection.ping()",""),this.connectionManager.ping()}close(){S.logAction(this.logger,S.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})}get recoveryKey(){return this.logger.deprecationWarning("The `Connection.recoveryKey` attribute has been replaced by the `Connection.createRecoveryKey()` method. Replace your usage of `recoveryKey` with the return value of `createRecoveryKey()`. `recoveryKey` will be removed in a future version."),this.createRecoveryKey()}createRecoveryKey(){return this.connectionManager.createRecoveryKey()}},Qn=class e extends ft{constructor(t){var n,r,i,o;if(super(Me.objectifyOptions(t,!1,"BaseRealtime",S.defaultLogger)),S.logAction(this.logger,S.LOG_MINOR,"Realtime()",""),"string"===typeof EdgeRuntime)throw new E('Ably.Realtime instance cannot be used in Vercel Edge runtime. If you are running Vercel Edge functions, please replace your "new Ably.Realtime()" with "new Ably.Rest()" and use Ably Rest API instead of the Realtime API. If you are server-rendering your application in the Vercel Edge runtime, please use the condition "if (typeof EdgeRuntime === \'string\')" to prevent instantiating Ably.Realtime instance during SSR in the Vercel Edge runtime.',4e4,400);this._additionalTransportImplementations=e.transportImplementationsFromPlugins(this.options.plugins),this._RealtimePresence=null!=(r=null==(n=this.options.plugins)?void 0:n.RealtimePresence)?r:null,this._objectsPlugin=null!=(o=null==(i=this.options.plugins)?void 0:i.Objects)?o:null,this.connection=new Wn(this,this.options),this._channels=new Kn(this),!1!==this.options.autoConnect&&this.connect()}static transportImplementationsFromPlugins(e){const t={};return(null==e?void 0:e.WebSocketTransport)&&(t[Tn.WebSocket]=e.WebSocketTransport),(null==e?void 0:e.XHRPolling)&&(t[Tn.XhrPolling]=e.XHRPolling),t}get channels(){return this._channels}connect(){S.logAction(this.logger,S.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()}close(){S.logAction(this.logger,S.LOG_MINOR,"Realtime.close()",""),this.connection.close()}};Qn.EventEmitter=$e;var $n=Qn,Kn=class extends $e{constructor(e){super(e.logger),this.realtime=e,this.all=Object.create(null),e.connection.connectionManager.on("transport.active",()=>{this.onTransportActive()})}channelSerials(){let e={};for(const t of F(this.all,!0)){const n=this.all[t];n.properties.channelSerial&&(e[t]=n.properties.channelSerial)}return e}recoverChannels(e){for(const t of F(e,!0))this.get(t).properties.channelSerial=e[t]}async processChannelMessage(e){const t=e.channel;if(void 0===t)return void S.logAction(this.logger,S.LOG_ERROR,"Channels.processChannelMessage()","received event unspecified channel, action = "+e.action);const n=this.all[t];n?await n.processMessage(e):S.logAction(this.logger,S.LOG_ERROR,"Channels.processChannelMessage()","received event for non-existent channel: "+t)}onTransportActive(){for(const e in this.all){const t=this.all[e];"attaching"===t.state||"detaching"===t.state?t.checkPendingState():"suspended"===t.state?t._attach(!1,null):"attached"===t.state&&t.requestState("attaching")}}propogateConnectionInterruption(e,t){const n=["attaching","attached","detaching","suspended"],r={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"}[e];for(const i in this.all){const e=this.all[i];n.includes(e.state)&&e.notifyState(r,t)}}get(e,t){e=String(e);let n=this.all[e];if(n){if(t){if(n._shouldReattachToSetOptions(t,n.channelOptions))throw new E("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);n.setOptions(t)}}else n=this.all[e]=new Cn(this.realtime,e,t);return n}getDerived(e,t,n){if(t.filter){const n=pe(t.filter),r=fe(e);e="[filter=".concat(n).concat(r.qualifierParam,"]").concat(r.channelName)}return this.get(e,n)}release(e){e=String(e);const t=this.all[e];if(!t)return;const n=t.getReleaseErr();if(n)throw n;delete this.all[e]}},Jn=$n;function Xn(e,t){if(e.isSynthesized()||t.isSynthesized())return e.timestamp>=t.timestamp;const n=e.parseId(),r=t.parseId();return n.msgSerial===r.msgSerial?n.index>r.index:n.msgSerial>r.msgSerial}var Yn=class extends $e{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Xn;super(e.logger),this.presence=e,this.map=Object.create(null),this.syncInProgress=!1,this.residualMembers=null,this.memberKey=t,this.newerThan=n}get(e){return this.map[e]}getClient(e){const t=this.map,n=[];for(const r in t){const i=t[r];i.clientId==e&&"absent"!=i.action&&n.push(i)}return n}list(e){const t=this.map,n=e&&e.clientId,r=e&&e.connectionId,i=[];for(const o in t){const e=t[o];"absent"!==e.action&&(n&&n!=e.clientId||r&&r!=e.connectionId||i.push(e))}return i}put(e){"enter"!==e.action&&"update"!==e.action||((e=It.fromValues(e)).action="present");const t=this.map,n=this.memberKey(e);this.residualMembers&&delete this.residualMembers[n];const r=t[n];return!(r&&!this.newerThan(e,r))&&(t[n]=e,!0)}values(){const e=this.map,t=[];for(const n in e){const r=e[n];"absent"!=r.action&&t.push(r)}return t}remove(e){const t=this.map,n=this.memberKey(e),r=t[n];return!(r&&!this.newerThan(e,r))&&(this.syncInProgress?((e=It.fromValues(e)).action="absent",t[n]=e):delete t[n],!!r)}startSync(){const e=this.map,t=this.syncInProgress;S.logAction(this.logger,S.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+t),this.syncInProgress||(this.residualMembers=A(e),this.setInProgress(!0))}endSync(){const e=this.map,t=this.syncInProgress;if(S.logAction(this.logger,S.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+t),t){for(const t in e)"absent"===e[t].action&&delete e[t];this.presence._synthesizeLeaves(H(this.residualMembers));for(const t in this.residualMembers)delete e[t];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")}waitSync(e){const t=this.syncInProgress;S.logAction(this.logger,S.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+t),t?this.once("sync",e):e()}clear(){this.map={},this.setInProgress(!1),this.residualMembers=null}setInProgress(e){S.logAction(this.logger,S.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+e),this.syncInProgress=e,this.presence.syncComplete=!e}};function Zn(e){const t=e.channel.client,n=t.auth.clientId;return(!n||"*"===n)&&"connected"===t.connection.state}var er=class extends $e{constructor(e){super(e.logger),this.channel=e,this.syncComplete=!1,this.members=new Yn(this,e=>e.clientId+":"+e.connectionId),this._myMembers=new Yn(this,e=>e.clientId),this.subscriptions=new $e(this.logger),this.pendingPresence=[]}async enter(e){if(Zn(this))throw new E("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,void 0,e,"enter")}async update(e){if(Zn(this))throw new E("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,void 0,e,"update")}async enterClient(e,t){return this._enterOrUpdateClient(void 0,e,t,"enter")}async updateClient(e,t){return this._enterOrUpdateClient(void 0,e,t,"update")}async _enterOrUpdateClient(e,t,n,r){const i=this.channel;if(!i.connectionManager.activeState())throw i.connectionManager.getError();S.logAction(this.logger,S.LOG_MICRO,"RealtimePresence."+r+"Client()","channel = "+i.name+", id = "+e+", client = "+(t||"(implicit) "+this.channel.client.auth.clientId));const o=It.fromData(n);o.action=r,e&&(o.id=e),t&&(o.clientId=t);const s=await o.encode(i.channelOptions);switch(i.state){case"attached":return i.sendPresence([s]);case"initialized":case"detached":i.attach();case"attaching":return new Promise((e,t)=>{this.pendingPresence.push({presence:s,callback:n=>n?t(n):e()})});default:{const e=new T("Unable to "+r+" presence channel while in "+i.state+" state",90001);throw e.code=90001,e}}}async leave(e){if(Zn(this))throw new E("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,e)}async leaveClient(e,t){const n=this.channel;if(!n.connectionManager.activeState())throw n.connectionManager.getError();S.logAction(this.logger,S.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+e);const r=It.fromData(t);r.action="leave",e&&(r.clientId=e);const i=await r.encode(n.channelOptions);switch(n.state){case"attached":return n.sendPresence([i]);case"attaching":return new Promise((e,t)=>{this.pendingPresence.push({presence:i,callback:n=>n?t(n):e()})});case"initialized":case"failed":throw new T("Unable to leave presence channel (incompatible state)",90001);default:throw n.invalidStateError()}}async get(e){const t=!e||!("waitForSync"in e)||e.waitForSync;return new Promise((n,r)=>{function i(t){n(e?t.list(e):t.values())}"suspended"!==this.channel.state?function(e,t,n){switch(e.state){case"attached":case"suspended":n();break;case"initialized":case"detached":case"detaching":case"attaching":re(e.attach(),function(e){e?t(e):n()});break;default:t(E.fromValues(e.invalidStateError()))}}(this.channel,e=>r(e),()=>{const e=this.members;t?e.waitSync(function(){i(e)}):i(e)}):t?r(E.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):i(this.members)})}async history(e){S.logAction(this.logger,S.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name);const t=this.channel.client.rest.presenceMixin;if(e&&e.untilAttach){if("attached"!==this.channel.state)throw new E("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400);delete e.untilAttach,e.from_serial=this.channel.properties.attachSerial}return t.history(this,e)}setPresence(e,t,n){let r,i;S.logAction(this.logger,S.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+e.length+" participants; syncChannelSerial = "+n);const o=this.members,s=this._myMembers,a=[],l=this.channel.connectionManager.connectionId;t&&(this.members.startSync(),n&&(i=n.match(/^[\w-]+:(.*)$/))&&(r=i[1]));for(let c of e)switch(c.action){case"leave":o.remove(c)&&a.push(c),c.connectionId!==l||c.isSynthesized()||s.remove(c);break;case"enter":case"present":case"update":o.put(c)&&a.push(c),c.connectionId===l&&s.put(c)}t&&!r&&(o.endSync(),this.channel.syncChannelSerial=null);for(let c=0;c<a.length;c++){const e=a[c];this.subscriptions.emit(e.action,e)}}onAttached(e){S.logAction(this.logger,S.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+e),e?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear()),this._ensureMyMembersPresent();const t=this.pendingPresence,n=t.length;if(n){this.pendingPresence=[];const e=[],r=Ie.create(this.logger);S.logAction(this.logger,S.LOG_MICRO,"RealtimePresence.onAttached","sending "+n+" queued presence messages");for(let i=0;i<n;i++){const n=t[i];e.push(n.presence),r.push(n.callback)}this.channel.sendPresence(e).then(()=>r()).catch(e=>r(e))}}actOnChannelState(e,t,n){switch(e){case"attached":this.onAttached(t);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(n)}}failPendingPresence(e){if(this.pendingPresence.length){S.logAction(this.logger,S.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+X(e));for(let n=0;n<this.pendingPresence.length;n++)try{this.pendingPresence[n].callback(e)}catch(t){}this.pendingPresence=[]}}_clearMyMembers(){this._myMembers.clear()}_ensureMyMembersPresent(){const e=this._myMembers,t=this.channel.connectionManager.connectionId;for(const n in e.map){const r=e.map[n];S.logAction(this.logger,S.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+r.clientId+'" into the presence set');const i=r.connectionId===t?r.id:void 0;this._enterOrUpdateClient(i,r.clientId,r.data,"enter").catch(e=>{const t=new E("Presence auto re-enter failed",91004,400,e);S.logAction(this.logger,S.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()","Presence auto re-enter failed; reason = "+X(e));const n=new wn(this.channel.state,this.channel.state,!0,!1,t);this.channel.emit("update",n)})}}_synthesizeLeaves(e){const t=this.subscriptions;e.forEach(function(e){const n=It.fromValues({action:"leave",connectionId:e.connectionId,clientId:e.clientId,data:e.data,encoding:e.encoding,timestamp:Date.now()});t.emit("leave",n)})}async subscribe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=Cn.processListenerArgs(t),i=r[0],o=r[1],s=this.channel;if("failed"===s.state)throw E.fromValues(s.invalidStateError());this.subscriptions.on(i,o),!1!==s.channelOptions.attachOnSubscribe&&await s.attach()}unsubscribe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=Cn.processListenerArgs(t),i=r[0],o=r[1];this.subscriptions.off(i,o)}},tr=Tn.WebSocket,nr=class extends Dn{constructor(e,t,n){super(e,t,n),this.shortName=tr,n.heartbeats=y.Config.useProtocolHeartbeats,this.wsHost=n.host}static isAvailable(){return!!y.Config.WebSocket}createWebSocket(e,t){return this.uri=e+$(t),new y.Config.WebSocket(this.uri)}toString(){return"WebSocketTransport; uri="+this.uri}connect(){S.logAction(this.logger,S.LOG_MINOR,"WebSocketTransport.connect()","starting"),Dn.prototype.connect.call(this);const e=this,t=this.params,n=t.options,r=(n.tls?"wss://":"ws://")+this.wsHost+":"+Me.getPort(n)+"/";S.logAction(this.logger,S.LOG_MINOR,"WebSocketTransport.connect()","uri: "+r),re(this.auth.getAuthParams(),function(n,i){if(e.isDisposed)return;let o="";for(const e in i)o+=" "+e+": "+i[e]+";";if(S.logAction(e.logger,S.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+o+" err: "+n),n)return void e.disconnect(n);const s=t.getConnectParams(i);try{const t=e.wsConnection=e.createWebSocket(r,s);t.binaryType=y.Config.binaryType,t.onopen=function(){e.onWsOpen()},t.onclose=function(t){e.onWsClose(t)},t.onmessage=function(t){e.onWsData(t.data)},t.onerror=function(t){e.onWsError(t)},t.on&&t.on("ping",function(){e.onActivity()})}catch(a){S.logAction(e.logger,S.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(a.stack||a.message)),e.disconnect(a)}})}send(e){const t=this.wsConnection;if(t)try{t.send(dn(e,this.connectionManager.realtime._MsgPack,this.params.format))}catch(n){const e="Exception from ws connection when trying to send: "+X(n);S.logAction(this.logger,S.LOG_ERROR,"WebSocketTransport.send()",e),this.finish("disconnected",new E(e,5e4,500))}else S.logAction(this.logger,S.LOG_ERROR,"WebSocketTransport.send()","No socket connection")}onWsData(e){S.logAction(this.logger,S.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+e.length+"; type = "+typeof e);try{this.onProtocolMessage((t=e,n=this.connectionManager.realtime._MsgPack,r=this.connectionManager.realtime._RealtimePresence,i=this.connectionManager.realtime._Annotations,o=this.connectionManager.realtime._objectsPlugin,s=this.format,pn(ie(t,n,s),r,i,o)))}catch(a){S.logAction(this.logger,S.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+a.stack)}var t,n,r,i,o,s}onWsOpen(){S.logAction(this.logger,S.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")}onWsClose(e){let t,n;if("object"==typeof e?(n=e.code,t=e.wasClean||1e3===n):(n=e,t=1e3==n),delete this.wsConnection,t){S.logAction(this.logger,S.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");const e=new E("Websocket closed",80003,400);this.finish("disconnected",e)}else{const e="Unclean disconnection of WebSocket ; code = "+n,t=new E(e,80003,400);S.logAction(this.logger,S.LOG_MINOR,"WebSocketTransport.onWsClose()",e),this.finish("disconnected",t)}this.emit("disposed")}onWsError(e){S.logAction(this.logger,S.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+e.message),y.Config.nextTick(()=>{this.disconnect(Error(e.message))})}dispose(){S.logAction(this.logger,S.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;const e=this.wsConnection;e&&(e.onmessage=function(){},delete this.wsConnection,y.Config.nextTick(()=>{if(S.logAction(this.logger,S.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!e)throw new Error("WebSocketTransport.dispose(): wsConnection is not defined");e.close()}))}},rr=class{static subscribeFilter(e,t,n){const r=e=>{var r,i,o,s,a,l;const c={name:e.name,refTimeserial:null==(i=null==(r=e.extras)?void 0:r.ref)?void 0:i.timeserial,refType:null==(s=null==(o=e.extras)?void 0:o.ref)?void 0:s.type,isRef:!!(null==(l=null==(a=e.extras)?void 0:a.ref)?void 0:l.timeserial),clientId:e.clientId};Object.entries(t).find(e=>{let[t,n]=e;return void 0!==n&&c[t]!==n})||n(e)};this.addFilteredSubscription(e,t,n,r),e.subscriptions.on(r)}static addFilteredSubscription(e,t,n,r){var i;if(e.filteredSubscriptions||(e.filteredSubscriptions=new Map),e.filteredSubscriptions.has(n)){const o=e.filteredSubscriptions.get(n);o.set(t,(null==(i=null==o?void 0:o.get(t))?void 0:i.concat(r))||[r])}else e.filteredSubscriptions.set(n,new Map([[t,[r]]]))}static getAndDeleteFilteredSubscriptions(e,t,n){if(!e.filteredSubscriptions)return[];if(!n&&t)return Array.from(e.filteredSubscriptions.entries()).map(n=>{let[r,i]=n;var o;let s=i.get(t);return i.delete(t),0===i.size&&(null==(o=e.filteredSubscriptions)||o.delete(r)),s}).reduce((e,t)=>t?e.concat(...t):e,[]);if(!n||!e.filteredSubscriptions.has(n))return[];const r=e.filteredSubscriptions.get(n);if(!t){const t=Array.from(r.values()).reduce((e,t)=>e.concat(...t),[]);return e.filteredSubscriptions.delete(n),t}let i=r.get(t);return r.delete(t),i||[]}},ir=class e extends Jn{constructor(t){var n;const r=e._MsgPack;if(!r)throw new Error("Expected DefaultRealtime._MsgPack to have been set");super(Me.objectifyOptions(t,!0,"Realtime",S.defaultLogger,p(f({},Xt),{Crypto:null!=(n=e.Crypto)?n:void 0,MsgPack:r,RealtimePresence:{RealtimePresence:er,PresenceMessage:It,WirePresenceMessage:Mt},Annotations:{Annotation:sn,WireAnnotation:on,RealtimeAnnotations:On,RestAnnotations:hn},WebSocketTransport:nr,MessageInteractions:rr})))}static get Crypto(){if(null===this._Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");return this._Crypto}static set Crypto(e){this._Crypto=e}};ir.Utils=C,ir.ConnectionManager=Vn,ir.ProtocolMessage=bn,ir._Crypto=null,ir.Message=Yt,ir.PresenceMessage=Zt,ir.Annotation=an,ir._MsgPack=null,ir._Http=We,ir._PresenceMap=Yn,ir._MessageEncoding=lt;var or=ir,sr=Uint8Array,ar=Uint32Array,lr=Math.pow,cr=new ar(8),ur=[],hr=new ar(64);function dr(e){return(e-(0|e))*lr(2,32)|0}for(var fr,pr,gr=2,mr=0;mr<64;){for(fr=!0,pr=2;pr<=gr/2;pr++)gr%pr===0&&(fr=!1);fr&&(mr<8&&(cr[mr]=dr(lr(gr,.5))),ur[mr]=dr(lr(gr,1/3)),mr++),gr++}var yr=!!new sr(new ar([1]).buffer)[0];function vr(e){return yr?e>>>24|(e>>>16&255)<<8|(65280&e)<<8|e<<24:e}function br(e,t){return e>>>t|e<<32-t}function wr(e){var t,n=cr.slice(),r=e.length,i=8*r,o=512-(i+64)%512-1+i+65,s=new sr(o/8),a=new ar(s.buffer);s.set(e,0),s[r]=128,a[a.length-1]=vr(i);for(var l=0;l<o/32;l+=16){var c=n.slice();for(t=0;t<64;t++){var u;if(t<16)u=vr(a[l+t]);else{var h=hr[t-15],d=hr[t-2];u=hr[t-7]+hr[t-16]+(br(h,7)^br(h,18)^h>>>3)+(br(d,17)^br(d,19)^d>>>10)}hr[t]=u|=0;for(var f=(br(c[4],6)^br(c[4],11)^br(c[4],25))+(c[4]&c[5]^~c[4]&c[6])+c[7]+u+ur[t],p=(br(c[0],2)^br(c[0],13)^br(c[0],22))+(c[0]&c[1]^c[2]&(c[0]^c[1])),g=7;g>0;g--)c[g]=c[g-1];c[0]=f+p|0,c[4]=c[4]+f|0}for(t=0;t<8;t++)n[t]=n[t]+c[t]|0}return new sr(new ar(n.map(function(e){return vr(e)})).buffer)}var kr,Sr=new class{constructor(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}uint8ViewToBase64(e){let t="";const n=this.base64CharSet,r=e.byteLength,i=r%3,o=r-i;let s,a,l,c,u;for(let h=0;h<o;h+=3)u=e[h]<<16|e[h+1]<<8|e[h+2],s=(16515072&u)>>18,a=(258048&u)>>12,l=(4032&u)>>6,c=63&u,t+=n[s]+n[a]+n[l]+n[c];return 1==i?(u=e[o],s=(252&u)>>2,a=(3&u)<<4,t+=n[s]+n[a]+"=="):2==i&&(u=e[o]<<8|e[o+1],s=(64512&u)>>10,a=(1008&u)>>4,l=(15&u)<<2,t+=n[s]+n[a]+n[l]+"="),t}base64ToArrayBuffer(e){const t=null==atob?void 0:atob(e),n=t.length,r=new Uint8Array(n);for(let i=0;i<n;i++){const e=t.charCodeAt(i);r[i]=e}return this.toArrayBuffer(r)}isBuffer(e){return e instanceof ArrayBuffer||ArrayBuffer.isView(e)}toBuffer(e){if(!ArrayBuffer)throw new Error("Can't convert to Buffer: browser does not support the necessary types");if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(this.toArrayBuffer(e));throw new Error("BufferUtils.toBuffer expected an ArrayBuffer or a view onto one")}toArrayBuffer(e){if(!ArrayBuffer)throw new Error("Can't convert to ArrayBuffer: browser does not support the necessary types");if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);throw new Error("BufferUtils.toArrayBuffer expected an ArrayBuffer or a view onto one")}base64Encode(e){return this.uint8ViewToBase64(this.toBuffer(e))}base64UrlEncode(e){return this.base64Encode(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}base64Decode(e){if(ArrayBuffer&&y.Config.atob)return this.base64ToArrayBuffer(e);throw new Error("Expected ArrayBuffer to exist and Platform.Config.atob to be configured")}hexEncode(e){return this.toBuffer(e).reduce((e,t)=>e+t.toString(16).padStart(2,"0"),"")}hexDecode(e){if(e.length%2!==0)throw new Error("Can't create a byte array from a hex string of odd length");const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++)t[n]=parseInt(e.slice(2*n,2*(n+1)),16);return this.toArrayBuffer(t)}utf8Encode(e){if(y.Config.TextEncoder){const t=(new y.Config.TextEncoder).encode(e);return this.toArrayBuffer(t)}throw new Error("Expected TextEncoder to be configured")}utf8Decode(e){if(!this.isBuffer(e))throw new Error("Expected input of utf8decode to be an arraybuffer or typed array");if(TextDecoder)return(new TextDecoder).decode(e);throw new Error("Expected TextDecoder to be configured")}areBuffersEqual(e,t){if(!e||!t)return!1;const n=this.toArrayBuffer(e),r=this.toArrayBuffer(t);if(n.byteLength!=r.byteLength)return!1;const i=new Uint8Array(n),o=new Uint8Array(r);for(var s=0;s<i.length;s++)if(i[s]!=o[s])return!1;return!0}byteLength(e){return e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}arrayBufferViewToBuffer(e){return this.toArrayBuffer(e)}concat(e){const t=e.reduce((e,t)=>e+t.byteLength,0),n=new Uint8Array(t);let r=0;for(const i of e){const e=this.toBuffer(i);n.set(e,r),r+=e.byteLength}return n.buffer}sha256(e){const t=wr(this.toBuffer(e));return this.toArrayBuffer(t)}hmacSha256(e,t){const n=function(e,t){if(e.length>64&&(e=wr(e)),e.length<64){const t=new Uint8Array(64);t.set(e,0),e=t}for(var n=new Uint8Array(64),r=new Uint8Array(64),i=0;i<64;i++)n[i]=54^e[i],r[i]=92^e[i];var o=new Uint8Array(t.length+64);o.set(n,0),o.set(t,64);var s=new Uint8Array(96);return s.set(r,0),s.set(wr(o),64),wr(s)}(this.toBuffer(t),this.toBuffer(e));return this.toArrayBuffer(n)}},Cr=(e=>(e[e.REQ_SEND=0]="REQ_SEND",e[e.REQ_RECV=1]="REQ_RECV",e[e.REQ_RECV_POLL=2]="REQ_RECV_POLL",e[e.REQ_RECV_STREAM=3]="REQ_RECV_STREAM",e))(Cr||{}),Or=Cr;function Er(){return new E("No HTTP request plugin provided. Provide at least one of the FetchRequest or XHRRequest plugins.",400,4e4)}var Tr=((kr=class{constructor(e){var t;this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1,this.client=null!=e?e:null;const n=(null==e?void 0:e.options.connectivityCheckUrl)||Me.connectivityCheckUrl,r=null!=(t=null==e?void 0:e.options.connectivityCheckParams)?t:null,i=!(null==e?void 0:e.options.connectivityCheckUrl),o=f(f({},Tr.bundledRequestImplementations),null==e?void 0:e._additionalHTTPRequestImplementations),s=o.XHRRequest,a=o.FetchRequest,l=!(!s&&!a);if(!l)throw Er();y.Config.xhrSupported&&s?(this.supportsAuthHeaders=!0,this.Request=async function(t,n,r,i,o){return new Promise(a=>{var l;const c=s.createRequest(n,r,i,o,Or.REQ_SEND,null!=(l=e&&e.options.timeouts)?l:null,this.logger,t);c.once("complete",(e,t,n,r,i)=>a({error:e,body:t,headers:n,unpacked:r,statusCode:i})),c.exec()})},(null==e?void 0:e.options.disableConnectivityCheck)?this.checkConnectivity=async function(){return!0}:this.checkConnectivity=async function(){var e;S.logAction(this.logger,S.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+n);const t=await this.doUri(Ne.Get,n,null,null,r);let o=!1;var s;return o=i?!t.error&&"yes"==(null==(e=t.body)?void 0:e.replace(/\n/,"")):!t.error&&(s=t.statusCode)>=200&&s<400,S.logAction(this.logger,S.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+o),o}):y.Config.fetchSupported&&a?(this.supportsAuthHeaders=!0,this.Request=async(t,n,r,i,o)=>a(t,null!=e?e:null,n,r,i,o),(null==e?void 0:e.options.disableConnectivityCheck)?this.checkConnectivity=async function(){return!0}:this.checkConnectivity=async function(){var e;S.logAction(this.logger,S.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Sending; "+n);const t=await this.doUri(Ne.Get,n,null,null,null),r=!t.error&&"yes"==(null==(e=t.body)?void 0:e.replace(/\n/,""));return S.logAction(this.logger,S.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Result: "+r),r}):this.Request=async()=>({error:l?new T("no supported HTTP transports available",null,400):Er()})}get logger(){var e,t;return null!=(t=null==(e=this.client)?void 0:e.logger)?t:S.defaultLogger}async doUri(e,t,n,r,i){return this.Request?this.Request(e,t,n,i,r):{error:new T("Request invoked before assigned to",null,500)}}shouldFallback(e){const t=e.statusCode;return 408===t&&!e.code||400===t&&!e.code||t>=500&&t<=504}}).methods=[Ne.Get,Ne.Delete,Ne.Post,Ne.Put,Ne.Patch],kr.methodsWithoutBody=[Ne.Get,Ne.Delete],kr.methodsWithBody=[Ne.Post,Ne.Put,Ne.Patch],kr),Rr=Tr,Ar="ablyjs-storage-test",_r="undefined"!==typeof n.g?n.g:"undefined"!==typeof window?window:self,Pr=new class{constructor(){try{_r.sessionStorage.setItem(Ar,Ar),_r.sessionStorage.removeItem(Ar),this.sessionSupported=!0}catch(e){this.sessionSupported=!1}try{_r.localStorage.setItem(Ar,Ar),_r.localStorage.removeItem(Ar),this.localSupported=!0}catch(e){this.localSupported=!1}}get(e){return this._get(e,!1)}getSession(e){return this._get(e,!0)}remove(e){return this._remove(e,!1)}removeSession(e){return this._remove(e,!0)}set(e,t,n){return this._set(e,t,n,!1)}setSession(e,t,n){return this._set(e,t,n,!0)}_set(e,t,n,r){const i={value:t};return n&&(i.expires=Date.now()+n),this.storageInterface(r).setItem(e,JSON.stringify(i))}_get(e,t){if(t&&!this.sessionSupported)throw new Error("Session Storage not supported");if(!t&&!this.localSupported)throw new Error("Local Storage not supported");const n=this.storageInterface(t).getItem(e);if(!n)return null;const r=JSON.parse(n);return r.expires&&r.expires<Date.now()?(this.storageInterface(t).removeItem(e),null):r.value}_remove(e,t){return this.storageInterface(t).removeItem(e)}storageInterface(e){return e?_r.sessionStorage:_r.localStorage}},Mr=he(),Ir="string"===typeof EdgeRuntime;"undefined"!==typeof Window||"undefined"!==typeof WorkerGlobalScope||Ir||console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");var xr={agent:"browser",logTimestamps:!0,userAgent:Mr.navigator&&Mr.navigator.userAgent.toString(),currentUrl:Mr.location&&Mr.location.href,binaryType:"arraybuffer",WebSocket:Mr.WebSocket,fetchSupported:!!Mr.fetch,xhrSupported:Mr.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,allowComet:function(){const e=Mr.location;return!Mr.WebSocket||!e||!e.origin||e.origin.indexOf("http")>-1}(),useProtocolHeartbeats:!0,supportsBinary:!!Mr.TextDecoder,preferBinary:!1,ArrayBuffer:Mr.ArrayBuffer,atob:Mr.atob,nextTick:"function"===typeof Mr.queueMicrotask?e=>Mr.queueMicrotask(e):e=>Promise.resolve().then(e),addEventListener:Mr.addEventListener,inspect:JSON.stringify,stringByteSize:function(e){return Mr.TextDecoder&&(new Mr.TextEncoder).encode(e).length||e.length},TextEncoder:Mr.TextEncoder,TextDecoder:Mr.TextDecoder,getRandomArrayBuffer:async function(e){const t=new Uint8Array(e);return Mr.crypto.getRandomValues(t),t.buffer},isWebworker:"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,push:{platform:"browser",formFactor:"desktop",storage:Pr}};function Nr(e){return function(e){const t=[80015,80017,80030];return!!e.code&&!He.isTokenErr(e)&&(!!t.includes(e.code)||e.code>=4e4&&e.code<5e4)}(e)?[mn({action:Ke.ERROR,error:e})]:[mn({action:Ke.DISCONNECTED,error:e})]}var Lr=class extends Dn{constructor(e,t,n){super(e,t,n,!0),this.onAuthUpdated=e=>{this.authParams={access_token:e.token}},this.stream=!("stream"in n)||n.stream,this.sendRequest=null,this.recvRequest=null,this.pendingCallback=null,this.pendingItems=null}connect(){S.logAction(this.logger,S.LOG_MINOR,"CometTransport.connect()","starting"),Dn.prototype.connect.call(this);const e=this.params,t=e.options,n=e.host||t.primaryDomain,r=Me.getPort(t),i=t.tls?"https://":"http://";this.baseUri=i+n+":"+r+"/comet/";const o=this.baseUri+"connect";S.logAction(this.logger,S.LOG_MINOR,"CometTransport.connect()","uri: "+o),re(this.auth.getAuthParams(),(e,t)=>{if(e)return void this.disconnect(e);if(this.isDisposed)return;this.authParams=t;const n=this.params.getConnectParams(t);"stream"in n&&(this.stream=n.stream),S.logAction(this.logger,S.LOG_MINOR,"CometTransport.connect()","connectParams:"+$(n));let r=!1;const i=this.recvRequest=this.createRequest(o,null,n,null,this.stream?Or.REQ_RECV_STREAM:Or.REQ_RECV);i.on("data",e=>{this.recvRequest&&(r||(r=!0,this.emit("preconnect")),this.onData(e))}),i.on("complete",e=>{this.recvRequest||(e=e||new E("Request cancelled",80003,400)),this.recvRequest=null,r||e||(r=!0,this.emit("preconnect")),this.onActivity(),e?e.code?this.onData(Nr(e)):this.disconnect(e):y.Config.nextTick(()=>{this.recv()})}),i.exec()})}requestClose(){S.logAction(this.logger,S.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)}requestDisconnect(){S.logAction(this.logger,S.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)}_requestCloseOrDisconnect(e){const t=e?this.closeUri:this.disconnectUri;if(t){const n=this.createRequest(t,null,this.authParams,null,Or.REQ_SEND);n.on("complete",t=>{t&&(S.logAction(this.logger,S.LOG_ERROR,"CometTransport.request"+(e?"Close()":"Disconnect()"),"request returned err = "+X(t)),this.finish("disconnected",t))}),n.exec()}}dispose(){S.logAction(this.logger,S.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(S.logAction(this.logger,S.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",Nn.disconnected()),y.Config.nextTick(()=>{this.emit("disposed")}))}onConnect(e){var t;if(this.isDisposed)return;const n=null==(t=e.connectionDetails)?void 0:t.connectionKey;Dn.prototype.onConnect.call(this,e);const r=this.baseUri+n;S.logAction(this.logger,S.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+r),this.sendUri=r+"/send",this.recvUri=r+"/recv",this.closeUri=r+"/close",this.disconnectUri=r+"/disconnect"}send(e){if(this.sendRequest)return this.pendingItems=this.pendingItems||[],void this.pendingItems.push(e);const t=this.pendingItems||[];t.push(e),this.pendingItems=null,this.sendItems(t)}sendAnyPending(){const e=this.pendingItems;e&&(this.pendingItems=null,this.sendItems(e))}sendItems(e){const t=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(e),Or.REQ_SEND);t.on("complete",(e,t)=>{e&&S.logAction(this.logger,S.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+X(e)),this.sendRequest=null,e?e.code?this.onData(Nr(e)):this.disconnect(e):(t&&this.onData(t),this.pendingItems&&y.Config.nextTick(()=>{this.sendRequest||this.sendAnyPending()}))}),t.exec()}recv(){if(this.recvRequest)return;if(!this.isConnected)return;const e=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?Or.REQ_RECV_STREAM:Or.REQ_RECV_POLL);e.on("data",e=>{this.onData(e)}),e.on("complete",e=>{this.recvRequest=null,this.onActivity(),e?e.code?this.onData(Nr(e)):this.disconnect(e):y.Config.nextTick(()=>{this.recv()})}),e.exec()}onData(e){try{const t=this.decodeResponse(e);if(t&&t.length)for(let e=0;e<t.length;e++)this.onProtocolMessage(pn(t[e],this.connectionManager.realtime._RealtimePresence,this.connectionManager.realtime._Annotations,this.connectionManager.realtime._objectsPlugin))}catch(t){S.logAction(this.logger,S.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+t.stack)}}encodeRequest(e){return JSON.stringify(e)}decodeResponse(e){return"string"==typeof e?JSON.parse(e):e}};function Ur(e,t){if(function(e,t){return se(F(t)).includes("x-ably-errorcode")}(0,t))return e.error&&E.fromValues(e.error)}var Dr=function(){},zr=0,jr={},Br=class e extends $e{constructor(e,t,n,r,i,o,s,a){super(s),(n=n||{}).rnd=ee(),this.uri=e+$(n),this.headers=t||{},this.body=r,this.method=a?a.toUpperCase():I(r)?"GET":"POST",this.requestMode=i,this.timeouts=o,this.timedOut=!1,this.requestComplete=!1,this.id=String(++zr),jr[this.id]=this}static createRequest(t,n,r,i,o,s,a,l){const c=s||Me.TIMEOUTS;return new e(t,n,A(r),i,o,c,a,l)}complete(e,t,n,r,i){this.requestComplete||(this.requestComplete=!0,!e&&t&&this.emit("data",t),this.emit("complete",e,t,n,r,i),this.dispose())}abort(){this.dispose()}exec(){let e=this.headers;const t=this.requestMode==Or.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,n=this.timer=setTimeout(()=>{this.timedOut=!0,i.abort()},t),r=this.method,i=this.xhr=new XMLHttpRequest,o=e.accept;let s=this.body,a="text";o?0===o.indexOf("application/x-msgpack")&&(a="arraybuffer"):e.accept="application/json",s&&(e["content-type"]||(e["content-type"]="application/json")).indexOf("application/json")>-1&&"string"!=typeof s&&(s=JSON.stringify(s)),i.open(r,this.uri,!0),i.responseType=a,"authorization"in e&&(i.withCredentials=!0);for(const y in e)i.setRequestHeader(y,e[y]);const l=(e,t,n,r)=>{var i;let o=t+" (event type: "+e.type+")";(null==(i=null==this?void 0:this.xhr)?void 0:i.statusText)&&(o+=", current statusText is "+this.xhr.statusText),S.logAction(this.logger,S.LOG_ERROR,"Request.on"+e.type+"()",o),this.complete(new T(o,n,r))};let c,u,h;i.onerror=e=>{l(e,"XHR error occurred",null,400)},i.onabort=e=>{this.timedOut?l(e,"Request aborted due to request timeout expiring",null,408):l(e,"Request cancelled",null,400)},i.ontimeout=e=>{l(e,"Request timed out",null,408)};let d=0,f=!1;const p=()=>{clearTimeout(n),h=u<400,204!=u?c=this.requestMode==Or.REQ_RECV_STREAM&&h&&function(e){return e.getResponseHeader&&(e.getResponseHeader("transfer-encoding")||!e.getResponseHeader("content-length"))}(i):this.complete(null,null,null,null,u)},g=()=>{let t;try{const n=function(e,t){return e.getResponseHeader&&e.getResponseHeader(t)}(i,"content-type");if(n?n.indexOf("application/json")>=0:"text"==i.responseType){const e="arraybuffer"===i.responseType?y.BufferUtils.utf8Decode(i.response):String(i.responseText);t=e.length?JSON.parse(e):e,f=!0}else t=i.response;void 0!==t.response?(u=t.statusCode,h=u<400,e=t.headers,t=t.response):e=function(e){const t=e.getAllResponseHeaders().trim().split("\r\n"),n={};for(let r=0;r<t.length;r++){const e=t[r].split(":").map(e=>e.trim());n[e[0].toLowerCase()]=e[1]}return n}(i)}catch(r){return void this.complete(new T("Malformed response body from server: "+r.message,null,400))}if(h||Array.isArray(t))return void this.complete(null,t,e,f,u);let n=Ur(t,e);n||(n=new T("Error response received from server: "+u+" body was: "+y.Config.inspect(t),null,u)),this.complete(n,t,e,f,u)};function m(){const e=i.responseText,t=e.length-1;let n,r;for(;d<t&&(n=e.indexOf("\n",d))>-1;)r=e.slice(d,n),d=n+1,v(r)}const v=e=>{try{e=JSON.parse(e)}catch(t){return void this.complete(new T("Malformed response body from server: "+t.message,null,400))}this.emit("data",e)},b=()=>{m(),this.streamComplete=!0,y.Config.nextTick(()=>{this.complete()})};i.onreadystatechange=()=>{const e=i.readyState;e<3||0!==i.status&&(void 0===u&&(u=i.status,p()),3==e&&c?m():4==e&&(c?b():g()))},i.send(s)}dispose(){const e=this.xhr;if(e){e.onreadystatechange=e.onerror=e.onabort=e.ontimeout=Dr,this.xhr=null;const t=this.timer;t&&(clearTimeout(t),this.timer=null),this.requestComplete||e.abort()}delete jr[this.id]}},Gr=Tn.XhrPolling,Fr={order:["xhr_polling"],bundledImplementations:{web_socket:nr,xhr_polling:class extends Lr{constructor(e,t,n){super(e,t,n),this.shortName=Gr,n.stream=!1,this.shortName=Gr}static isAvailable(){return!(!y.Config.xhrSupported||!y.Config.allowComet)}toString(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected}createRequest(e,t,n,r,i){return Br.createRequest(e,t,n,r,i,this.timeouts,this.logger)}}}},Hr={connectivityCheckUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",wsConnectivityCheckUrl:"wss://ws-up.ably-realtime.com",defaultTransports:[Tn.XhrPolling,Tn.WebSocket]};function qr(e,t,n){for(let r=0,i=n.length;r<i;r++){const i=n.charCodeAt(r);if(i<128)e.setUint8(t++,i>>>0&127);else if(i<2048)e.setUint8(t++,i>>>6&31|192),e.setUint8(t++,i>>>0&63|128);else if(i<65536)e.setUint8(t++,i>>>12&15|224),e.setUint8(t++,i>>>6&63|128),e.setUint8(t++,i>>>0&63|128);else{if(!(i<1114112))throw new Error("bad codepoint "+i);e.setUint8(t++,i>>>18&7|240),e.setUint8(t++,i>>>12&63|128),e.setUint8(t++,i>>>6&63|128),e.setUint8(t++,i>>>0&63|128)}}}function Vr(e,t,n){let r="";for(let i=t,o=t+n;i<o;i++){const t=e.getUint8(i);if(0!==(128&t))if(192!==(224&t))if(224!==(240&t)){if(240!==(248&t))throw new Error("Invalid byte "+t.toString(16));r+=String.fromCharCode((7&t)<<18|(63&e.getUint8(++i))<<12|(63&e.getUint8(++i))<<6|63&e.getUint8(++i))}else r+=String.fromCharCode((15&t)<<12|(63&e.getUint8(++i))<<6|63&e.getUint8(++i));else r+=String.fromCharCode((15&t)<<6|63&e.getUint8(++i));else r+=String.fromCharCode(t)}return r}function Wr(e){let t=0;for(let n=0,r=e.length;n<r;n++){const r=e.charCodeAt(n);if(r<128)t+=1;else if(r<2048)t+=2;else if(r<65536)t+=3;else{if(!(r<1114112))throw new Error("bad codepoint "+r);t+=4}}return t}var Qr=4294967296,$r=1/Qr,Kr=class{constructor(e,t){this.map=e=>{const t={};for(let n=0;n<e;n++)t[this.parse()]=this.parse();return t},this.bin=e=>{const t=new ArrayBuffer(e);return new Uint8Array(t).set(new Uint8Array(this.view.buffer,this.offset,e),0),this.offset+=e,t},this.buf=this.bin,this.str=e=>{const t=Vr(this.view,this.offset,e);return this.offset+=e,t},this.array=e=>{const t=new Array(e);for(let n=0;n<e;n++)t[n]=this.parse();return t},this.ext=e=>(this.offset+=e,{type:this.view.getInt8(this.offset),data:this.buf(e)}),this.parse=()=>{const e=this.view.getUint8(this.offset);let t,n;if(0===(128&e))return this.offset++,e;if(128===(240&e))return n=15&e,this.offset++,this.map(n);if(144===(240&e))return n=15&e,this.offset++,this.array(n);if(160===(224&e))return n=31&e,this.offset++,this.str(n);if(224===(224&e))return t=this.view.getInt8(this.offset),this.offset++,t;switch(e){case 192:return this.offset++,null;case 193:return void this.offset++;case 194:return this.offset++,!1;case 195:return this.offset++,!0;case 196:return n=this.view.getUint8(this.offset+1),this.offset+=2,this.bin(n);case 197:return n=this.view.getUint16(this.offset+1),this.offset+=3,this.bin(n);case 198:return n=this.view.getUint32(this.offset+1),this.offset+=5,this.bin(n);case 199:return n=this.view.getUint8(this.offset+1),this.offset+=2,this.ext(n);case 200:return n=this.view.getUint16(this.offset+1),this.offset+=3,this.ext(n);case 201:return n=this.view.getUint32(this.offset+1),this.offset+=5,this.ext(n);case 202:return t=this.view.getFloat32(this.offset+1),this.offset+=5,t;case 203:return t=this.view.getFloat64(this.offset+1),this.offset+=9,t;case 204:return t=this.view.getUint8(this.offset+1),this.offset+=2,t;case 205:return t=this.view.getUint16(this.offset+1),this.offset+=3,t;case 206:return t=this.view.getUint32(this.offset+1),this.offset+=5,t;case 207:return t=function(e,t){return t=t||0,e.getUint32(t)*Qr+e.getUint32(t+4)}(this.view,this.offset+1),this.offset+=9,t;case 208:return t=this.view.getInt8(this.offset+1),this.offset+=2,t;case 209:return t=this.view.getInt16(this.offset+1),this.offset+=3,t;case 210:return t=this.view.getInt32(this.offset+1),this.offset+=5,t;case 211:return t=function(e,t){return t=t||0,e.getInt32(t)*Qr+e.getUint32(t+4)}(this.view,this.offset+1),this.offset+=9,t;case 212:return n=1,this.offset++,this.ext(n);case 213:return n=2,this.offset++,this.ext(n);case 214:return n=4,this.offset++,this.ext(n);case 215:return n=8,this.offset++,this.ext(n);case 216:return n=16,this.offset++,this.ext(n);case 217:return n=this.view.getUint8(this.offset+1),this.offset+=2,this.str(n);case 218:return n=this.view.getUint16(this.offset+1),this.offset+=3,this.str(n);case 219:return n=this.view.getUint32(this.offset+1),this.offset+=5,this.str(n);case 220:return n=this.view.getUint16(this.offset+1),this.offset+=3,this.array(n);case 221:return n=this.view.getUint32(this.offset+1),this.offset+=5,this.array(n);case 222:return n=this.view.getUint16(this.offset+1),this.offset+=3,this.map(n);case 223:return n=this.view.getUint32(this.offset+1),this.offset+=5,this.map(n)}throw new Error("Unknown type 0x"+e.toString(16))},this.offset=t||0,this.view=e}};function Jr(e,t){return Object.keys(e).filter(function(n){const r=e[n];return(!t||void 0!==r&&null!==r)&&("function"!==typeof r||!!r.toJSON)})}function Xr(e,t,n,r){const i=typeof e;if("string"===typeof e){const r=Wr(e);if(r<32)return t.setUint8(n,160|r),qr(t,n+1,e),1+r;if(r<256)return t.setUint8(n,217),t.setUint8(n+1,r),qr(t,n+2,e),2+r;if(r<65536)return t.setUint8(n,218),t.setUint16(n+1,r),qr(t,n+3,e),3+r;if(r<4294967296)return t.setUint8(n,219),t.setUint32(n+1,r),qr(t,n+5,e),5+r}if(ArrayBuffer.isView&&ArrayBuffer.isView(e)&&(e=e.buffer),e instanceof ArrayBuffer){const r=e.byteLength;if(r<256)return t.setUint8(n,196),t.setUint8(n+1,r),new Uint8Array(t.buffer).set(new Uint8Array(e),n+2),2+r;if(r<65536)return t.setUint8(n,197),t.setUint16(n+1,r),new Uint8Array(t.buffer).set(new Uint8Array(e),n+3),3+r;if(r<4294967296)return t.setUint8(n,198),t.setUint32(n+1,r),new Uint8Array(t.buffer).set(new Uint8Array(e),n+5),5+r}if("number"===typeof e){if(Math.floor(e)!==e)return t.setUint8(n,203),t.setFloat64(n+1,e),9;if(e>=0){if(e<128)return t.setUint8(n,e),1;if(e<256)return t.setUint8(n,204),t.setUint8(n+1,e),2;if(e<65536)return t.setUint8(n,205),t.setUint16(n+1,e),3;if(e<4294967296)return t.setUint8(n,206),t.setUint32(n+1,e),5;if(e<0x10000000000000000)return t.setUint8(n,207),function(e,t,n){n<0x10000000000000000?(e.setUint32(t,Math.floor(n*$r)),e.setInt32(t+4,-1&n)):(e.setUint32(t,4294967295),e.setUint32(t+4,4294967295))}(t,n+1,e),9;throw new Error("Number too big 0x"+e.toString(16))}if(e>=-32)return t.setInt8(n,e),1;if(e>=-128)return t.setUint8(n,208),t.setInt8(n+1,e),2;if(e>=-32768)return t.setUint8(n,209),t.setInt16(n+1,e),3;if(e>=-2147483648)return t.setUint8(n,210),t.setInt32(n+1,e),5;if(e>=-0x8000000000000000)return t.setUint8(n,211),function(e,t,n){n<0x8000000000000000?(e.setInt32(t,Math.floor(n*$r)),e.setInt32(t+4,-1&n)):(e.setUint32(t,2147483647),e.setUint32(t+4,2147483647))}(t,n+1,e),9;throw new Error("Number too small -0x"+(-e).toString(16).substr(1))}if("undefined"===i)return r?0:(t.setUint8(n,212),t.setUint8(n+1,0),t.setUint8(n+2,0),3);if(null===e)return r?0:(t.setUint8(n,192),1);if("boolean"===i)return t.setUint8(n,e?195:194),1;if("function"===typeof e.toJSON)return Xr(e.toJSON(),t,n,r);if("object"===i){let i,o,s=0;const a=Array.isArray(e);if(a?i=e.length:(o=Jr(e,r),i=o.length),i<16?(t.setUint8(n,i|(a?144:128)),s=1):i<65536?(t.setUint8(n,a?220:222),t.setUint16(n+1,i),s=3):i<4294967296&&(t.setUint8(n,a?221:223),t.setUint32(n+1,i),s=5),a)for(let l=0;l<i;l++)s+=Xr(e[l],t,n+s,r);else if(o)for(let l=0;l<i;l++){const i=o[l];s+=Xr(i,t,n+s),s+=Xr(e[i],t,n+s,r)}return s}if("function"===i)return 0;throw new Error("Unknown type "+i)}function Yr(e,t){const n=typeof e;if("string"===n){const t=Wr(e);if(t<32)return 1+t;if(t<256)return 2+t;if(t<65536)return 3+t;if(t<4294967296)return 5+t}if(ArrayBuffer.isView&&ArrayBuffer.isView(e)&&(e=e.buffer),e instanceof ArrayBuffer){const t=e.byteLength;if(t<256)return 2+t;if(t<65536)return 3+t;if(t<4294967296)return 5+t}if("number"===typeof e){if(Math.floor(e)!==e)return 9;if(e>=0){if(e<128)return 1;if(e<256)return 2;if(e<65536)return 3;if(e<4294967296)return 5;if(e<0x10000000000000000)return 9;throw new Error("Number too big 0x"+e.toString(16))}if(e>=-32)return 1;if(e>=-128)return 2;if(e>=-32768)return 3;if(e>=-2147483648)return 5;if(e>=-0x8000000000000000)return 9;throw new Error("Number too small -0x"+e.toString(16).substr(1))}if("boolean"===n)return 1;if(null===e)return t?0:1;if(void 0===e)return t?0:3;if("function"===typeof e.toJSON)return Yr(e.toJSON(),t);if("object"===n){let n,r=0;if(Array.isArray(e)){n=e.length;for(let i=0;i<n;i++)r+=Yr(e[i],t)}else{const i=Jr(e,t);n=i.length;for(let o=0;o<n;o++){const n=i[o];r+=Yr(n)+Yr(e[n],t)}}if(n<16)return 1+r;if(n<65536)return 3+r;if(n<4294967296)return 5+r;throw new Error("Array or object too long 0x"+n.toString(16))}if("function"===n)return 0;throw new Error("Unknown type "+n)}var Zr,ei={encode:function(e,t){const n=Yr(e,t);if(0===n)return;const r=new ArrayBuffer(n);return Xr(e,new DataView(r),0,t),r},decode:function(e){const t=new DataView(e),n=new Kr(t),r=n.parse();if(n.offset!==e.byteLength)throw new Error(e.byteLength-n.offset+" trailing bytes");return r},inspect:function(e){if(void 0===e)return"undefined";let t,n;if(e instanceof ArrayBuffer?(n="ArrayBuffer",t=new DataView(e)):e instanceof DataView&&(n="DataView",t=e),!t)return JSON.stringify(e);const r=[];for(let i=0;i<e.byteLength;i++){if(i>20){r.push("...");break}let e=t.getUint8(i).toString(16);1===e.length&&(e="0"+e),r.push(e)}return"<"+n+" "+r.join(" ")+">"},utf8Write:qr,utf8Read:Vr,utf8ByteCount:Wr},ti={XHRRequest:Br,FetchRequest:async function(e,t,n,r,i,o){const s=new Headers(r||{}),a=e?e.toUpperCase():I(o)?"GET":"POST",l=new AbortController;let c;const u=new Promise(e=>{c=setTimeout(()=>{l.abort(),e({error:new T("Request timed out",null,408)})},t?t.options.timeouts.httpRequestTimeout:Me.TIMEOUTS.httpRequestTimeout)}),h={method:a,headers:s,body:o,signal:l.signal};y.Config.isWebworker||(h.credentials=s.has("authorization")?"include":"same-origin");const d=(async()=>{try{const e=new URLSearchParams(i||{});e.set("rnd",ee());const t=n+"?"+e,r=await he().fetch(t,h);if(clearTimeout(c),204==r.status)return{error:null,statusCode:r.status};const o=r.headers.get("Content-Type");let s;s=o&&o.indexOf("application/x-msgpack")>-1?await r.arrayBuffer():o&&o.indexOf("application/json")>-1?await r.json():await r.text();const a=!!o&&-1===o.indexOf("application/x-msgpack"),l=function(e){const t={};return e.forEach((e,n)=>{t[n]=e}),t}(r.headers);if(r.ok)return{error:null,body:s,headers:l,unpacked:a,statusCode:r.status};{const e=function(e,t){if(function(e,t){return!!t.get("x-ably-errorcode")}(0,t))return e.error&&E.fromValues(e.error)}(s,r.headers)||new T("Error response received from server: "+r.status+" body was: "+y.Config.inspect(s),null,r.status);return{error:e,body:s,headers:l,unpacked:a,statusCode:r.status}}}catch(e){return clearTimeout(c),{error:e}}})();return Promise.race([u,d])}},ni=function(e,t){class n{constructor(e,t,n,r){this.algorithm=e,this.keyLength=t,this.mode=n,this.key=r}}class r{static getDefaultParams(e){var r;if(!e.key)throw new Error("Crypto.getDefaultParams: a key is required");r="string"===typeof e.key?t.toArrayBuffer(t.base64Decode(e.key.replace("_","/").replace("-","+"))):e.key instanceof ArrayBuffer?e.key:t.toArrayBuffer(e.key);var i=e.algorithm||"aes",o=8*r.byteLength,s=e.mode||"cbc",a=new n(i,o,s,r);if(e.keyLength&&e.keyLength!==a.keyLength)throw new Error("Crypto.getDefaultParams: a keyLength of "+e.keyLength+" was specified, but the key actually has length "+a.keyLength);return function(e){if("aes"===e.algorithm&&"cbc"===e.mode){if(128===e.keyLength||256===e.keyLength)return;throw new Error("Unsupported key length "+e.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)")}}(a),a}static async generateRandomKey(t){try{return e.getRandomArrayBuffer((t||256)/8)}catch(n){throw new E("Failed to generate random key: "+n.message,400,5e4,n)}}static getCipher(e,t){var r,o=function(e){return e instanceof n}(e)?e:this.getDefaultParams(e);return{cipherParams:o,cipher:new i(o,null!=(r=e.iv)?r:null,t)}}}r.CipherParams=n;class i{constructor(e,n,r){if(this.logger=r,!crypto.subtle)throw isSecureContext?new Error("Crypto operations are not possible since the browser\u2019s SubtleCrypto class is unavailable (reason unknown)."):new Error("Crypto operations are is not possible since the current environment is a non-secure context and hence the browser\u2019s SubtleCrypto class is not available.");this.algorithm=e.algorithm+"-"+String(e.keyLength)+"-"+e.mode,this.webCryptoAlgorithm=e.algorithm+"-"+e.mode,this.key=t.toArrayBuffer(e.key),this.iv=n?t.toArrayBuffer(n):null}concat(e,n){const r=new ArrayBuffer(e.byteLength+n.byteLength),i=new DataView(r),o=new DataView(t.toArrayBuffer(e));for(let t=0;t<o.byteLength;t++)i.setInt8(t,o.getInt8(t));const s=new DataView(t.toArrayBuffer(n));for(let t=0;t<s.byteLength;t++)i.setInt8(o.byteLength+t,s.getInt8(t));return r}async encrypt(e){S.logAction(this.logger,S.LOG_MICRO,"CBCCipher.encrypt()","");const t=await this.getIv(),n=await crypto.subtle.importKey("raw",this.key,this.webCryptoAlgorithm,!1,["encrypt"]),r=await crypto.subtle.encrypt({name:this.webCryptoAlgorithm,iv:t},n,e);return this.concat(t,r)}async decrypt(e){S.logAction(this.logger,S.LOG_MICRO,"CBCCipher.decrypt()","");const n=t.toArrayBuffer(e),r=n.slice(0,16),i=n.slice(16),o=await crypto.subtle.importKey("raw",this.key,this.webCryptoAlgorithm,!1,["decrypt"]);return crypto.subtle.decrypt({name:this.webCryptoAlgorithm,iv:r},o,i)}async getIv(){if(this.iv){var n=this.iv;return this.iv=null,n}const r=await e.getRandomArrayBuffer(16);return t.toArrayBuffer(r)}}return r}(xr,Sr);y.Crypto=ni,y.BufferUtils=Sr,y.Http=Rr,y.Config=xr,y.Transports=Fr,y.WebStorage=Pr;for(const n of[An,or])n.Crypto=ni,n._MsgPack=ei;Rr.bundledRequestImplementations=ti,S.initLogHandlers(),y.Defaults=(Zr=Hr,Object.assign(we,Zr)),y.Config.agent&&(y.Defaults.agent+=" "+y.Config.agent);var ri={ErrorInfo:E,Rest:An,Realtime:or,msgpack:ei,makeProtocolMessageFromDeserialized:gn};return"object"==typeof r.exports&&(r.exports=((e,t,n,r)=>{if(t&&"object"===typeof t||"function"===typeof t)for(let i of Object.getOwnPropertyNames(t))Object.prototype.hasOwnProperty.call(e,i)||i===n||Object.defineProperty(e,i,{get:()=>t[i],enumerable:!(r=Object.getOwnPropertyDescriptor(t,i))||r.enumerable});return e})(r.exports,t)),r.exports},e.exports=r()},288:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function v(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var w=b.prototype=new v;w.constructor=b,g(w,y.prototype),w.isPureReactComponent=!0;var k=Array.isArray,S={H:null,A:null,T:null,S:null,V:null},C=Object.prototype.hasOwnProperty;function O(e,t,r,i,o,s){return r=s.ref,{$$typeof:n,type:e,key:t,ref:void 0!==r?r:null,props:s}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var T=/\/+/g;function R(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function A(){}function _(e,t,i,o,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(a){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0;break;case d:return _((u=e._init)(e._payload),t,i,o,s)}}if(u)return s=s(e),u=""===o?"."+R(e,0):o,k(s)?(i="",null!=u&&(i=u.replace(T,"$&/")+"/"),_(s,t,i,"",function(e){return e})):null!=s&&(E(s)&&(l=s,c=i+(null==s.key||e&&e.key===s.key?"":(""+s.key).replace(T,"$&/")+"/")+u,s=O(l.type,c,void 0,0,0,l.props)),t.push(s)),1;u=0;var h,p=""===o?".":o+":";if(k(e))for(var g=0;g<e.length;g++)u+=_(o=e[g],t,i,a=p+R(o,g),s);else if("function"===typeof(g=null===(h=e)||"object"!==typeof h?null:"function"===typeof(h=f&&h[f]||h["@@iterator"])?h:null))for(e=g.call(e),g=0;!(o=e.next()).done;)u+=_(o=o.value,t,i,a=p+R(o,g++),s);else if("object"===a){if("function"===typeof e.then)return _(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(A,A):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,i,o,s);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function P(e,t,n){if(null==e)return e;var r=[],i=0;return _(e,r,"","",function(e){return t.call(n,e,i++)}),r}function M(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function x(){}t.Children={map:P,forEach:function(e,t,n){P(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return P(e,function(){t++}),t},toArray:function(e){return P(e,function(e){return e})||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=i,t.Profiler=s,t.PureComponent=b,t.StrictMode=o,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=S,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return S.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=g({},e.props),i=e.key;if(null!=t)for(o in void 0!==t.ref&&void 0,void 0!==t.key&&(i=""+t.key),t)!C.call(t,o)||"key"===o||"__self"===o||"__source"===o||"ref"===o&&void 0===t.ref||(r[o]=t[o]);var o=arguments.length-2;if(1===o)r.children=n;else if(1<o){for(var s=Array(o),a=0;a<o;a++)s[a]=arguments[a+2];r.children=s}return O(e.type,i,void 0,0,0,r)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:a,_context:e},e},t.createElement=function(e,t,n){var r,i={},o=null;if(null!=t)for(r in void 0!==t.key&&(o=""+t.key),t)C.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(i[r]=t[r]);var s=arguments.length-2;if(1===s)i.children=n;else if(1<s){for(var a=Array(s),l=0;l<s;l++)a[l]=arguments[l+2];i.children=a}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===i[r]&&(i[r]=s[r]);return O(e,o,void 0,0,0,i)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:M}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=S.T,n={};S.T=n;try{var r=e(),i=S.S;null!==i&&i(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(x,I)}catch(o){I(o)}finally{S.T=t}},t.unstable_useCacheRefresh=function(){return S.H.useCacheRefresh()},t.use=function(e){return S.H.use(e)},t.useActionState=function(e,t,n){return S.H.useActionState(e,t,n)},t.useCallback=function(e,t){return S.H.useCallback(e,t)},t.useContext=function(e){return S.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return S.H.useDeferredValue(e,t)},t.useEffect=function(e,t,n){var r=S.H;if("function"===typeof n)throw Error("useEffect CRUD overload is not enabled in this build of React.");return r.useEffect(e,t)},t.useId=function(){return S.H.useId()},t.useImperativeHandle=function(e,t,n){return S.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return S.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return S.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return S.H.useMemo(e,t)},t.useOptimistic=function(e,t){return S.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return S.H.useReducer(e,t,n)},t.useRef=function(e){return S.H.useRef(e)},t.useState=function(e){return S.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return S.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return S.H.useTransition()},t.version="19.1.1"},391:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4)},579:(e,t,n)=>{"use strict";e.exports=n(799)},672:(e,t,n)=>{"use strict";var r=n(43);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(){}var s={d:{f:o,r:function(){throw Error(i(522))},D:o,C:o,L:o,m:o,X:o,S:o,M:o},p:0,findDOMNode:null},a=Symbol.for("react.portal");var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(i(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:a,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=s.p;try{if(l.T=null,s.p=2,e)return e()}finally{l.T=t,s.p=n,s.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,s.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&s.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin),i="string"===typeof t.integrity?t.integrity:void 0,o="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?s.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:i,fetchPriority:o}):"script"===n&&s.d.X(e,{crossOrigin:r,integrity:i,fetchPriority:o,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);s.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&s.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin);s.d.L(e,n,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);s.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else s.d.m(e)},t.requestFormReset=function(e){s.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.1.1"},799:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element");function r(e,t,r){var i=null;if(void 0!==r&&(i=""+r),void 0!==t.key&&(i=""+t.key),"key"in t)for(var o in r={},t)"key"!==o&&(r[o]=t[o]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:i,ref:void 0!==t?t:null,props:r}}Symbol.for("react.fragment"),t.jsx=r,t.jsxs=r},853:(e,t,n)=>{"use strict";e.exports=n(896)},896:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>o(l,n))c<i&&0>o(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[a]=n,r=a);else{if(!(c<i&&0>o(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,g=!1,m=!1,y=!1,v="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function k(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function S(e){if(m=!1,k(e),!g)if(null!==r(c))g=!0,O||(O=!0,C());else{var t=r(u);null!==t&&I(S,t.startTime-e)}}var C,O=!1,E=-1,T=5,R=-1;function A(){return!!y||!(t.unstable_now()-R<T)}function _(){if(y=!1,O){var e=t.unstable_now();R=e;var n=!0;try{e:{g=!1,m&&(m=!1,b(E),E=-1),p=!0;var o=f;try{t:{for(k(e),d=r(c);null!==d&&!(d.expirationTime>e&&A());){var s=d.callback;if("function"===typeof s){d.callback=null,f=d.priorityLevel;var a=s(d.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof a){d.callback=a,k(e),n=!0;break t}d===r(c)&&i(c),k(e)}else i(c);d=r(c)}if(null!==d)n=!0;else{var l=r(u);null!==l&&I(S,l.startTime-e),n=!1}}break e}finally{d=null,f=o,p=!1}n=void 0}}finally{n?C():O=!1}}}if("function"===typeof w)C=function(){w(_)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,M=P.port2;P.port1.onmessage=_,C=function(){M.postMessage(null)}}else C=function(){v(_,0)};function I(e,n){E=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_requestPaint=function(){y=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,o){var s=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(e.sortIndex=o,n(u,e),null===r(c)&&e===r(u)&&(m?(b(E),E=-1):m=!0,I(S,o-s))):(e.sortIndex=a,n(c,e),g||p||(g=!0,O||(O=!0,C()))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(672)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=n(43),t=n(391);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function o(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var l={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},c=e.createContext&&e.createContext(l),u=["attr","size","title"];function h(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(this,arguments)}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach(function(t){g(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function g(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(t){return t&&t.map((t,n)=>e.createElement(t.tag,p({key:n},t.attr),m(t.child)))}function y(t){return n=>e.createElement(v,d({attr:p({},t.attr)},n),m(t.child))}function v(t){var n=n=>{var r,{attr:i,size:o,title:s}=t,a=h(t,u),l=o||n.size||"1em";return n.className&&(r=n.className),t.className&&(r=(r?r+" ":"")+t.className),e.createElement("svg",d({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,i,a,{className:r,style:p(p({color:t.color||n.color},n.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),s&&e.createElement("title",null,s),t.children)};return void 0!==c?e.createElement(c.Consumer,null,e=>n(e)):n(l)}function b(e){return y({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(e)}function w(e){return y({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(e)}function k(e){return y({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm-83.6 290.5c4.8 4.8 4.8 12.6 0 17.4l-40.5 40.5c-4.8 4.8-12.6 4.8-17.4 0L256 313.3l-66.5 67.1c-4.8 4.8-12.6 4.8-17.4 0l-40.5-40.5c-4.8-4.8-4.8-12.6 0-17.4l67.1-66.5-67.1-66.5c-4.8-4.8-4.8-12.6 0-17.4l40.5-40.5c4.8-4.8 12.6-4.8 17.4 0l66.5 67.1 66.5-67.1c4.8-4.8 12.6-4.8 17.4 0l40.5 40.5c4.8 4.8 4.8 12.6 0 17.4L313.3 256l67.1 66.5z"},child:[]}]})(e)}var S=n(579);function C(e){let{handleSubmit:t,mudaInput:n,newTask:r,alarmTime:i,mudaAlarmTime:o}=e;return(0,S.jsxs)("form",{onSubmit:t,action:"#",className:"form",children:[(0,S.jsx)("input",{type:"text",placeholder:"Adicione uma tarefa",onChange:n,value:r}),(0,S.jsx)("input",{type:"time",placeholder:"Hora do alarme",onChange:o,value:i}),(0,S.jsx)("button",{type:"submit",children:(0,S.jsx)(w,{})})]})}var O=n(259);const E=new(n.n(O)().Realtime)({key:"KixCeQ.1aKTPw:c3EopmtsTS7LhP0KdPXhePoGjyQ_X-pl1z-tEt3Ijfw"});function T(e){let{tasks:t,handleEdit:n,handleDelete:r}=e;return(0,S.jsx)("ul",{className:"tasks",children:t.map((e,t)=>{let i="";if(e.alarmTimestamp){const t=new Date(e.alarmTimestamp),n=t.getHours().toString().padStart(2,"0"),r=t.getMinutes().toString().padStart(2,"0");i="".concat(n,":").concat(r)}return(0,S.jsxs)("li",{children:[(0,S.jsx)("span",{className:"task-text",children:e.text}),i&&(0,S.jsxs)("span",{className:"date",children:["\u23f0 ",i]}),(0,S.jsx)("span",{className:"date",children:e.date}),(0,S.jsxs)("span",{children:[(0,S.jsx)(b,{className:"edit",onClick:e=>n(e,t)}),(0,S.jsx)(k,{className:"delete",onClick:e=>r(e,t)})]})]},t)})})}class R extends e.Component{constructor(){super(...arguments),this.state={newTask:"",alarmTime:"",tasks:[],index:-1,notifications:[]},this.receiveIds=new Set,this.alreadySubscribed=!1,this.getCurrentTime=()=>{const e=new Date,t=e.getHours().toString().padStart(2,"0"),n=e.getMinutes().toString().padStart(2,"0");return"".concat(t,":").concat(n)},this.checkAlarms=()=>{console.log("Verificando alarmes");const e=Date.now();this.setState(t=>({tasks:t.tasks.map(t=>!t.alarmTriggered&&t.alarmTimestamp&&e>=t.alarmTimestamp?(this.sendAblyNotification(t),a(a({},t),{},{alarmTriggered:!0})):t)}))},this.notifyUser=e=>{"granted"===Notification.permission&&new Notification("\u23f0 Lembrete de Tarefa!",{body:"Est\xe1 na hora de: ".concat(e.text),icon:"/icone.png"})},this.sendAblyNotification=async e=>{try{const t=E.channels.get("alarme-tarefas");await t.publish("lembrete",{title:"Lembrete de Tarefa",message:"\u23f0 Est\xe1 na hora de: ".concat(e.text)})}catch(t){console.error("Erro ao enviar notifica\xe7\xe3o Ably:",t)}},this.subscribeToAbly=()=>{if(this.alreadySubscribed)return;this.alreadySubscribed=!0;E.channels.get("alarme-tarefas").subscribe("lembrete",e=>{if(!e||!e.data)return void console.warn("Mensagem Ably inv\xe1lida ou sem dados:",e);const t=e.data.message;this.receiveIds.has(t)||(this.receiveIds.add(t),this.setState(n=>({notifications:[{id:t,title:e.data.title,message:e.data.message},...n.notifications]})),navigator.serviceWorker&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"ABLY_MESSAGE",body:e.data.message}),"granted"===Notification.permission&&new Notification(e.data.title||"\ud83d\udccc Notifica\xe7\xe3o Ably",{body:e.data.message,icon:"/icone.png"}))})},this.handleSubmit=e=>{e.preventDefault();const{tasks:t,index:n,alarmTime:r}=this.state;let{newTask:i}=this.state;if(i=i.trim(),!i)return;if(t.some(e=>e.text===i))return;const o=[...t];let s=null;if(r){const[e,t]=r.split(":"),n=new Date;let i=new Date(n.getFullYear(),n.getMonth(),n.getDate(),parseInt(e),parseInt(t),0,0);i<n&&i.setDate(i.getDate()+1),s=i.getTime()}if(-1===n){const e=(new Date).toLocaleString("pt-BR",{hour:"2-digit",minute:"2-digit"}),t={text:i,date:e,alarmTime:r||"",alarmTimestamp:s||null,alarmTriggered:!1};this.setState({tasks:[...o,t],newTask:"",alarmTime:""})}else o[n].text=i,o[n].alarmTime=r||"",o[n].alarmTimestamp=s,o[n].alarmTriggered=!1,this.setState({tasks:[...o],index:-1,newTask:"",alarmTime:""})},this.handleEdit=(e,t)=>{const{tasks:n}=this.state;let r=n[t].alarmTime||"";if(n[t].alarmTimestamp){const e=new Date(n[t].alarmTimestamp),i=e.getHours().toString().padStart(2,"0"),o=e.getMinutes().toString().padStart(2,"0");r="".concat(i,":").concat(o)}this.setState({index:t,newTask:n[t].text,alarmTime:r})},this.mudaInput=e=>{this.setState({newTask:e.target.value})},this.mudaAlarmTime=e=>{this.setState({alarmTime:e.target.value})},this.handleDelete=(e,t)=>{const{tasks:n}=this.state,r=[...n];r.splice(t,1),this.setState({tasks:[...r]})}}componentDidMount(){const e=JSON.parse(localStorage.getItem("tasks"));if("Notification"in window&&Notification.requestPermission(),e){const t=e.map(e=>a(a({},e),{},{alarmTriggered:e.alarmTriggered||!1}));this.setState({tasks:t})}this.alarmeIntervalo=setInterval(this.checkAlarms,6e4),"serviceWorker"in navigator&&navigator.serviceWorker.register("".concat("/react-lista-tarefas","/ntfy-sw.js")).then(e=>console.log("\u2705 SW registrado:",e)).catch(e=>console.error("\u274c Erro no SW:",e)),this.subscribeToAbly()}componentWillUnmount(){clearInterval(this.alarmeIntervalo),this.eventSource&&this.eventSource.close()}componentDidUpdate(e,t){const{tasks:n}=this.state;n!==t.tasks&&localStorage.setItem("tasks",JSON.stringify(n))}render(){const{newTask:e,tasks:t,alarmTime:n,notifications:r}=this.state;return(0,S.jsxs)("div",{className:"main",children:[(0,S.jsx)("h1",{children:"Lista de Tarefas"}),(0,S.jsx)(C,{handleSubmit:this.handleSubmit,mudaInput:this.mudaInput,newTask:e,alarmTime:n,mudaAlarmTime:this.mudaAlarmTime}),(0,S.jsx)(T,{tasks:t,handleEdit:this.handleEdit,handleDelete:this.handleDelete}),(0,S.jsx)("p",{style:{textAlign:"center",marginTop:"20px",color:"#555"},children:"Notifica\xe7\xf5es autom\xe1ticas ativadas via ntfy.sh"}),(0,S.jsxs)("div",{className:"notifications",children:[(0,S.jsx)("h2",{children:"Notifica\xe7\xf5es"}),0===this.state.notifications.length?(0,S.jsx)("p",{children:"Nenhuma notifica\xe7\xe3o recebida ainda."}):(0,S.jsx)("ul",{children:this.state.notifications.map(e=>(0,S.jsxs)("li",{children:[(0,S.jsx)("strong",{children:e.title}),": ",e.message]},e.id))})]})]})}}function A(){return(0,S.jsx)(R,{})}t.createRoot(document.getElementById("root")).render((0,S.jsx)(e.StrictMode,{children:(0,S.jsx)(A,{})}))})()})();
//# sourceMappingURL=main.25905a39.js.map